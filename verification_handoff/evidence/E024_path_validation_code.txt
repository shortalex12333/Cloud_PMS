      pathStartsCorrectly: storagePath.startsWith(`${yachtId}/`),
    });

    // Validate that path starts with this yacht's UUID (security check)
    if (!storagePath.startsWith(`${yachtId}/`)) {
      console.warn('[documentLoader] Path does not start with yacht UUID, security risk!', {
        storagePath,
        expectedPrefix: yachtId,
      });
      return {
--
    if (!yachtId || !storagePath.startsWith(`${yachtId}/`)) {
      throw new Error('Invalid document path');
    }

    // Get signed URL for download
    const { data: urlData, error: urlError } = await supabase.storage
--
    if (!storagePath.startsWith(`${yachtId}/`)) {
      console.warn('[documentLoader] Metadata path security check failed');
      return null;
    }

    const { data: fileData, error } = await supabase.storage
