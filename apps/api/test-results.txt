/Users/celeste7/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:34: NotOpenSSLWarning: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
============================= test session starts ==============================
platform darwin -- Python 3.9.6, pytest-8.4.2, pluggy-1.6.0 -- /Library/Developer/CommandLineTools/usr/bin/python3
cachedir: .pytest_cache
rootdir: /Users/celeste7/Documents/Cloud_PMS/apps/api
configfile: pytest.ini
plugins: mock-3.15.1, asyncio-0.21.1, anyio-3.7.1, langsmith-0.4.8, cov-7.0.0
asyncio: mode=auto
collecting ... collected 28 items

tests/test_email_transport.py::TestFeatureFlags::test_master_switch_off_disables_all PASSED [  3%]
tests/test_email_transport.py::TestFeatureFlags::test_individual_flag_respected PASSED [  7%]
tests/test_email_transport.py::TestFeatureFlags::test_unknown_feature_fails_closed PASSED [ 10%]
tests/test_email_transport.py::TestFeatureFlags::test_all_features_can_be_checked PASSED [ 14%]
tests/test_email_transport.py::TestGraphClientSeparation::test_read_client_cannot_send PASSED [ 17%]
tests/test_email_transport.py::TestGraphClientSeparation::test_read_client_cannot_create_draft PASSED [ 21%]
tests/test_email_transport.py::TestGraphClientSeparation::test_write_client_cannot_list_messages PASSED [ 25%]
tests/test_email_transport.py::TestGraphClientSeparation::test_write_client_cannot_get_message PASSED [ 28%]
tests/test_email_transport.py::TestGraphClientSeparation::test_write_client_cannot_render PASSED [ 32%]
tests/test_email_transport.py::TestGraphClientSeparation::test_separation_is_enforced_at_method_level PASSED [ 35%]
tests/test_email_transport.py::TestSchemaCompliance::test_no_body_column_in_email_messages PASSED [ 39%]
tests/test_email_transport.py::TestSchemaCompliance::test_email_threads_has_required_columns PASSED [ 42%]
tests/test_email_transport.py::TestSchemaCompliance::test_email_links_has_soft_delete PASSED [ 46%]
tests/test_email_transport.py::TestSchemaCompliance::test_email_messages_stores_only_metadata PASSED [ 50%]
tests/test_email_transport.py::TestTenantIsolation::test_cannot_read_other_yacht_threads PASSED [ 53%]
tests/test_email_transport.py::TestTenantIsolation::test_cannot_insert_thread_for_nonexistent_yacht PASSED [ 57%]
tests/test_email_transport.py::TestTenantIsolation::test_yacht_id_required_for_queries PASSED [ 60%]
tests/test_email_transport.py::TestTenantIsolation::test_link_isolation_by_yacht PASSED [ 64%]
tests/test_email_transport.py::TestTokenRevocation::test_revoked_token_query_returns_nothing PASSED [ 67%]
tests/test_email_transport.py::TestEndpointFeatureFlags::test_related_disabled_when_flag_off PASSED [ 71%]
tests/test_email_transport.py::TestEndpointFeatureFlags::test_render_disabled_when_flag_off PASSED [ 75%]
tests/test_email_transport.py::TestEndpointFeatureFlags::test_sync_disabled_when_flag_off PASSED [ 78%]
tests/test_email_transport.py::TestAuditLogging::test_link_update_triggers_audit PASSED [ 82%]
tests/test_email_transport.py::TestManualWatchdog::test_watchdog_can_process_messages PASSED [ 85%]
tests/test_email_transport.py::TestManualWatchdog::test_watchdog_extracts_hashes_not_addresses PASSED [ 89%]
tests/test_email_transport.py::TestManualWatchdog::test_watchdog_sync_status_values PASSED [ 92%]
tests/test_email_transport.py::TestDoctrineCompliance::test_graph_client_does_not_cache_body PASSED [ 96%]
tests/test_email_transport.py::TestDoctrineCompliance::test_link_confidence_enum_values PASSED [100%]

============================== 28 passed in 2.93s ==============================
