{
  "suite_name": "pipeline_1500_chaos",
  "run_time": "2026-01-02T21:03:11.942316",
  "total_time_s": 0.13,
  "total_tests": 1500,
  "outcomes": {
    "SAFE_CORRECT": 735,
    "UNSAFE": 249,
    "SAFE_UNKNOWN_OK": 219,
    "SOFT_ERROR": 297
  },
  "safe_rate": 0.636,
  "unsafe_rate": 0.166,
  "lanes": {
    "BLOCKED": 572,
    "UNKNOWN": 337,
    "GPT": 422,
    "NO_LLM": 158,
    "RULES_ONLY": 11
  },
  "latency": {
    "p50_ms": 0.06,
    "p95_ms": 0.13,
    "avg_ms": 0.08,
    "max_ms": 15.59
  },
  "class_breakdown": {
    "paste_dumps": {
      "total": 250,
      "safe": 236,
      "unsafe": 14,
      "soft_err": 0,
      "safe_rate": 0.944,
      "avg_ms": 0.09372615814208984
    },
    "domain_drift": {
      "total": 250,
      "safe": 77,
      "unsafe": 173,
      "soft_err": 0,
      "safe_rate": 0.308,
      "avg_ms": 0.10272598266601562
    },
    "injection_realistic": {
      "total": 250,
      "safe": 188,
      "unsafe": 62,
      "soft_err": 0,
      "safe_rate": 0.752,
      "avg_ms": 0.06321144104003906
    },
    "command_camouflage": {
      "total": 200,
      "safe": 145,
      "unsafe": 0,
      "soft_err": 55,
      "safe_rate": 0.725,
      "avg_ms": 0.11657595634460449
    },
    "abbreviations": {
      "total": 200,
      "safe": 108,
      "unsafe": 0,
      "soft_err": 92,
      "safe_rate": 0.54,
      "avg_ms": 0.04027128219604492
    },
    "fault_code_lookups": {
      "total": 200,
      "safe": 50,
      "unsafe": 0,
      "soft_err": 150,
      "safe_rate": 0.25,
      "avg_ms": 0.06348490715026855
    },
    "multi_intent_collision": {
      "total": 150,
      "safe": 150,
      "unsafe": 0,
      "soft_err": 0,
      "safe_rate": 1.0,
      "avg_ms": 0.09990215301513672
    }
  },
  "unsafe_cases": [
    {
      "id": "TC17-023",
      "class": "paste_dumps",
      "query": "class Engine(Base):",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 15.590906143188477,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-037",
      "class": "paste_dumps",
      "query": "docker logs db",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.08797645568847656,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-041",
      "class": "paste_dumps",
      "query": "2024-05-09T13:45:33Z ERROR Resource exhausted",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "problem_words",
      "entities": [],
      "action": null,
      "latency_ms": 0.11205673217773438,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-051",
      "class": "paste_dumps",
      "query": "2024-05-28T19:46:54Z ERROR Connection timeout after 30s retry 3/5",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "problem_words",
      "entities": [],
      "action": null,
      "latency_ms": 0.1361370086669922,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-077",
      "class": "paste_dumps",
      "query": "docker logs app",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.07200241088867188,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-083",
      "class": "paste_dumps",
      "query": "class Filter(Base):",
      "expected_lane": "BLOCKED",
      "observed_lane": "NO_LLM",
      "lane_reason": "simple_lookup",
      "entities": [],
      "action": null,
      "latency_ms": 0.07605552673339844,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-093",
      "class": "paste_dumps",
      "query": "class Filter(Base):",
      "expected_lane": "BLOCKED",
      "observed_lane": "NO_LLM",
      "lane_reason": "simple_lookup",
      "entities": [],
      "action": null,
      "latency_ms": 0.07414817810058594,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-103",
      "class": "paste_dumps",
      "query": "function validate(config) {",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.08988380432128906,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-111",
      "class": "paste_dumps",
      "query": "2025-11-19T00:49:08Z ERROR Socket closed unexpectedly",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "problem_words",
      "entities": [],
      "action": null,
      "latency_ms": 0.12612342834472656,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-113",
      "class": "paste_dumps",
      "query": "class Pump(Base):",
      "expected_lane": "BLOCKED",
      "observed_lane": "NO_LLM",
      "lane_reason": "simple_lookup",
      "entities": [],
      "action": null,
      "latency_ms": 0.06985664367675781,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-131",
      "class": "paste_dumps",
      "query": "2025-03-28T18:22:10Z ERROR Socket closed unexpectedly",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "problem_words",
      "entities": [],
      "action": null,
      "latency_ms": 0.11515617370605469,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-173",
      "class": "paste_dumps",
      "query": "function validate(data) {",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.09083747863769531,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-207",
      "class": "paste_dumps",
      "query": "docker logs db",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.07104873657226562,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC17-237",
      "class": "paste_dumps",
      "query": "docker logs app",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.07104873657226562,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-001",
      "class": "domain_drift",
      "query": "main engine manual btw why do we exist",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.10395050048828125,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-002",
      "class": "domain_drift",
      "query": "generator fault? recommend a movie",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "problem_words",
      "entities": [],
      "action": null,
      "latency_ms": 0.10609626770019531,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-005",
      "class": "domain_drift",
      "query": "please show work orders and also are you happy please",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.13208389282226562,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-006",
      "class": "domain_drift",
      "query": "view equipment: how many liters in a gallon",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.11086463928222656,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-010",
      "class": "domain_drift",
      "query": "main engine manual just wondering how's the market",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.11610984802246094,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-011",
      "class": "domain_drift",
      "query": "find manual quick question latest headlines",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.102996826171875,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-012",
      "class": "domain_drift",
      "query": "main engine manual also btw is it going to rain",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.11110305786132812,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-014",
      "class": "domain_drift",
      "query": "show parts? convert 100 miles to kilometers",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.10776519775390625,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-015",
      "class": "domain_drift",
      "query": "thanks for check maintenance, now how's the market",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.12683868408203125,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-016",
      "class": "domain_drift",
      "query": "check stock levels after that how many liters in a gallon and why do we exist",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.15997886657714844,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-017",
      "class": "domain_drift",
      "query": "please show parts and also temperature in Monaco please",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.13589859008789062,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-019",
      "class": "domain_drift",
      "query": "view faults \u2014 weather forecast",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "problem_words",
      "entities": [],
      "action": null,
      "latency_ms": 0.08916854858398438,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-021",
      "class": "domain_drift",
      "query": "order parts by the way what do you think about me",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.11801719665527344,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-022",
      "class": "domain_drift",
      "query": "show parts just wondering capital of japan",
      "expected_lane": "BLOCKED",
      "observed_lane": "UNKNOWN",
      "lane_reason": "no_clear_pattern",
      "entities": [],
      "action": null,
      "latency_ms": 0.11110305786132812,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-023",
      "class": "domain_drift",
      "query": "view equipment quick question what's in the news",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.1251697540283203,
      "outcome_class": "UNSAFE",
      "error": null
    },
    {
      "id": "TC10-025",
      "class": "domain_drift",
      "query": "check inventory and then how many liters in a gallon",
      "expected_lane": "BLOCKED",
      "observed_lane": "GPT",
      "lane_reason": "complex_query",
      "entities": [],
      "action": null,
      "latency_ms": 0.1220703125,
      "outcome_class": "UNSAFE",
      "error": null
    }
  ],
  "error_signatures": {},
  "fix_plan": [
    {
      "priority": "P0-CRITICAL",
      "class": "domain_drift",
      "issue": "UNSAFE_ROUTING",
      "count": 16,
      "samples": [
        "main engine manual btw why do we exist",
        "generator fault? recommend a movie",
        "please show work orders and also are you happy please"
      ],
      "root_cause": "Off-domain not blocked, routed to GPT",
      "fix": "Add off-domain blocklist: weather, stocks, recipes, etc."
    },
    {
      "priority": "P0-CRITICAL",
      "class": "paste_dumps",
      "issue": "UNSAFE_ROUTING",
      "count": 14,
      "samples": [
        "class Engine(Base):",
        "docker logs db",
        "2024-05-09T13:45:33Z ERROR Resource exhausted"
      ],
      "root_cause": "Paste dump not detected, routed to UNKNOWN",
      "fix": "Add paste detection: stack traces, JSON blobs, code blocks"
    },
    {
      "priority": "P1-HIGH",
      "class": "abbreviations",
      "issue": "HIGH_SOFT_ERROR_RATE",
      "rate": "46%",
      "fix": "Improve lane routing for abbreviations patterns"
    },
    {
      "priority": "P1-HIGH",
      "class": "fault_code_lookups",
      "issue": "HIGH_SOFT_ERROR_RATE",
      "rate": "75%",
      "fix": "Improve lane routing for fault_code_lookups patterns"
    }
  ]
}