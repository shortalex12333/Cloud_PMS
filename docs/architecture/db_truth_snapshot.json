{
  "generated_at": "2026-01-24T06:35:34.367297",
  "total_tables": 143,
  "enums": {
    "action_status": [
      "pending",
      "in_progress",
      "completed",
      "failed",
      "cancelled"
    ],
    "confidence_level": [
      "LOW",
      "MEDIUM",
      "HIGH"
    ],
    "doc_category": [
      "manual",
      "service_bulletin",
      "parts_catalog",
      "wiring_diagram",
      "piping_diagram",
      "ga_drawing",
      "schematic",
      "specification",
      "sop",
      "checklist",
      "procedure",
      "policy",
      "guideline",
      "log",
      "report",
      "survey",
      "inspection",
      "audit",
      "work_order",
      "service_record",
      "incident_report",
      "drill_record",
      "class_certificate",
      "flag_certificate",
      "equipment_certificate",
      "crew_certificate",
      "insurance_certificate",
      "permit",
      "invoice",
      "quote",
      "purchase_order",
      "delivery_note",
      "receipt",
      "contract",
      "budget",
      "statement",
      "crew_list",
      "training_record",
      "medical_record",
      "hours_of_rest",
      "employment_contract",
      "evaluation",
      "itinerary",
      "preference_sheet",
      "menu",
      "charter_agreement",
      "trip_report",
      "feedback",
      "email",
      "letter",
      "memo",
      "notice",
      "photo",
      "video",
      "audio",
      "reference",
      "template",
      "archive",
      "other"
    ],
    "equipment_criticality": [
      "low",
      "medium",
      "high",
      "critical"
    ],
    "fault_severity": [
      "low",
      "medium",
      "high",
      "critical"
    ],
    "graph_edge_type": [
      "PART_OF",
      "CONTAINS",
      "BELONGS_TO",
      "LOCATED_IN",
      "INSTALLED_ON",
      "CONNECTED_TO",
      "USES_PART",
      "REQUIRES_CONSUMABLE",
      "HAS_FAULT",
      "SHOWS_SYMPTOM",
      "CAUSES",
      "SYMPTOM_OF",
      "REPAIRED_BY",
      "MAINTAINED_BY",
      "SPECIFIED_IN",
      "SUPERSEDES",
      "COMPATIBLE_WITH",
      "ALTERNATIVE_TO",
      "DOCUMENTED_IN",
      "REFERENCES",
      "APPLIES_TO",
      "COVERS",
      "SECTION_OF",
      "REVISION_OF",
      "ATTACHMENT_TO",
      "ASSIGNED_TO",
      "RESPONSIBLE_FOR",
      "REPORTS_TO",
      "MEMBER_OF",
      "PERFORMED_BY",
      "APPROVED_BY",
      "CREATED_BY",
      "WITNESSED_BY",
      "HOLDS_CERTIFICATE",
      "CERTIFIES",
      "ISSUED_BY",
      "VALID_UNTIL",
      "EXPIRES_ON",
      "SATISFIES",
      "REQUIRED_BY",
      "COMPLIES_WITH",
      "INSPECTED_BY",
      "SUPPLIED_BY",
      "INVOICED_BY",
      "PAID_TO",
      "ALLOCATED_TO",
      "QUOTED_BY",
      "CONTRACTED_WITH",
      "INSURED_BY",
      "CLAIMED_UNDER",
      "PART_OF_VOYAGE",
      "DEPARTED_FROM",
      "ARRIVED_AT",
      "TRANSITED_THROUGH",
      "PLANNED_FOR",
      "OCCURRED_DURING",
      "BOOKED_BY",
      "ATTENDED_BY",
      "PREFERS",
      "ALLERGIC_TO",
      "REQUESTED_BY",
      "SERVED_TO",
      "SCHEDULED_FOR",
      "DUE_ON",
      "COMPLETED_ON",
      "STARTED_ON",
      "VALID_FROM",
      "EFFECTIVE_FROM",
      "LAST_DONE",
      "NEXT_DUE",
      "HOSTS",
      "AUTHENTICATES",
      "BACKS_UP_TO",
      "STREAMS_TO",
      "RELATED_TO",
      "LINKED_TO",
      "ASSOCIATED_WITH",
      "MENTIONED_IN",
      "TAGGED_WITH",
      "SIMILAR_TO",
      "REPLACED_BY",
      "DERIVED_FROM",
      "AFFECTS",
      "has_fault",
      "has_part",
      "related_to",
      "causes",
      "resolves"
    ],
    "graph_node_type": [
      "equipment",
      "part",
      "system",
      "subcomponent",
      "fault",
      "symptom",
      "procedure",
      "measurement",
      "specification",
      "consumable",
      "tool",
      "document",
      "manual",
      "drawing",
      "certificate",
      "report",
      "sop",
      "checklist",
      "log_entry",
      "work_order",
      "service_record",
      "person",
      "role",
      "department",
      "watch",
      "qualification",
      "training",
      "voyage",
      "passage",
      "port",
      "waypoint",
      "route",
      "anchorage",
      "chart",
      "weather_window",
      "regulation",
      "inspection",
      "drill",
      "incident",
      "deficiency",
      "corrective_action",
      "permit",
      "flag_requirement",
      "invoice",
      "purchase_order",
      "expense",
      "budget",
      "contract",
      "policy",
      "claim",
      "payment",
      "currency",
      "supplier",
      "manufacturer",
      "agent",
      "shipyard",
      "surveyor",
      "service_provider",
      "guest",
      "trip",
      "itinerary",
      "preference",
      "activity",
      "dietary_requirement",
      "reservation",
      "menu",
      "recipe",
      "provision",
      "linen",
      "uniform",
      "amenity",
      "cabin",
      "area",
      "tender",
      "toy",
      "dive_equipment",
      "mooring_equipment",
      "deck_area",
      "cover",
      "network_device",
      "av_system",
      "software",
      "credential",
      "connection",
      "ip_address",
      "medication",
      "medical_equipment",
      "medical_record",
      "vaccination",
      "location",
      "compartment",
      "tank",
      "locker",
      "void",
      "date",
      "time_period",
      "schedule",
      "deadline",
      "milestone",
      "identifier",
      "reference",
      "tag",
      "note",
      "other"
    ],
    "handover_draft_state": [
      "DRAFT",
      "IN_REVIEW",
      "ACCEPTED",
      "SIGNED",
      "EXPORTED"
    ],
    "handover_entry_status": [
      "candidate",
      "included",
      "suppressed",
      "resolved"
    ],
    "handover_source_type": [
      "fault",
      "work_order",
      "history",
      "document",
      "predictive",
      "note"
    ],
    "insight_type": [
      "threshold_alert",
      "pattern_detected",
      "trend_warning",
      "crew_frustration",
      "inventory_gap",
      "compliance_due"
    ],
    "maintenance_action_type": [
      "inspect",
      "check",
      "test",
      "measure",
      "record",
      "clean",
      "lubricate",
      "adjust",
      "calibrate",
      "tighten",
      "replace",
      "repair",
      "rebuild",
      "overhaul",
      "recondition",
      "service",
      "flush",
      "drain",
      "fill",
      "bleed",
      "purge",
      "sample",
      "analyze",
      "diagnose",
      "troubleshoot",
      "document",
      "photograph",
      "report",
      "certify",
      "other",
      "oil_change",
      "filter_replace",
      "belt_check",
      "coolant_check",
      "pressure_test",
      "visual_inspection"
    ],
    "note_type": [
      "general",
      "observation",
      "warning",
      "resolution",
      "handover"
    ],
    "pms_entity_type": [
      "equipment",
      "part",
      "fault",
      "supplier"
    ],
    "presentation_bucket": [
      "Command",
      "Engineering",
      "ETO_AVIT",
      "Deck",
      "Interior",
      "Galley",
      "Security",
      "Admin_Compliance"
    ],
    "risk_level": [
      "normal",
      "monitor",
      "emerging",
      "high",
      "critical"
    ],
    "risk_tag": [
      "Safety_Critical",
      "Compliance_Critical",
      "Guest_Impacting",
      "Cost_Impacting",
      "Operational_Debt",
      "Informational"
    ],
    "snapshot_type": [
      "briefing",
      "legacy",
      "predictive"
    ],
    "system_type": [
      "main_engine",
      "generator",
      "hvac",
      "electrical",
      "hydraulic",
      "plumbing",
      "fuel",
      "freshwater",
      "blackwater",
      "graywater",
      "fire_suppression",
      "steering",
      "stabilizers",
      "thrusters",
      "anchor_windlass",
      "propulsion",
      "navigation",
      "communication",
      "radar",
      "ecdis",
      "autopilot",
      "gyro",
      "lifesaving",
      "firefighting",
      "security",
      "cctv",
      "galley",
      "laundry",
      "housekeeping",
      "provisions",
      "tender",
      "toys",
      "dive",
      "mooring",
      "deck_equipment",
      "av_entertainment",
      "network",
      "satellite",
      "lighting_control",
      "crew_management",
      "guest_services",
      "finance",
      "compliance",
      "charter",
      "general",
      "multi_system",
      "vessel_wide"
    ],
    "work_order_priority": [
      "routine",
      "important",
      "critical",
      "emergency"
    ],
    "work_order_status": [
      "planned",
      "in_progress",
      "completed",
      "deferred",
      "cancelled"
    ],
    "work_order_type": [
      "scheduled",
      "corrective",
      "unplanned",
      "preventive"
    ]
  },
  "tables": {
    "action_confirmations": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confirmation_title",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confirmation_message",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "changes_summary",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "can_undo",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "undo_deadline",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "undo_action",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "was_undone",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "undone_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "related_actions",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_context",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'direct'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ledger_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_135807_19_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135807_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135807_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_135807_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_135807_4_not_null",
            "clause": "action_type IS NOT NULL"
          },
          {
            "name": "2200_135807_5_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_135807_6_not_null",
            "clause": "entity_id IS NOT NULL"
          },
          {
            "name": "2200_135807_7_not_null",
            "clause": "confirmation_title IS NOT NULL"
          },
          {
            "name": "2200_135807_8_not_null",
            "clause": "confirmation_message IS NOT NULL"
          },
          {
            "name": "2200_135807_9_not_null",
            "clause": "changes_summary IS NOT NULL"
          },
          {
            "name": "valid_source",
            "clause": "(source_context = ANY (ARRAY['search'::text, 'direct'::text, 'microaction'::text, 'api'::text, 'scheduled'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "action_confirmations_pkey",
          "definition": "CREATE UNIQUE INDEX action_confirmations_pkey ON public.action_confirmations USING btree (id)"
        },
        {
          "name": "idx_action_confirmations_action",
          "definition": "CREATE INDEX idx_action_confirmations_action ON public.action_confirmations USING btree (action_type)"
        },
        {
          "name": "idx_action_confirmations_created",
          "definition": "CREATE INDEX idx_action_confirmations_created ON public.action_confirmations USING btree (created_at DESC)"
        },
        {
          "name": "idx_action_confirmations_entity",
          "definition": "CREATE INDEX idx_action_confirmations_entity ON public.action_confirmations USING btree (entity_type, entity_id)"
        },
        {
          "name": "idx_action_confirmations_user",
          "definition": "CREATE INDEX idx_action_confirmations_user ON public.action_confirmations USING btree (user_id)"
        },
        {
          "name": "idx_action_confirmations_yacht",
          "definition": "CREATE INDEX idx_action_confirmations_yacht ON public.action_confirmations USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "action_confirmations_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(user_id = auth.uid())"
          },
          {
            "name": "action_confirmations_own",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(user_id = auth.uid())",
            "with_check": null
          },
          {
            "name": "action_confirmations_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "action_executions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "params",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "result",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "success",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_code",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "duration_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_137308_13_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_137308_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_137308_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_137308_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_137308_4_not_null",
            "clause": "action_name IS NOT NULL"
          },
          {
            "name": "2200_137308_5_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_137308_9_not_null",
            "clause": "success IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "action_executions_pkey",
          "definition": "CREATE UNIQUE INDEX action_executions_pkey ON public.action_executions USING btree (id)"
        },
        {
          "name": "idx_action_executions_yacht",
          "definition": "CREATE INDEX idx_action_executions_yacht ON public.action_executions USING btree (yacht_id, created_at DESC)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "vessel_isolation_action_executions",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "alias_crew": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "crew_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "crew_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_29926_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_29926_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_29926_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "crew_aliases_alias_type_check",
            "clause": "(alias_type = ANY (ARRAY['manual'::text, 'learned'::text, 'llm_generated'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "crew_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX crew_aliases_pkey ON public.alias_crew USING btree (id)"
        },
        {
          "name": "idx_crew_aliases_trgm",
          "definition": "CREATE INDEX idx_crew_aliases_trgm ON public.alias_crew USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_crew_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_crew_aliases_unique ON public.alias_crew USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_crew_aliases_yacht",
          "definition": "CREATE INDEX idx_crew_aliases_yacht ON public.alias_crew USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to crew_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Yacht isolation for crew_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "alias_documents": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "document_aliases_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "document_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_29880_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_29880_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_29880_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "document_aliases_alias_type_check",
            "clause": "(alias_type = ANY (ARRAY['manual'::text, 'learned'::text, 'llm_generated'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "document_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX document_aliases_pkey ON public.alias_documents USING btree (id)"
        },
        {
          "name": "document_aliases_yacht_alias_unique",
          "definition": "CREATE UNIQUE INDEX document_aliases_yacht_alias_unique ON public.alias_documents USING btree (yacht_id, alias)"
        },
        {
          "name": "idx_document_aliases_trgm",
          "definition": "CREATE INDEX idx_document_aliases_trgm ON public.alias_documents USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_document_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_document_aliases_unique ON public.alias_documents USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_document_aliases_yacht",
          "definition": "CREATE INDEX idx_document_aliases_yacht ON public.alias_documents USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to document_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Yacht isolation for document_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "alias_equipment": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_primary",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "candidate_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "master_candidate_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deployed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "equipment_aliases_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "equipment_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "equipment_aliases_yacht_id_alias_key",
            "columns": [
              "yacht_id",
              "alias"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_23912_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_23912_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_23912_3_not_null",
            "clause": "equipment_id IS NOT NULL"
          },
          {
            "name": "2200_23912_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "2200_23912_5_not_null",
            "clause": "is_primary IS NOT NULL"
          },
          {
            "name": "2200_23912_6_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "equipment_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX equipment_aliases_pkey ON public.alias_equipment USING btree (id)"
        },
        {
          "name": "equipment_aliases_yacht_alias_unique",
          "definition": "CREATE UNIQUE INDEX equipment_aliases_yacht_alias_unique ON public.alias_equipment USING btree (yacht_id, alias)"
        },
        {
          "name": "equipment_aliases_yacht_id_alias_key",
          "definition": "CREATE UNIQUE INDEX equipment_aliases_yacht_id_alias_key ON public.alias_equipment USING btree (yacht_id, alias)"
        },
        {
          "name": "idx_equipment_aliases_alias_trgm",
          "definition": "CREATE INDEX idx_equipment_aliases_alias_trgm ON public.alias_equipment USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_equipment_aliases_equipment",
          "definition": "CREATE INDEX idx_equipment_aliases_equipment ON public.alias_equipment USING btree (equipment_id)"
        },
        {
          "name": "idx_equipment_aliases_lookup",
          "definition": "CREATE INDEX idx_equipment_aliases_lookup ON public.alias_equipment USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_equipment_aliases_lower",
          "definition": "CREATE INDEX idx_equipment_aliases_lower ON public.alias_equipment USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_equipment_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_equipment_aliases_unique ON public.alias_equipment USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_equipment_aliases_yacht",
          "definition": "CREATE INDEX idx_equipment_aliases_yacht ON public.alias_equipment USING btree (yacht_id)"
        },
        {
          "name": "idx_equipment_aliases_yacht_alias",
          "definition": "CREATE UNIQUE INDEX idx_equipment_aliases_yacht_alias ON public.alias_equipment USING btree (yacht_id, lower(alias))"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access equipment_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role full access to equipment_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "System can manage equipment aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Users can view equipment aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Yacht isolation for equipment_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 55
    },
    "alias_faults": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fault_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "master_candidate_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deployed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "fault_aliases_fault_id_fkey",
            "column": "fault_id",
            "references_table": "pms_faults",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "fault_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_29830_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_29830_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_29830_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "fault_aliases_alias_type_check",
            "clause": "(alias_type = ANY (ARRAY['manual'::text, 'learned'::text, 'llm_generated'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "fault_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX fault_aliases_pkey ON public.alias_faults USING btree (id)"
        },
        {
          "name": "fault_aliases_yacht_alias_unique",
          "definition": "CREATE UNIQUE INDEX fault_aliases_yacht_alias_unique ON public.alias_faults USING btree (yacht_id, alias)"
        },
        {
          "name": "idx_fault_aliases_trgm",
          "definition": "CREATE INDEX idx_fault_aliases_trgm ON public.alias_faults USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_fault_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_fault_aliases_unique ON public.alias_faults USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_fault_aliases_yacht",
          "definition": "CREATE INDEX idx_fault_aliases_yacht ON public.alias_faults USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to fault_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Yacht isolation for fault_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "alias_parts": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "candidate_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "master_candidate_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deployed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "part_aliases_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "part_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_29500_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_29500_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_29500_3_not_null",
            "clause": "part_id IS NOT NULL"
          },
          {
            "name": "2200_29500_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "part_aliases_alias_type_check",
            "clause": "(alias_type = ANY (ARRAY['manual'::text, 'extracted'::text, 'inferred'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_part_aliases_alias_trgm",
          "definition": "CREATE INDEX idx_part_aliases_alias_trgm ON public.alias_parts USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_part_aliases_part",
          "definition": "CREATE INDEX idx_part_aliases_part ON public.alias_parts USING btree (part_id)"
        },
        {
          "name": "idx_part_aliases_trgm",
          "definition": "CREATE INDEX idx_part_aliases_trgm ON public.alias_parts USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_part_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_part_aliases_unique ON public.alias_parts USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_part_aliases_yacht",
          "definition": "CREATE INDEX idx_part_aliases_yacht ON public.alias_parts USING btree (yacht_id)"
        },
        {
          "name": "idx_part_aliases_yacht_alias",
          "definition": "CREATE UNIQUE INDEX idx_part_aliases_yacht_alias ON public.alias_parts USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "part_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX part_aliases_pkey ON public.alias_parts USING btree (id)"
        },
        {
          "name": "part_aliases_yacht_alias_unique",
          "definition": "CREATE UNIQUE INDEX part_aliases_yacht_alias_unique ON public.alias_parts USING btree (yacht_id, alias)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to part_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Yacht isolation for part_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "alias_roles": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "canonical_role",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "role_aliases_alias_key",
            "columns": [
              "alias"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_23964_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_23964_2_not_null",
            "clause": "canonical_role IS NOT NULL"
          },
          {
            "name": "2200_23964_3_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "2200_23964_4_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "role_aliases_alias_key",
          "definition": "CREATE UNIQUE INDEX role_aliases_alias_key ON public.alias_roles USING btree (alias)"
        },
        {
          "name": "role_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX role_aliases_pkey ON public.alias_roles USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access role_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 27
    },
    "alias_symptoms": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptom_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "candidate_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "master_candidate_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deployed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptom_code",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "symptom_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_29810_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_29810_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_29810_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "symptom_aliases_alias_type_check",
            "clause": "(alias_type = ANY (ARRAY['manual'::text, 'learned'::text, 'llm_generated'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_symptom_aliases_trgm",
          "definition": "CREATE INDEX idx_symptom_aliases_trgm ON public.alias_symptoms USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_symptom_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_symptom_aliases_unique ON public.alias_symptoms USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_symptom_aliases_yacht",
          "definition": "CREATE INDEX idx_symptom_aliases_yacht ON public.alias_symptoms USING btree (yacht_id)"
        },
        {
          "name": "symptom_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX symptom_aliases_pkey ON public.alias_symptoms USING btree (id)"
        },
        {
          "name": "symptom_aliases_yacht_alias_unique",
          "definition": "CREATE UNIQUE INDEX symptom_aliases_yacht_alias_unique ON public.alias_symptoms USING btree (yacht_id, alias)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to symptom_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Yacht isolation for symptom_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 37
    },
    "alias_systems": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "master_candidate_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deployed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "system_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_29906_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_29906_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_29906_3_not_null",
            "clause": "system_type IS NOT NULL"
          },
          {
            "name": "2200_29906_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "system_aliases_alias_type_check",
            "clause": "(alias_type = ANY (ARRAY['manual'::text, 'learned'::text, 'llm_generated'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_system_aliases_trgm",
          "definition": "CREATE INDEX idx_system_aliases_trgm ON public.alias_systems USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_system_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_system_aliases_unique ON public.alias_systems USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_system_aliases_yacht",
          "definition": "CREATE INDEX idx_system_aliases_yacht ON public.alias_systems USING btree (yacht_id)"
        },
        {
          "name": "system_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX system_aliases_pkey ON public.alias_systems USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to system_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Yacht isolation for system_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 28
    },
    "alias_tasks": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "task_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "task_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_29946_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_29946_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_29946_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "task_aliases_alias_type_check",
            "clause": "(alias_type = ANY (ARRAY['manual'::text, 'learned'::text, 'llm_generated'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_task_aliases_trgm",
          "definition": "CREATE INDEX idx_task_aliases_trgm ON public.alias_tasks USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_task_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_task_aliases_unique ON public.alias_tasks USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_task_aliases_yacht",
          "definition": "CREATE INDEX idx_task_aliases_yacht ON public.alias_tasks USING btree (yacht_id)"
        },
        {
          "name": "task_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX task_aliases_pkey ON public.alias_tasks USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to task_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Yacht isolation for task_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "alias_work_orders": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alias_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "work_order_aliases_work_order_id_fkey",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "work_order_aliases_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_29855_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_29855_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_29855_4_not_null",
            "clause": "alias IS NOT NULL"
          },
          {
            "name": "work_order_aliases_alias_type_check",
            "clause": "(alias_type = ANY (ARRAY['manual'::text, 'learned'::text, 'llm_generated'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_work_order_aliases_trgm",
          "definition": "CREATE INDEX idx_work_order_aliases_trgm ON public.alias_work_orders USING gin (alias gin_trgm_ops)"
        },
        {
          "name": "idx_work_order_aliases_unique",
          "definition": "CREATE UNIQUE INDEX idx_work_order_aliases_unique ON public.alias_work_orders USING btree (yacht_id, lower(alias))"
        },
        {
          "name": "idx_work_order_aliases_yacht",
          "definition": "CREATE INDEX idx_work_order_aliases_yacht ON public.alias_work_orders USING btree (yacht_id)"
        },
        {
          "name": "work_order_aliases_pkey",
          "definition": "CREATE UNIQUE INDEX work_order_aliases_pkey ON public.alias_work_orders USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to work_order_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Yacht isolation for work_order_aliases",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "audit_field_history": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "table_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "record_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "field_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "old_value",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "new_value",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "changed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "changed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_125333_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_125333_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_125333_3_not_null",
            "clause": "table_name IS NOT NULL"
          },
          {
            "name": "2200_125333_4_not_null",
            "clause": "record_id IS NOT NULL"
          },
          {
            "name": "2200_125333_5_not_null",
            "clause": "field_name IS NOT NULL"
          },
          {
            "name": "2200_125333_8_not_null",
            "clause": "changed_by IS NOT NULL"
          },
          {
            "name": "2200_125333_9_not_null",
            "clause": "changed_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "audit_field_history_pkey",
          "definition": "CREATE UNIQUE INDEX audit_field_history_pkey ON public.audit_field_history USING btree (id)"
        },
        {
          "name": "idx_audit_history",
          "definition": "CREATE INDEX idx_audit_history ON public.audit_field_history USING btree (table_name, record_id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "auth_api_keys": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "key_prefix",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "hashed_key",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "scopes",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "'{}'::text[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_used_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "api_keys_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "api_keys_hashed_key_key",
            "columns": [
              "hashed_key"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_17988_12_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_17988_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_17988_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_17988_3_not_null",
            "clause": "key_prefix IS NOT NULL"
          },
          {
            "name": "2200_17988_4_not_null",
            "clause": "hashed_key IS NOT NULL"
          },
          {
            "name": "2200_17988_5_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "api_keys_hashed_key_check",
            "clause": "(hashed_key ~ '^\\$2[aby]\\$'::text)"
          },
          {
            "name": "api_keys_key_prefix_check",
            "clause": "(key_prefix ~ '^sk_(live|test)_[a-z0-9]{4,8}$'::text)"
          }
        ]
      },
      "indexes": [
        {
          "name": "api_keys_hashed_key_key",
          "definition": "CREATE UNIQUE INDEX api_keys_hashed_key_key ON public.auth_api_keys USING btree (hashed_key)"
        },
        {
          "name": "api_keys_pkey",
          "definition": "CREATE UNIQUE INDEX api_keys_pkey ON public.auth_api_keys USING btree (id)"
        },
        {
          "name": "idx_api_keys_hashed_key",
          "definition": "CREATE INDEX idx_api_keys_hashed_key ON public.auth_api_keys USING btree (hashed_key)"
        },
        {
          "name": "idx_api_keys_is_active",
          "definition": "CREATE INDEX idx_api_keys_is_active ON public.auth_api_keys USING btree (is_active)"
        },
        {
          "name": "idx_api_keys_yacht_id",
          "definition": "CREATE INDEX idx_api_keys_yacht_id ON public.auth_api_keys USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can manage api keys",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Managers can view api keys",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access api_keys",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "auth_guest_preferences": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "guest_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "guest_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "preference_category",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "preference_key",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "preference_value",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_trip_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "guest_preferences_guest_node_id_fkey",
            "column": "guest_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "guest_preferences_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_24903_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_24903_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_24903_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_24903_3_not_null",
            "clause": "guest_name IS NOT NULL"
          },
          {
            "name": "2200_24903_5_not_null",
            "clause": "preference_category IS NOT NULL"
          },
          {
            "name": "2200_24903_6_not_null",
            "clause": "preference_key IS NOT NULL"
          },
          {
            "name": "2200_24903_7_not_null",
            "clause": "preference_value IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "guest_preferences_pkey",
          "definition": "CREATE UNIQUE INDEX guest_preferences_pkey ON public.auth_guest_preferences USING btree (id)"
        },
        {
          "name": "idx_guest_prefs_category",
          "definition": "CREATE INDEX idx_guest_prefs_category ON public.auth_guest_preferences USING btree (yacht_id, preference_category)"
        },
        {
          "name": "idx_guest_prefs_guest",
          "definition": "CREATE INDEX idx_guest_prefs_guest ON public.auth_guest_preferences USING btree (yacht_id, guest_name)"
        },
        {
          "name": "idx_guest_prefs_guest_cat",
          "definition": "CREATE INDEX idx_guest_prefs_guest_cat ON public.auth_guest_preferences USING btree (yacht_id, guest_name, preference_category)"
        },
        {
          "name": "idx_guest_prefs_yacht",
          "definition": "CREATE INDEX idx_guest_prefs_yacht ON public.auth_guest_preferences USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access guest_preferences",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view yacht guest preferences",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "auth_microsoft_tokens": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "microsoft_user_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "original_email",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "microsoft_email",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "display_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "microsoft_access_token",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "microsoft_refresh_token",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "token_expires_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "token_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'Bearer'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "scopes",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "ARRAY['Mail.Read'::text, 'User.Read'::text]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "client_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "client_secret",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "provider",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'microsoft_graph'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "token_purpose",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'read'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "provider_email_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "provider_display_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_revoked",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "revoked_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "revoked_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "auth_microsoft_tokens_user_yacht_provider_purpose_key",
            "columns": [
              "user_id",
              "yacht_id",
              "provider",
              "token_purpose"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_27653_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_27653_2_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_27653_7_not_null",
            "clause": "microsoft_access_token IS NOT NULL"
          },
          {
            "name": "2200_27653_9_not_null",
            "clause": "token_expires_at IS NOT NULL"
          },
          {
            "name": "auth_microsoft_tokens_token_purpose_check",
            "clause": "(token_purpose = ANY (ARRAY['read'::text, 'write'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "auth_microsoft_tokens_user_yacht_provider_purpose_key",
          "definition": "CREATE UNIQUE INDEX auth_microsoft_tokens_user_yacht_provider_purpose_key ON public.auth_microsoft_tokens USING btree (user_id, yacht_id, provider, token_purpose)"
        },
        {
          "name": "idx_auth_microsoft_tokens_user_purpose",
          "definition": "CREATE INDEX idx_auth_microsoft_tokens_user_purpose ON public.auth_microsoft_tokens USING btree (user_id, token_purpose) WHERE ((is_revoked = false) OR (is_revoked IS NULL))"
        },
        {
          "name": "idx_user_microsoft_tokens_yacht_id",
          "definition": "CREATE INDEX idx_user_microsoft_tokens_yacht_id ON public.auth_microsoft_tokens USING btree (yacht_id)"
        },
        {
          "name": "user_microsoft_tokens_pkey",
          "definition": "CREATE UNIQUE INDEX user_microsoft_tokens_pkey ON public.auth_microsoft_tokens USING btree (id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": [
          {
            "name": "Service role can manage microsoft tokens",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(current_setting('role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Service role full access user_microsoft_tokens",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role has full access",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can access own microsoft tokens",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((auth.uid())::text = user_id)",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "update_user_microsoft_tokens_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 2
    },
    "auth_role_assignments": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "role",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "scopes",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "valid_from",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "valid_until",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "assigned_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "assigned_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_21048_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_21048_2_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_21048_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_21048_4_not_null",
            "clause": "role IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_user_role_assignments_active",
          "definition": "CREATE INDEX idx_user_role_assignments_active ON public.auth_role_assignments USING btree (user_id, yacht_id) WHERE (is_active = true)"
        },
        {
          "name": "idx_user_role_assignments_user_id",
          "definition": "CREATE INDEX idx_user_role_assignments_user_id ON public.auth_role_assignments USING btree (user_id)"
        },
        {
          "name": "idx_user_role_assignments_yacht_id",
          "definition": "CREATE INDEX idx_user_role_assignments_yacht_id ON public.auth_role_assignments USING btree (yacht_id)"
        },
        {
          "name": "user_role_assignments_pkey",
          "definition": "CREATE UNIQUE INDEX user_role_assignments_pkey ON public.auth_role_assignments USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access user_role_assignments",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 1
    },
    "auth_role_definitions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "permissions",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "user_roles_name_key",
            "columns": [
              "name"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_18017_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18017_2_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "2200_18017_5_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "user_roles_name_key",
          "definition": "CREATE UNIQUE INDEX user_roles_name_key ON public.auth_role_definitions USING btree (name)"
        },
        {
          "name": "user_roles_pkey",
          "definition": "CREATE UNIQUE INDEX user_roles_pkey ON public.auth_role_definitions USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Anyone can view roles",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role full access role_definitions",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "auth_signatures": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "role_at_signing",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "signature_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "signature_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "signed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_125324_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_125324_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_125324_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_125324_4_not_null",
            "clause": "role_at_signing IS NOT NULL"
          },
          {
            "name": "2200_125324_5_not_null",
            "clause": "signature_type IS NOT NULL"
          },
          {
            "name": "2200_125324_6_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_125324_7_not_null",
            "clause": "entity_id IS NOT NULL"
          },
          {
            "name": "2200_125324_8_not_null",
            "clause": "signature_hash IS NOT NULL"
          },
          {
            "name": "2200_125324_9_not_null",
            "clause": "signed_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "auth_signatures_pkey",
          "definition": "CREATE UNIQUE INDEX auth_signatures_pkey ON public.auth_signatures USING btree (id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "auth_users_profiles": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "email",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "user_profiles_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "user_profiles_email_key",
            "columns": [
              "email"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_127910_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_127910_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_127910_3_not_null",
            "clause": "email IS NOT NULL"
          },
          {
            "name": "2200_127910_4_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "2200_127910_5_not_null",
            "clause": "is_active IS NOT NULL"
          },
          {
            "name": "2200_127910_7_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_127910_8_not_null",
            "clause": "updated_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_auth_users_profiles_active",
          "definition": "CREATE INDEX idx_auth_users_profiles_active ON public.auth_users_profiles USING btree (yacht_id, is_active) WHERE (is_active = true)"
        },
        {
          "name": "idx_auth_users_profiles_email",
          "definition": "CREATE INDEX idx_auth_users_profiles_email ON public.auth_users_profiles USING btree (email)"
        },
        {
          "name": "idx_auth_users_profiles_yacht_id",
          "definition": "CREATE INDEX idx_auth_users_profiles_yacht_id ON public.auth_users_profiles USING btree (yacht_id)"
        },
        {
          "name": "user_profiles_email_key",
          "definition": "CREATE UNIQUE INDEX user_profiles_email_key ON public.auth_users_profiles USING btree (email)"
        },
        {
          "name": "user_profiles_pkey",
          "definition": "CREATE UNIQUE INDEX user_profiles_pkey ON public.auth_users_profiles USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Users can update own profile",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(auth.uid() = id)",
            "with_check": "(auth.uid() = id)"
          },
          {
            "name": "Users can view own profile",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(auth.uid() = id)",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 1
    },
    "auth_users_roles": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "role",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "assigned_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "assigned_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "valid_from",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "valid_until",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "user_roles_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "unique_active_user_yacht_role",
            "columns": [
              "user_id",
              "yacht_id",
              "role"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_127936_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_127936_2_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_127936_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_127936_4_not_null",
            "clause": "role IS NOT NULL"
          },
          {
            "name": "2200_127936_5_not_null",
            "clause": "assigned_at IS NOT NULL"
          },
          {
            "name": "2200_127936_7_not_null",
            "clause": "is_active IS NOT NULL"
          },
          {
            "name": "2200_127936_8_not_null",
            "clause": "valid_from IS NOT NULL"
          },
          {
            "name": "user_roles_role_check",
            "clause": "(role = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'captain'::text, 'manager'::text, 'vendor'::text, 'crew'::text, 'deck'::text, 'interior'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_auth_users_roles_active",
          "definition": "CREATE INDEX idx_auth_users_roles_active ON public.auth_users_roles USING btree (user_id, yacht_id, is_active) WHERE (is_active = true)"
        },
        {
          "name": "idx_auth_users_roles_user_id",
          "definition": "CREATE INDEX idx_auth_users_roles_user_id ON public.auth_users_roles USING btree (user_id)"
        },
        {
          "name": "idx_auth_users_roles_yacht_id",
          "definition": "CREATE INDEX idx_auth_users_roles_yacht_id ON public.auth_users_roles USING btree (yacht_id)"
        },
        {
          "name": "unique_active_user_yacht_role",
          "definition": "CREATE UNIQUE INDEX unique_active_user_yacht_role ON public.auth_users_roles USING btree (user_id, yacht_id, role)"
        },
        {
          "name": "user_roles_pkey1",
          "definition": "CREATE UNIQUE INDEX user_roles_pkey1 ON public.auth_users_roles USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "HODs can manage roles",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "is_hod(auth.uid(), yacht_id)",
            "with_check": null
          },
          {
            "name": "Users can view own roles",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 1
    },
    "chat_agent_configs": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "agent_secret_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "device_info",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_seen_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "agents_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_17967_10_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_17967_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_17967_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_17967_3_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "2200_17967_4_not_null",
            "clause": "agent_secret_hash IS NOT NULL"
          },
          {
            "name": "2200_17967_9_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "agents_agent_secret_hash_check",
            "clause": "(agent_secret_hash ~ '^\\$2[aby]\\$'::text)"
          }
        ]
      },
      "indexes": [
        {
          "name": "agents_pkey",
          "definition": "CREATE UNIQUE INDEX agents_pkey ON public.chat_agent_configs USING btree (id)"
        },
        {
          "name": "idx_agents_is_active",
          "definition": "CREATE INDEX idx_agents_is_active ON public.chat_agent_configs USING btree (is_active)"
        },
        {
          "name": "idx_agents_yacht_id",
          "definition": "CREATE INDEX idx_agents_yacht_id ON public.chat_agent_configs USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can manage agents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Managers can view agents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access agents",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "chat_messages": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "role",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "content",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "timestamp",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "message_index",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sources",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tokens_used",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence_score",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "chat_messages_session_id_fkey",
            "column": "session_id",
            "references_table": "chat_sessions",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_27919_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_27919_3_not_null",
            "clause": "role IS NOT NULL"
          },
          {
            "name": "2200_27919_4_not_null",
            "clause": "content IS NOT NULL"
          },
          {
            "name": "2200_27919_6_not_null",
            "clause": "message_index IS NOT NULL"
          },
          {
            "name": "chat_messages_role_check",
            "clause": "(role = ANY (ARRAY['user'::text, 'assistant'::text, 'system'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "chat_messages_pkey",
          "definition": "CREATE UNIQUE INDEX chat_messages_pkey ON public.chat_messages USING btree (id)"
        },
        {
          "name": "idx_chat_messages_message_index",
          "definition": "CREATE INDEX idx_chat_messages_message_index ON public.chat_messages USING btree (session_id, message_index)"
        },
        {
          "name": "idx_chat_messages_metadata_gin",
          "definition": "CREATE INDEX idx_chat_messages_metadata_gin ON public.chat_messages USING gin (metadata)"
        },
        {
          "name": "idx_chat_messages_role",
          "definition": "CREATE INDEX idx_chat_messages_role ON public.chat_messages USING btree (role)"
        },
        {
          "name": "idx_chat_messages_session_id",
          "definition": "CREATE INDEX idx_chat_messages_session_id ON public.chat_messages USING btree (session_id)"
        },
        {
          "name": "idx_chat_messages_sources_gin",
          "definition": "CREATE INDEX idx_chat_messages_sources_gin ON public.chat_messages USING gin (sources)"
        },
        {
          "name": "idx_chat_messages_timestamp",
          "definition": "CREATE INDEX idx_chat_messages_timestamp ON public.chat_messages USING btree (\"timestamp\")"
        },
        {
          "name": "idx_chat_messages_yacht_id",
          "definition": "CREATE INDEX idx_chat_messages_yacht_id ON public.chat_messages USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Allow backend read messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "anon",
              "authenticated"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role can manage all messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((current_setting('role'::text) = 'service_role'::text) OR (current_setting('role'::text) = 'postgres'::text))",
            "with_check": null
          },
          {
            "name": "anon_full_access_messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "anon"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "authenticated_delete_own_messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(EXISTS ( SELECT 1\n   FROM chat_sessions\n  WHERE ((chat_sessions.id = chat_messages.session_id) AND (chat_sessions.user_id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "authenticated_insert_own_messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(EXISTS ( SELECT 1\n   FROM chat_sessions\n  WHERE ((chat_sessions.id = chat_messages.session_id) AND (chat_sessions.user_id = auth.uid()))))"
          },
          {
            "name": "authenticated_select_own_messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(EXISTS ( SELECT 1\n   FROM chat_sessions\n  WHERE ((chat_sessions.id = chat_messages.session_id) AND (chat_sessions.user_id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "authenticated_update_own_messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(EXISTS ( SELECT 1\n   FROM chat_sessions\n  WHERE ((chat_sessions.id = chat_messages.session_id) AND (chat_sessions.user_id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "service_role_full_access_messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [
        {
          "name": "trigger_update_message_count",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_session_message_count()"
        },
        {
          "name": "trigger_update_message_count",
          "event": "DELETE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_session_message_count()"
        },
        {
          "name": "trigger_update_session_timestamp",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_session_timestamp()"
        },
        {
          "name": "trigger_update_session_timestamp",
          "event": "UPDATE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_session_timestamp()"
        }
      ],
      "row_count": 0
    },
    "chat_sessions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'New Chat'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "folder",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "search_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'yacht'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_archived",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "message_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_27898_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_27898_3_not_null",
            "clause": "title IS NOT NULL"
          },
          {
            "name": "chat_sessions_search_type_check",
            "clause": "(search_type = ANY (ARRAY['yacht'::text, 'email'::text, 'nas'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "chat_sessions_pkey",
          "definition": "CREATE UNIQUE INDEX chat_sessions_pkey ON public.chat_sessions USING btree (id)"
        },
        {
          "name": "idx_chat_sessions_created_at",
          "definition": "CREATE INDEX idx_chat_sessions_created_at ON public.chat_sessions USING btree (created_at DESC)"
        },
        {
          "name": "idx_chat_sessions_deleted",
          "definition": "CREATE INDEX idx_chat_sessions_deleted ON public.chat_sessions USING btree (deleted) WHERE (deleted = false)"
        },
        {
          "name": "idx_chat_sessions_folder",
          "definition": "CREATE INDEX idx_chat_sessions_folder ON public.chat_sessions USING btree (folder)"
        },
        {
          "name": "idx_chat_sessions_metadata_gin",
          "definition": "CREATE INDEX idx_chat_sessions_metadata_gin ON public.chat_sessions USING gin (session_metadata)"
        },
        {
          "name": "idx_chat_sessions_updated_at",
          "definition": "CREATE INDEX idx_chat_sessions_updated_at ON public.chat_sessions USING btree (updated_at DESC)"
        },
        {
          "name": "idx_chat_sessions_user_id",
          "definition": "CREATE INDEX idx_chat_sessions_user_id ON public.chat_sessions USING btree (user_id)"
        },
        {
          "name": "idx_chat_sessions_yacht_id",
          "definition": "CREATE INDEX idx_chat_sessions_yacht_id ON public.chat_sessions USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Allow backend read sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "anon",
              "authenticated"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role can manage all chat sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((current_setting('role'::text) = 'service_role'::text) OR (current_setting('role'::text) = 'postgres'::text))",
            "with_check": null
          },
          {
            "name": "anon_full_access_sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "anon"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "authenticated_delete_own_sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          },
          {
            "name": "authenticated_insert_own_sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(auth.uid() = user_id)"
          },
          {
            "name": "authenticated_select_own_sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          },
          {
            "name": "authenticated_update_own_sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          },
          {
            "name": "service_role_full_access_sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "confirmation_templates": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title_template",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "message_template",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "supports_undo",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "undo_window_seconds",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "30",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "icon",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "color",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "duration_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "5000",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "confirmation_templates_action_type_key",
            "columns": [
              "action_type"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_135825_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135825_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135825_2_not_null",
            "clause": "action_type IS NOT NULL"
          },
          {
            "name": "2200_135825_3_not_null",
            "clause": "title_template IS NOT NULL"
          },
          {
            "name": "2200_135825_4_not_null",
            "clause": "message_template IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "confirmation_templates_action_type_key",
          "definition": "CREATE UNIQUE INDEX confirmation_templates_action_type_key ON public.confirmation_templates USING btree (action_type)"
        },
        {
          "name": "confirmation_templates_pkey",
          "definition": "CREATE UNIQUE INDEX confirmation_templates_pkey ON public.confirmation_templates USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "confirmation_templates_read",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(active = true)",
            "with_check": null
          },
          {
            "name": "confirmation_templates_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 12
    },
    "dash_action_logs": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_status",
          "type": "USER-DEFINED",
          "udt_name": "action_status",
          "nullable": false,
          "default": "'pending'::action_status",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "request_payload",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "response_payload",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "context",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_code",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "started_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "duration_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_ip",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_agent",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "action_logs_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_32995_11_not_null",
            "clause": "started_at IS NOT NULL"
          },
          {
            "name": "2200_32995_16_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_32995_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_32995_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_32995_4_not_null",
            "clause": "action_name IS NOT NULL"
          },
          {
            "name": "2200_32995_5_not_null",
            "clause": "action_status IS NOT NULL"
          },
          {
            "name": "2200_32995_6_not_null",
            "clause": "request_payload IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "action_logs_pkey",
          "definition": "CREATE UNIQUE INDEX action_logs_pkey ON public.dash_action_logs USING btree (id)"
        },
        {
          "name": "idx_action_logs_action",
          "definition": "CREATE INDEX idx_action_logs_action ON public.dash_action_logs USING btree (action_name)"
        },
        {
          "name": "idx_action_logs_created",
          "definition": "CREATE INDEX idx_action_logs_created ON public.dash_action_logs USING btree (created_at DESC)"
        },
        {
          "name": "idx_action_logs_status",
          "definition": "CREATE INDEX idx_action_logs_status ON public.dash_action_logs USING btree (action_status)"
        },
        {
          "name": "idx_action_logs_user",
          "definition": "CREATE INDEX idx_action_logs_user ON public.dash_action_logs USING btree (user_id)"
        },
        {
          "name": "idx_action_logs_yacht",
          "definition": "CREATE INDEX idx_action_logs_yacht ON public.dash_action_logs USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "dash_crew_hours_compliance": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "date",
          "type": "date",
          "udt_name": "date",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "hours_worked",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "hours_of_rest",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "violations",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "hours_of_rest_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18218_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18218_11_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18218_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18218_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18218_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_18218_4_not_null",
            "clause": "date IS NOT NULL"
          },
          {
            "name": "2200_18218_5_not_null",
            "clause": "hours_worked IS NOT NULL"
          },
          {
            "name": "2200_18218_6_not_null",
            "clause": "hours_of_rest IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "hours_of_rest_pkey",
          "definition": "CREATE UNIQUE INDEX hours_of_rest_pkey ON public.dash_crew_hours_compliance USING btree (id)"
        },
        {
          "name": "idx_hor_date",
          "definition": "CREATE INDEX idx_hor_date ON public.dash_crew_hours_compliance USING btree (yacht_id, date DESC)"
        },
        {
          "name": "idx_hor_user",
          "definition": "CREATE INDEX idx_hor_user ON public.dash_crew_hours_compliance USING btree (user_id)"
        },
        {
          "name": "idx_hor_violations",
          "definition": "CREATE INDEX idx_hor_violations ON public.dash_crew_hours_compliance USING btree (yacht_id, violations) WHERE (violations = true)"
        },
        {
          "name": "idx_hours_of_rest_date",
          "definition": "CREATE INDEX idx_hours_of_rest_date ON public.dash_crew_hours_compliance USING btree (date)"
        },
        {
          "name": "idx_hours_of_rest_unique",
          "definition": "CREATE UNIQUE INDEX idx_hours_of_rest_unique ON public.dash_crew_hours_compliance USING btree (yacht_id, user_id, date)"
        },
        {
          "name": "idx_hours_of_rest_user_id",
          "definition": "CREATE INDEX idx_hours_of_rest_user_id ON public.dash_crew_hours_compliance USING btree (user_id)"
        },
        {
          "name": "idx_hours_of_rest_yacht_id",
          "definition": "CREATE INDEX idx_hours_of_rest_yacht_id ON public.dash_crew_hours_compliance USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access hours_of_rest",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "dash_handover_items": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "handover_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_type",
          "type": "USER-DEFINED",
          "udt_name": "handover_source_type",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'normal'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "handover_items_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18419_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18419_11_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18419_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18419_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18419_3_not_null",
            "clause": "handover_id IS NOT NULL"
          },
          {
            "name": "2200_18419_4_not_null",
            "clause": "source_type IS NOT NULL"
          },
          {
            "name": "2200_18419_5_not_null",
            "clause": "source_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_items_pkey",
          "definition": "CREATE UNIQUE INDEX handover_items_pkey ON public.dash_handover_items USING btree (id)"
        },
        {
          "name": "idx_handover_items_handover_id",
          "definition": "CREATE INDEX idx_handover_items_handover_id ON public.dash_handover_items USING btree (handover_id)"
        },
        {
          "name": "idx_handover_items_source",
          "definition": "CREATE INDEX idx_handover_items_source ON public.dash_handover_items USING btree (source_type, source_id)"
        },
        {
          "name": "idx_handover_items_yacht_id",
          "definition": "CREATE INDEX idx_handover_items_yacht_id ON public.dash_handover_items USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can manage handover items",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'captain'::text, 'manager'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access handover_items",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view handover items",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "dash_handover_records": {
      "columns": [
        {
          "name": "handover_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "solution_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_page",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_affected",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fault_code",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptoms",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "actions_taken",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "duration_minutes",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'draft'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_source",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entities",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "handover_id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "handover_yacht_user_solution_yacht_key",
            "columns": [
              "user_id",
              "solution_id",
              "yacht_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_27976_1_not_null",
            "clause": "handover_id IS NOT NULL"
          },
          {
            "name": "2200_27976_2_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_27976_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_yacht_pkey",
          "definition": "CREATE UNIQUE INDEX handover_yacht_pkey ON public.dash_handover_records USING btree (handover_id)"
        },
        {
          "name": "handover_yacht_user_solution_yacht_key",
          "definition": "CREATE UNIQUE INDEX handover_yacht_user_solution_yacht_key ON public.dash_handover_records USING btree (user_id, solution_id, yacht_id)"
        },
        {
          "name": "idx_handover_solution",
          "definition": "CREATE INDEX idx_handover_solution ON public.dash_handover_records USING btree (solution_id)"
        },
        {
          "name": "idx_handover_status",
          "definition": "CREATE INDEX idx_handover_status ON public.dash_handover_records USING btree (status)"
        },
        {
          "name": "idx_handover_user_yacht",
          "definition": "CREATE INDEX idx_handover_user_yacht ON public.dash_handover_records USING btree (user_id, yacht_id, created_at DESC)"
        },
        {
          "name": "idx_handover_yacht_document_source",
          "definition": "CREATE INDEX idx_handover_yacht_document_source ON public.dash_handover_records USING btree (document_source)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access handover_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "update_handover_yacht_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 0
    },
    "dash_intelligence_snapshot": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "snapshot_type",
          "type": "USER-DEFINED",
          "udt_name": "snapshot_type",
          "nullable": false,
          "default": "'briefing'::snapshot_type",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "high_risk_equipment",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "risk_movements",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "unstable_systems",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "patterns_7d",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "overdue_critical",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "inventory_gaps",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "inspections_due",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "crew_frustration",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "summary_stats",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generation_duration_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "data_freshness_hours",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "valid_until",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_stale",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "dashboard_snapshot_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_33158_10_not_null",
            "clause": "inspections_due IS NOT NULL"
          },
          {
            "name": "2200_33158_11_not_null",
            "clause": "crew_frustration IS NOT NULL"
          },
          {
            "name": "2200_33158_12_not_null",
            "clause": "summary_stats IS NOT NULL"
          },
          {
            "name": "2200_33158_13_not_null",
            "clause": "generated_at IS NOT NULL"
          },
          {
            "name": "2200_33158_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_33158_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_33158_3_not_null",
            "clause": "snapshot_type IS NOT NULL"
          },
          {
            "name": "2200_33158_4_not_null",
            "clause": "high_risk_equipment IS NOT NULL"
          },
          {
            "name": "2200_33158_5_not_null",
            "clause": "risk_movements IS NOT NULL"
          },
          {
            "name": "2200_33158_6_not_null",
            "clause": "unstable_systems IS NOT NULL"
          },
          {
            "name": "2200_33158_7_not_null",
            "clause": "patterns_7d IS NOT NULL"
          },
          {
            "name": "2200_33158_8_not_null",
            "clause": "overdue_critical IS NOT NULL"
          },
          {
            "name": "2200_33158_9_not_null",
            "clause": "inventory_gaps IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "dashboard_snapshot_pkey",
          "definition": "CREATE UNIQUE INDEX dashboard_snapshot_pkey ON public.dash_intelligence_snapshot USING btree (id)"
        },
        {
          "name": "idx_dashboard_snapshot_active",
          "definition": "CREATE INDEX idx_dashboard_snapshot_active ON public.dash_intelligence_snapshot USING btree (yacht_id, snapshot_type, generated_at DESC)"
        },
        {
          "name": "idx_dashboard_snapshot_generated",
          "definition": "CREATE INDEX idx_dashboard_snapshot_generated ON public.dash_intelligence_snapshot USING btree (generated_at DESC)"
        },
        {
          "name": "idx_dashboard_snapshot_type",
          "definition": "CREATE INDEX idx_dashboard_snapshot_type ON public.dash_intelligence_snapshot USING btree (snapshot_type)"
        },
        {
          "name": "idx_dashboard_snapshot_yacht",
          "definition": "CREATE INDEX idx_dashboard_snapshot_yacht ON public.dash_intelligence_snapshot USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "dash_legacy_view": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_overview",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_by_status",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_orders_overview",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_orders_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_orders_by_status",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_orders_overdue_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "inventory_overview",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "inventory_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "inventory_low_stock_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificates_overview",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificates_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificates_expiring_soon",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fault_history",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "faults_active_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "faults_resolved_30d",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "scheduled_maintenance",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "maintenance_upcoming_7d",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "maintenance_overdue",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "parts_usage",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "documents_summary",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "documents_total",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "valid_until",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "dashboard_legacy_view_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "dashboard_legacy_view_yacht_id_key",
            "columns": [
              "yacht_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_32955_10_not_null",
            "clause": "inventory_overview IS NOT NULL"
          },
          {
            "name": "2200_32955_13_not_null",
            "clause": "certificates_overview IS NOT NULL"
          },
          {
            "name": "2200_32955_16_not_null",
            "clause": "fault_history IS NOT NULL"
          },
          {
            "name": "2200_32955_19_not_null",
            "clause": "scheduled_maintenance IS NOT NULL"
          },
          {
            "name": "2200_32955_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_32955_22_not_null",
            "clause": "parts_usage IS NOT NULL"
          },
          {
            "name": "2200_32955_23_not_null",
            "clause": "documents_summary IS NOT NULL"
          },
          {
            "name": "2200_32955_25_not_null",
            "clause": "generated_at IS NOT NULL"
          },
          {
            "name": "2200_32955_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_32955_3_not_null",
            "clause": "equipment_overview IS NOT NULL"
          },
          {
            "name": "2200_32955_6_not_null",
            "clause": "work_orders_overview IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "dashboard_legacy_view_pkey",
          "definition": "CREATE UNIQUE INDEX dashboard_legacy_view_pkey ON public.dash_legacy_view USING btree (id)"
        },
        {
          "name": "dashboard_legacy_view_yacht_id_key",
          "definition": "CREATE UNIQUE INDEX dashboard_legacy_view_yacht_id_key ON public.dash_legacy_view USING btree (yacht_id)"
        },
        {
          "name": "idx_dashboard_legacy_generated",
          "definition": "CREATE INDEX idx_dashboard_legacy_generated ON public.dash_legacy_view USING btree (generated_at DESC)"
        },
        {
          "name": "idx_dashboard_legacy_yacht",
          "definition": "CREATE INDEX idx_dashboard_legacy_yacht ON public.dash_legacy_view USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "dash_notifications": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "message",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'normal'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_read",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "read_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_31701_10_not_null",
            "clause": "is_read IS NOT NULL"
          },
          {
            "name": "2200_31701_12_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_31701_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_31701_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_31701_5_not_null",
            "clause": "type IS NOT NULL"
          },
          {
            "name": "2200_31701_6_not_null",
            "clause": "title IS NOT NULL"
          },
          {
            "name": "2200_31701_7_not_null",
            "clause": "message IS NOT NULL"
          },
          {
            "name": "2200_31701_8_not_null",
            "clause": "priority IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_notifications_created",
          "definition": "CREATE INDEX idx_notifications_created ON public.dash_notifications USING btree (created_at DESC)"
        },
        {
          "name": "idx_notifications_type",
          "definition": "CREATE INDEX idx_notifications_type ON public.dash_notifications USING btree (type)"
        },
        {
          "name": "idx_notifications_user",
          "definition": "CREATE INDEX idx_notifications_user ON public.dash_notifications USING btree (user_id)"
        },
        {
          "name": "idx_notifications_user_unread",
          "definition": "CREATE INDEX idx_notifications_user_unread ON public.dash_notifications USING btree (user_id, is_read, created_at DESC) WHERE (is_read = false)"
        },
        {
          "name": "idx_notifications_yacht",
          "definition": "CREATE INDEX idx_notifications_yacht ON public.dash_notifications USING btree (yacht_id)"
        },
        {
          "name": "idx_notifications_yacht_created",
          "definition": "CREATE INDEX idx_notifications_yacht_created ON public.dash_notifications USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "notifications_pkey",
          "definition": "CREATE UNIQUE INDEX notifications_pkey ON public.dash_notifications USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "dash_predictive_equipment_risk": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "risk_score",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": "0.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "risk_level",
          "type": "USER-DEFINED",
          "udt_name": "risk_level",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": "0.25",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "trend",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "trend_delta",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "contributing_factors",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_calculated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "previous_risk_score",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "predictive_state_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "predictive_state_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "predictive_state_yacht_id_equipment_id_key",
            "columns": [
              "yacht_id",
              "equipment_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_33090_10_not_null",
            "clause": "last_calculated_at IS NOT NULL"
          },
          {
            "name": "2200_33090_12_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_33090_13_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_33090_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_33090_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_33090_3_not_null",
            "clause": "equipment_id IS NOT NULL"
          },
          {
            "name": "2200_33090_4_not_null",
            "clause": "risk_score IS NOT NULL"
          },
          {
            "name": "2200_33090_6_not_null",
            "clause": "confidence IS NOT NULL"
          },
          {
            "name": "2200_33090_9_not_null",
            "clause": "contributing_factors IS NOT NULL"
          },
          {
            "name": "predictive_state_confidence_check",
            "clause": "((confidence >= (0)::numeric) AND (confidence <= (1)::numeric))"
          },
          {
            "name": "predictive_state_risk_score_check",
            "clause": "((risk_score >= (0)::numeric) AND (risk_score <= (1)::numeric))"
          },
          {
            "name": "predictive_state_trend_check",
            "clause": "(trend = ANY (ARRAY['improving'::text, 'stable'::text, 'worsening'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_predictive_state_level",
          "definition": "CREATE INDEX idx_predictive_state_level ON public.dash_predictive_equipment_risk USING btree (risk_level)"
        },
        {
          "name": "idx_predictive_state_risk",
          "definition": "CREATE INDEX idx_predictive_state_risk ON public.dash_predictive_equipment_risk USING btree (risk_score DESC)"
        },
        {
          "name": "idx_predictive_state_updated",
          "definition": "CREATE INDEX idx_predictive_state_updated ON public.dash_predictive_equipment_risk USING btree (updated_at DESC)"
        },
        {
          "name": "idx_predictive_state_yacht",
          "definition": "CREATE INDEX idx_predictive_state_yacht ON public.dash_predictive_equipment_risk USING btree (yacht_id)"
        },
        {
          "name": "predictive_state_pkey",
          "definition": "CREATE UNIQUE INDEX predictive_state_pkey ON public.dash_predictive_equipment_risk USING btree (id)"
        },
        {
          "name": "predictive_state_yacht_id_equipment_id_key",
          "definition": "CREATE UNIQUE INDEX predictive_state_yacht_id_equipment_id_key ON public.dash_predictive_equipment_risk USING btree (yacht_id, equipment_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [
        {
          "name": "trigger_update_previous_risk",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_previous_risk_score()"
        }
      ],
      "row_count": 0
    },
    "dash_predictive_insights": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "insight_type",
          "type": "USER-DEFINED",
          "udt_name": "insight_type",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "recommendation",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "severity",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "acknowledged",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "acknowledged_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "acknowledged_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "dismissed",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "dismissed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "predictive_insights_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "predictive_insights_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_33125_16_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_33125_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_33125_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_33125_4_not_null",
            "clause": "insight_type IS NOT NULL"
          },
          {
            "name": "2200_33125_5_not_null",
            "clause": "title IS NOT NULL"
          },
          {
            "name": "2200_33125_6_not_null",
            "clause": "description IS NOT NULL"
          },
          {
            "name": "predictive_insights_severity_check",
            "clause": "(severity = ANY (ARRAY['low'::text, 'medium'::text, 'high'::text, 'critical'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_predictive_insights_active",
          "definition": "CREATE INDEX idx_predictive_insights_active ON public.dash_predictive_insights USING btree (yacht_id, dismissed, acknowledged) WHERE (dismissed = false)"
        },
        {
          "name": "idx_predictive_insights_equipment",
          "definition": "CREATE INDEX idx_predictive_insights_equipment ON public.dash_predictive_insights USING btree (equipment_id)"
        },
        {
          "name": "idx_predictive_insights_severity",
          "definition": "CREATE INDEX idx_predictive_insights_severity ON public.dash_predictive_insights USING btree (severity)"
        },
        {
          "name": "idx_predictive_insights_type",
          "definition": "CREATE INDEX idx_predictive_insights_type ON public.dash_predictive_insights USING btree (insight_type)"
        },
        {
          "name": "idx_predictive_insights_yacht",
          "definition": "CREATE INDEX idx_predictive_insights_yacht ON public.dash_predictive_insights USING btree (yacht_id)"
        },
        {
          "name": "predictive_insights_pkey",
          "definition": "CREATE UNIQUE INDEX predictive_insights_pkey ON public.dash_predictive_insights USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "dash_safety_drills": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "drill_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "drill_date",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "conducted_by",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "participants",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "duration_minutes",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "outcome",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "drill_records_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "drill_records_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_24879_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_24879_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_24879_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_24879_3_not_null",
            "clause": "drill_type IS NOT NULL"
          },
          {
            "name": "2200_24879_4_not_null",
            "clause": "drill_date IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "drill_records_pkey",
          "definition": "CREATE UNIQUE INDEX drill_records_pkey ON public.dash_safety_drills USING btree (id)"
        },
        {
          "name": "idx_drill_records_date",
          "definition": "CREATE INDEX idx_drill_records_date ON public.dash_safety_drills USING btree (yacht_id, drill_date)"
        },
        {
          "name": "idx_drill_records_type",
          "definition": "CREATE INDEX idx_drill_records_type ON public.dash_safety_drills USING btree (yacht_id, drill_type)"
        },
        {
          "name": "idx_drill_records_yacht",
          "definition": "CREATE INDEX idx_drill_records_yacht ON public.dash_safety_drills USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access drill_records",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view yacht drill records",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "database_architecture_notes": {
      "columns": [
        {
          "name": "id",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "nextval('database_architecture_notes_id_seq'::regclass)",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "note_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "note_content",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_129605_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129605_2_not_null",
            "clause": "note_type IS NOT NULL"
          },
          {
            "name": "2200_129605_3_not_null",
            "clause": "note_content IS NOT NULL"
          },
          {
            "name": "2200_129605_4_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "database_architecture_notes_pkey",
          "definition": "CREATE UNIQUE INDEX database_architecture_notes_pkey ON public.database_architecture_notes USING btree (id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 5
    },
    "decision_audit_log": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "execution_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "timestamp",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_role",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "decision",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tier",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence_total",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "0.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence_intent",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "0.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence_entity",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "0.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence_situation",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "0.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "reasons",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "blocked_by",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "blocked_by_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "detected_intents",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entities",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "situation",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "environment",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'at_sea'::text",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_146466_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_146466_2_not_null",
            "clause": "execution_id IS NOT NULL"
          },
          {
            "name": "2200_146466_3_not_null",
            "clause": "timestamp IS NOT NULL"
          },
          {
            "name": "2200_146466_4_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_146466_5_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_146466_8_not_null",
            "clause": "action IS NOT NULL"
          },
          {
            "name": "2200_146466_9_not_null",
            "clause": "decision IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "decision_audit_log_pkey",
          "definition": "CREATE UNIQUE INDEX decision_audit_log_pkey ON public.decision_audit_log USING btree (id)"
        },
        {
          "name": "idx_decision_audit_action",
          "definition": "CREATE INDEX idx_decision_audit_action ON public.decision_audit_log USING btree (action, decision)"
        },
        {
          "name": "idx_decision_audit_analytics",
          "definition": "CREATE INDEX idx_decision_audit_analytics ON public.decision_audit_log USING btree (yacht_id, action, decision, \"timestamp\" DESC)"
        },
        {
          "name": "idx_decision_audit_execution",
          "definition": "CREATE INDEX idx_decision_audit_execution ON public.decision_audit_log USING btree (execution_id)"
        },
        {
          "name": "idx_decision_audit_timestamp",
          "definition": "CREATE INDEX idx_decision_audit_timestamp ON public.decision_audit_log USING btree (\"timestamp\" DESC)"
        },
        {
          "name": "idx_decision_audit_user",
          "definition": "CREATE INDEX idx_decision_audit_user ON public.decision_audit_log USING btree (user_id, \"timestamp\" DESC)"
        },
        {
          "name": "idx_decision_audit_yacht",
          "definition": "CREATE INDEX idx_decision_audit_yacht ON public.decision_audit_log USING btree (yacht_id, \"timestamp\" DESC)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role can insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "true"
          },
          {
            "name": "Service role can select",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(auth.role() = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Users can view their yacht decisions",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "((yacht_id)::text = (auth.jwt() ->> 'yacht_id'::text))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 540
    },
    "doc_metadata": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "original_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "filename",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "content_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "size_bytes",
          "type": "bigint",
          "udt_name": "int8",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sha256",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_path",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_ids",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": "'{}'::uuid[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tags",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "'{}'::text[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "indexed",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "indexed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "doc_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "oem",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "model",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_18444_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18444_16_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18444_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18444_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18444_3_not_null",
            "clause": "source IS NOT NULL"
          },
          {
            "name": "2200_18444_5_not_null",
            "clause": "filename IS NOT NULL"
          },
          {
            "name": "2200_18444_9_not_null",
            "clause": "storage_path IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "documents_pkey",
          "definition": "CREATE UNIQUE INDEX documents_pkey ON public.doc_metadata USING btree (id)"
        },
        {
          "name": "idx_documents_created",
          "definition": "CREATE INDEX idx_documents_created ON public.doc_metadata USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "idx_documents_department",
          "definition": "CREATE INDEX idx_documents_department ON public.doc_metadata USING btree ((((metadata -> 'directories'::text) -> 0)))"
        },
        {
          "name": "idx_documents_directories",
          "definition": "CREATE INDEX idx_documents_directories ON public.doc_metadata USING gin (((metadata -> 'directories'::text)))"
        },
        {
          "name": "idx_documents_doc_type",
          "definition": "CREATE INDEX idx_documents_doc_type ON public.doc_metadata USING btree (yacht_id, doc_type)"
        },
        {
          "name": "idx_documents_equipment_ids",
          "definition": "CREATE INDEX idx_documents_equipment_ids ON public.doc_metadata USING gin (equipment_ids)"
        },
        {
          "name": "idx_documents_indexed",
          "definition": "CREATE INDEX idx_documents_indexed ON public.doc_metadata USING btree (indexed)"
        },
        {
          "name": "idx_documents_metadata",
          "definition": "CREATE INDEX idx_documents_metadata ON public.doc_metadata USING gin (metadata)"
        },
        {
          "name": "idx_documents_oem",
          "definition": "CREATE INDEX idx_documents_oem ON public.doc_metadata USING btree (yacht_id, oem)"
        },
        {
          "name": "idx_documents_sha256",
          "definition": "CREATE INDEX idx_documents_sha256 ON public.doc_metadata USING btree (sha256)"
        },
        {
          "name": "idx_documents_source",
          "definition": "CREATE INDEX idx_documents_source ON public.doc_metadata USING btree (source)"
        },
        {
          "name": "idx_documents_system_path",
          "definition": "CREATE INDEX idx_documents_system_path ON public.doc_metadata USING btree (system_path)"
        },
        {
          "name": "idx_documents_system_path_gin",
          "definition": "CREATE INDEX idx_documents_system_path_gin ON public.doc_metadata USING gin (system_path gin_trgm_ops)"
        },
        {
          "name": "idx_documents_system_type",
          "definition": "CREATE INDEX idx_documents_system_type ON public.doc_metadata USING btree (yacht_id, system_type)"
        },
        {
          "name": "idx_documents_tags",
          "definition": "CREATE INDEX idx_documents_tags ON public.doc_metadata USING gin (tags)"
        },
        {
          "name": "idx_documents_yacht_id",
          "definition": "CREATE INDEX idx_documents_yacht_id ON public.doc_metadata USING btree (yacht_id)"
        },
        {
          "name": "idx_documents_yacht_system",
          "definition": "CREATE INDEX idx_documents_yacht_system ON public.doc_metadata USING btree (yacht_id, system_path)"
        },
        {
          "name": "idx_documents_yacht_system_path",
          "definition": "CREATE INDEX idx_documents_yacht_system_path ON public.doc_metadata USING btree (yacht_id, system_path)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can manage documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = jwt_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can insert documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Users can view documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = COALESCE(jwt_yacht_id(), get_user_yacht_id()))",
            "with_check": null
          },
          {
            "name": "doc_metadata_yacht_isolation",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((auth.uid() IS NOT NULL) AND (yacht_id = ((auth.jwt() ->> 'yacht_id'::text))::uuid))",
            "with_check": null
          },
          {
            "name": "service_role_full_access",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 2759
    },
    "doc_sop_edit_history": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sop_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "original_content",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "edited_content",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "edit_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "sop_edits_sop_id_fkey",
            "column": "sop_id",
            "references_table": "doc_sop_procedures",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_28113_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_28113_4_not_null",
            "clause": "original_content IS NOT NULL"
          },
          {
            "name": "2200_28113_5_not_null",
            "clause": "edited_content IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "sop_edits_pkey",
          "definition": "CREATE UNIQUE INDEX sop_edits_pkey ON public.doc_sop_edit_history USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "doc_sop_procedures": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "query",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "content_markdown",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_chunks",
          "type": "ARRAY",
          "udt_name": "_int4",
          "nullable": true,
          "default": "'{}'::integer[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "version",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "1",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_28095_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_28095_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_28095_5_not_null",
            "clause": "title IS NOT NULL"
          },
          {
            "name": "2200_28095_6_not_null",
            "clause": "query IS NOT NULL"
          },
          {
            "name": "2200_28095_7_not_null",
            "clause": "content_markdown IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "sop_documents_pkey",
          "definition": "CREATE UNIQUE INDEX sop_documents_pkey ON public.doc_sop_procedures USING btree (id)"
        },
        {
          "name": "sop_documents_user_id_idx",
          "definition": "CREATE INDEX sop_documents_user_id_idx ON public.doc_sop_procedures USING btree (user_id)"
        },
        {
          "name": "sop_documents_yacht_idx",
          "definition": "CREATE INDEX sop_documents_yacht_idx ON public.doc_sop_procedures USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role has full access to sop_documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
            "with_check": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)"
          },
          {
            "name": "Users can insert SOPs",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(auth.uid() = user_id)"
          },
          {
            "name": "Users can view their yacht's SOPs",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "doc_yacht_library": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_path",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "times_accessed",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "times_helpful",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "times_not_helpful",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_covered",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_used",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_uses",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "successful_uses",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "effectiveness_score",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "department",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "fault_code_matches",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "helpful_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chunk_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chunk_text",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chunk_index",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "page_num",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entities_found",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_weights",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "query",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "score",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chunk_metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_chunk",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "conversion_rate",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_27667_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_27667_2_not_null",
            "clause": "document_name IS NOT NULL"
          },
          {
            "name": "2200_27667_3_not_null",
            "clause": "document_path IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "document_yacht_pkey",
          "definition": "CREATE UNIQUE INDEX document_yacht_pkey ON public.doc_yacht_library USING btree (id)"
        },
        {
          "name": "idx_document_yacht_chunk_id",
          "definition": "CREATE INDEX idx_document_yacht_chunk_id ON public.doc_yacht_library USING btree (chunk_id)"
        },
        {
          "name": "idx_document_yacht_chunk_metadata_gin",
          "definition": "CREATE INDEX idx_document_yacht_chunk_metadata_gin ON public.doc_yacht_library USING gin (chunk_metadata)"
        },
        {
          "name": "idx_document_yacht_conversion_rate",
          "definition": "CREATE INDEX idx_document_yacht_conversion_rate ON public.doc_yacht_library USING btree (conversion_rate DESC)"
        },
        {
          "name": "idx_document_yacht_entities_found_gin",
          "definition": "CREATE INDEX idx_document_yacht_entities_found_gin ON public.doc_yacht_library USING gin (entities_found)"
        },
        {
          "name": "idx_document_yacht_entity_weights_gin",
          "definition": "CREATE INDEX idx_document_yacht_entity_weights_gin ON public.doc_yacht_library USING gin (entity_weights)"
        },
        {
          "name": "idx_document_yacht_is_chunk",
          "definition": "CREATE INDEX idx_document_yacht_is_chunk ON public.doc_yacht_library USING btree (is_chunk)"
        },
        {
          "name": "idx_document_yacht_session_id",
          "definition": "CREATE INDEX idx_document_yacht_session_id ON public.doc_yacht_library USING btree (session_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Allow backend read documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "anon",
              "authenticated"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role can manage all documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(current_setting('role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Service role full access document_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role full access documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can manage own documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          },
          {
            "name": "Users can read own documents",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "update_document_yacht_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 0
    },
    "email_attachments": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "message_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "filename",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "content_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "size_bytes",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "graph_attachment_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "email_attachments_message_id_fkey",
            "column": "message_id",
            "references_table": "email_messages",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "email_attachments_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_144068_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_144068_2_not_null",
            "clause": "message_id IS NOT NULL"
          },
          {
            "name": "2200_144068_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_144068_4_not_null",
            "clause": "filename IS NOT NULL"
          },
          {
            "name": "2200_144068_9_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "email_attachments_pkey",
          "definition": "CREATE UNIQUE INDEX email_attachments_pkey ON public.email_attachments USING btree (id)"
        },
        {
          "name": "idx_email_attachments_message",
          "definition": "CREATE INDEX idx_email_attachments_message ON public.email_attachments USING btree (message_id)"
        },
        {
          "name": "idx_email_attachments_yacht",
          "definition": "CREATE INDEX idx_email_attachments_yacht ON public.email_attachments USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages attachments",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can view yacht attachments",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "email_extraction_jobs": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "query",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "days_back",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "90",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "max_emails",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "500",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "folder_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "started_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "emails_fetched",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "emails_classified",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entries_created",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "current_stage",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "stage_progress",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_details",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "draft_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_136115_18_not_null",
            "clause": "created_by_user_id IS NOT NULL"
          },
          {
            "name": "2200_136115_19_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_136115_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_136115_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_136115_7_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "valid_job_status",
            "clause": "(status = ANY (ARRAY['pending'::text, 'running'::text, 'completed'::text, 'failed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "email_extraction_jobs_pkey",
          "definition": "CREATE UNIQUE INDEX email_extraction_jobs_pkey ON public.email_extraction_jobs USING btree (id)"
        },
        {
          "name": "idx_email_extraction_jobs_status",
          "definition": "CREATE INDEX idx_email_extraction_jobs_status ON public.email_extraction_jobs USING btree (status)"
        },
        {
          "name": "idx_email_extraction_jobs_user",
          "definition": "CREATE INDEX idx_email_extraction_jobs_user ON public.email_extraction_jobs USING btree (created_by_user_id)"
        },
        {
          "name": "idx_email_extraction_jobs_yacht",
          "definition": "CREATE INDEX idx_email_extraction_jobs_yacht ON public.email_extraction_jobs USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "jobs_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "email_link_decisions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "thread_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chosen_object_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chosen_object_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "previous_suggestion",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_score",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "email_link_decisions_thread_id_fkey",
            "column": "thread_id",
            "references_table": "email_threads",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "email_link_decisions_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_140301_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_140301_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_140301_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_140301_3_not_null",
            "clause": "thread_id IS NOT NULL"
          },
          {
            "name": "2200_140301_4_not_null",
            "clause": "action IS NOT NULL"
          },
          {
            "name": "email_link_decisions_action_check",
            "clause": "(action = ANY (ARRAY['accept'::text, 'reject'::text, 'change'::text, 'unlink'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "email_link_decisions_pkey",
          "definition": "CREATE UNIQUE INDEX email_link_decisions_pkey ON public.email_link_decisions USING btree (id)"
        },
        {
          "name": "idx_link_decisions_action",
          "definition": "CREATE INDEX idx_link_decisions_action ON public.email_link_decisions USING btree (yacht_id, action)"
        },
        {
          "name": "idx_link_decisions_thread",
          "definition": "CREATE INDEX idx_link_decisions_thread ON public.email_link_decisions USING btree (thread_id)"
        },
        {
          "name": "idx_link_decisions_yacht",
          "definition": "CREATE INDEX idx_link_decisions_yacht ON public.email_link_decisions USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages link_decisions",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create link_decisions",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))"
          },
          {
            "name": "Users can view yacht link_decisions",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "email_links": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "thread_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "object_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "object_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'suggested'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggested_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggested_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "accepted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "accepted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "modified_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "modified_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "removed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "removed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_primary",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "score",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "score_breakdown",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_blocked",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "email_links_thread_id_fkey",
            "column": "thread_id",
            "references_table": "email_threads",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "email_links_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_138046_13_not_null",
            "clause": "is_active IS NOT NULL"
          },
          {
            "name": "2200_138046_16_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138046_17_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_138046_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138046_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138046_3_not_null",
            "clause": "thread_id IS NOT NULL"
          },
          {
            "name": "2200_138046_4_not_null",
            "clause": "object_type IS NOT NULL"
          },
          {
            "name": "2200_138046_5_not_null",
            "clause": "object_id IS NOT NULL"
          },
          {
            "name": "2200_138046_6_not_null",
            "clause": "confidence IS NOT NULL"
          },
          {
            "name": "email_links_confidence_check",
            "clause": "(confidence = ANY (ARRAY['deterministic'::text, 'user_confirmed'::text, 'suggested'::text]))"
          },
          {
            "name": "email_links_object_type_check",
            "clause": "(object_type = ANY (ARRAY['work_order'::text, 'equipment'::text, 'part'::text, 'fault'::text, 'purchase_order'::text, 'supplier'::text]))"
          },
          {
            "name": "email_links_suggested_reason_check",
            "clause": "(suggested_reason = ANY (ARRAY['token_match'::text, 'vendor_domain'::text, 'wo_pattern'::text, 'po_pattern'::text, 'serial_match'::text, 'part_number'::text, 'manual'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "email_links_pkey",
          "definition": "CREATE UNIQUE INDEX email_links_pkey ON public.email_links USING btree (id)"
        },
        {
          "name": "idx_email_links_blocked",
          "definition": "CREATE INDEX idx_email_links_blocked ON public.email_links USING btree (thread_id) WHERE (user_blocked = true)"
        },
        {
          "name": "idx_email_links_object",
          "definition": "CREATE INDEX idx_email_links_object ON public.email_links USING btree (object_type, object_id) WHERE is_active"
        },
        {
          "name": "idx_email_links_pending",
          "definition": "CREATE INDEX idx_email_links_pending ON public.email_links USING btree (yacht_id, suggested_at DESC) WHERE ((confidence = 'suggested'::text) AND is_active)"
        },
        {
          "name": "idx_email_links_primary",
          "definition": "CREATE INDEX idx_email_links_primary ON public.email_links USING btree (thread_id) WHERE (is_primary = true)"
        },
        {
          "name": "idx_email_links_thread",
          "definition": "CREATE INDEX idx_email_links_thread ON public.email_links USING btree (thread_id) WHERE is_active"
        },
        {
          "name": "idx_email_links_unique_active",
          "definition": "CREATE UNIQUE INDEX idx_email_links_unique_active ON public.email_links USING btree (thread_id, object_type, object_id) WHERE is_active"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages links",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create links",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))"
          },
          {
            "name": "Users can update links",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          },
          {
            "name": "Users can view yacht links",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "audit_email_link_changes",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION audit_email_link_change()"
        },
        {
          "name": "audit_email_link_changes",
          "event": "UPDATE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION audit_email_link_change()"
        },
        {
          "name": "update_email_links_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at()"
        }
      ],
      "row_count": 1
    },
    "email_messages": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "thread_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "provider_message_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "internet_message_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "direction",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "from_address_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "from_display_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "to_addresses_hash",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "cc_addresses_hash",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "subject",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sent_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "received_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "has_attachments",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attachments",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "folder",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'inbox'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "provider_etag",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "subject_embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sender_embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "meta_embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entities_extracted",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entities_extracted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "email_messages_thread_id_fkey",
            "column": "thread_id",
            "references_table": "email_threads",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "email_messages_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "email_messages_yacht_provider_key",
            "columns": [
              "yacht_id",
              "provider_message_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_138016_14_not_null",
            "clause": "has_attachments IS NOT NULL"
          },
          {
            "name": "2200_138016_18_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138016_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138016_2_not_null",
            "clause": "thread_id IS NOT NULL"
          },
          {
            "name": "2200_138016_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138016_4_not_null",
            "clause": "provider_message_id IS NOT NULL"
          },
          {
            "name": "2200_138016_6_not_null",
            "clause": "direction IS NOT NULL"
          },
          {
            "name": "2200_138016_7_not_null",
            "clause": "from_address_hash IS NOT NULL"
          },
          {
            "name": "email_messages_direction_check",
            "clause": "(direction = ANY (ARRAY['inbound'::text, 'outbound'::text]))"
          },
          {
            "name": "email_messages_folder_check",
            "clause": "(folder = ANY (ARRAY['inbox'::text, 'sent'::text, 'drafts'::text, 'other'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "email_messages_pkey",
          "definition": "CREATE UNIQUE INDEX email_messages_pkey ON public.email_messages USING btree (id)"
        },
        {
          "name": "email_messages_yacht_provider_key",
          "definition": "CREATE UNIQUE INDEX email_messages_yacht_provider_key ON public.email_messages USING btree (yacht_id, provider_message_id)"
        },
        {
          "name": "idx_email_messages_direction",
          "definition": "CREATE INDEX idx_email_messages_direction ON public.email_messages USING btree (yacht_id, direction, sent_at DESC)"
        },
        {
          "name": "idx_email_messages_meta_embedding",
          "definition": "CREATE INDEX idx_email_messages_meta_embedding ON public.email_messages USING hnsw (meta_embedding vector_cosine_ops) WITH (m='16', ef_construction='64')"
        },
        {
          "name": "idx_email_messages_subject_embedding",
          "definition": "CREATE INDEX idx_email_messages_subject_embedding ON public.email_messages USING hnsw (subject_embedding vector_cosine_ops) WITH (m='16', ef_construction='64')"
        },
        {
          "name": "idx_email_messages_thread",
          "definition": "CREATE INDEX idx_email_messages_thread ON public.email_messages USING btree (thread_id, sent_at DESC)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can view yacht messages",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 2
    },
    "email_threads": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "provider_conversation_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "latest_subject",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "message_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "has_attachments",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "participant_hashes",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'external'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "first_message_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_activity_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_inbound_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_outbound_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_tokens",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggestions_generated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "thread_embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "email_threads_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "email_threads_yacht_conversation_key",
            "columns": [
              "yacht_id",
              "provider_conversation_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_137990_13_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_137990_14_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_137990_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_137990_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_137990_3_not_null",
            "clause": "provider_conversation_id IS NOT NULL"
          },
          {
            "name": "2200_137990_5_not_null",
            "clause": "message_count IS NOT NULL"
          },
          {
            "name": "2200_137990_6_not_null",
            "clause": "has_attachments IS NOT NULL"
          },
          {
            "name": "2200_137990_8_not_null",
            "clause": "source IS NOT NULL"
          },
          {
            "name": "email_threads_source_check",
            "clause": "(source = ANY (ARRAY['celeste_originated'::text, 'external'::text, 'mixed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "email_threads_pkey",
          "definition": "CREATE UNIQUE INDEX email_threads_pkey ON public.email_threads USING btree (id)"
        },
        {
          "name": "email_threads_yacht_conversation_key",
          "definition": "CREATE UNIQUE INDEX email_threads_yacht_conversation_key ON public.email_threads USING btree (yacht_id, provider_conversation_id)"
        },
        {
          "name": "idx_email_threads_needs_suggestions",
          "definition": "CREATE INDEX idx_email_threads_needs_suggestions ON public.email_threads USING btree (yacht_id, last_activity_at) WHERE (suggestions_generated_at IS NULL)"
        },
        {
          "name": "idx_email_threads_pending_suggestions",
          "definition": "CREATE INDEX idx_email_threads_pending_suggestions ON public.email_threads USING btree (yacht_id, last_activity_at DESC) WHERE (suggestions_generated_at IS NULL)"
        },
        {
          "name": "idx_email_threads_source",
          "definition": "CREATE INDEX idx_email_threads_source ON public.email_threads USING btree (yacht_id, source)"
        },
        {
          "name": "idx_email_threads_thread_embedding",
          "definition": "CREATE INDEX idx_email_threads_thread_embedding ON public.email_threads USING hnsw (thread_embedding vector_cosine_ops) WITH (m='16', ef_construction='64')"
        },
        {
          "name": "idx_email_threads_yacht_activity",
          "definition": "CREATE INDEX idx_email_threads_yacht_activity ON public.email_threads USING btree (yacht_id, last_activity_at DESC)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages threads",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can view yacht threads",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "update_email_threads_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at()"
        }
      ],
      "row_count": 1
    },
    "email_watchers": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "provider",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'microsoft_graph'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "mailbox_address_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "delta_link_inbox",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "delta_link_sent",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "subscription_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "subscription_expires_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_sync_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_sync_error",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sync_status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "backfill_days_inbox",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "14",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "backfill_days_sent",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "14",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "api_calls_this_hour",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "hour_window_start",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sync_interval_minutes",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "15",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_paused",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "pause_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "email_watchers_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "email_watchers_user_yacht_provider_key",
            "columns": [
              "user_id",
              "yacht_id",
              "provider"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_137954_12_not_null",
            "clause": "sync_status IS NOT NULL"
          },
          {
            "name": "2200_137954_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_137954_16_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_137954_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_137954_2_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_137954_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_137954_4_not_null",
            "clause": "provider IS NOT NULL"
          },
          {
            "name": "email_watchers_sync_status_check",
            "clause": "(sync_status = ANY (ARRAY['pending'::text, 'active'::text, 'read_only'::text, 'write_only'::text, 'degraded'::text, 'disconnected'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "email_watchers_pkey",
          "definition": "CREATE UNIQUE INDEX email_watchers_pkey ON public.email_watchers USING btree (id)"
        },
        {
          "name": "email_watchers_user_yacht_provider_key",
          "definition": "CREATE UNIQUE INDEX email_watchers_user_yacht_provider_key ON public.email_watchers USING btree (user_id, yacht_id, provider)"
        },
        {
          "name": "idx_email_watchers_status",
          "definition": "CREATE INDEX idx_email_watchers_status ON public.email_watchers USING btree (yacht_id, sync_status)"
        },
        {
          "name": "idx_email_watchers_subscription",
          "definition": "CREATE INDEX idx_email_watchers_subscription ON public.email_watchers USING btree (subscription_expires_at) WHERE (sync_status = ANY (ARRAY['active'::text, 'degraded'::text]))"
        },
        {
          "name": "idx_email_watchers_user",
          "definition": "CREATE INDEX idx_email_watchers_user ON public.email_watchers USING btree (user_id)"
        },
        {
          "name": "idx_email_watchers_yacht",
          "definition": "CREATE INDEX idx_email_watchers_yacht ON public.email_watchers USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access watchers",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can insert own watcher",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(user_id = auth.uid())"
          },
          {
            "name": "Users can update own watcher",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(user_id = auth.uid())",
            "with_check": "(user_id = auth.uid())"
          },
          {
            "name": "Users can view own watcher",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(user_id = auth.uid())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "update_email_watchers_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at()"
        }
      ],
      "row_count": 1
    },
    "entity_definitions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "canonical_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "aliases",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "'{}'::text[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "category",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extraction_patterns",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "100",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "entity_definitions_yacht_id_entity_type_canonical_name_key",
            "columns": [
              "yacht_id",
              "entity_type",
              "canonical_name"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_135778_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135778_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135778_3_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_135778_4_not_null",
            "clause": "canonical_name IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "entity_definitions_pkey",
          "definition": "CREATE UNIQUE INDEX entity_definitions_pkey ON public.entity_definitions USING btree (id)"
        },
        {
          "name": "entity_definitions_yacht_id_entity_type_canonical_name_key",
          "definition": "CREATE UNIQUE INDEX entity_definitions_yacht_id_entity_type_canonical_name_key ON public.entity_definitions USING btree (yacht_id, entity_type, canonical_name)"
        },
        {
          "name": "idx_entity_definitions_aliases",
          "definition": "CREATE INDEX idx_entity_definitions_aliases ON public.entity_definitions USING gin (aliases)"
        },
        {
          "name": "idx_entity_definitions_type",
          "definition": "CREATE INDEX idx_entity_definitions_type ON public.entity_definitions USING btree (entity_type)"
        },
        {
          "name": "idx_entity_definitions_yacht",
          "definition": "CREATE INDEX idx_entity_definitions_yacht ON public.entity_definitions USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "entity_definitions_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "entity_staging": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_value",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "canonical_label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "0.9",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_chunk_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_document_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_storage_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attributes",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "processed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "graph_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_45115_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_45115_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_45115_3_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_45115_4_not_null",
            "clause": "entity_value IS NOT NULL"
          },
          {
            "name": "2200_45115_5_not_null",
            "clause": "canonical_label IS NOT NULL"
          },
          {
            "name": "entity_staging_status_check",
            "clause": "(status = ANY (ARRAY['pending'::text, 'processing'::text, 'completed'::text, 'failed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "entity_staging_pkey",
          "definition": "CREATE UNIQUE INDEX entity_staging_pkey ON public.entity_staging USING btree (id)"
        },
        {
          "name": "idx_entity_staging_status",
          "definition": "CREATE INDEX idx_entity_staging_status ON public.entity_staging USING btree (status) WHERE (status = 'pending'::text)"
        },
        {
          "name": "idx_entity_staging_yacht",
          "definition": "CREATE INDEX idx_entity_staging_yacht ON public.entity_staging USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 904
    },
    "handover_draft_edits": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "draft_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "draft_item_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "edited_by_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "edited_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "field_edited",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'summary_text'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "original_text",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "edited_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "edit_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "edit_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'modification'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "handover_draft_edits_draft_id_fkey",
            "column": "draft_id",
            "references_table": "handover_drafts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "handover_draft_edits_draft_item_id_fkey",
            "column": "draft_item_id",
            "references_table": "handover_draft_items",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_136030_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_136030_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_136030_2_not_null",
            "clause": "draft_id IS NOT NULL"
          },
          {
            "name": "2200_136030_4_not_null",
            "clause": "edited_by_user_id IS NOT NULL"
          },
          {
            "name": "2200_136030_5_not_null",
            "clause": "edited_at IS NOT NULL"
          },
          {
            "name": "2200_136030_6_not_null",
            "clause": "field_edited IS NOT NULL"
          },
          {
            "name": "2200_136030_8_not_null",
            "clause": "edited_text IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_draft_edits_pkey",
          "definition": "CREATE UNIQUE INDEX handover_draft_edits_pkey ON public.handover_draft_edits USING btree (id)"
        },
        {
          "name": "idx_handover_draft_edits_draft",
          "definition": "CREATE INDEX idx_handover_draft_edits_draft ON public.handover_draft_edits USING btree (draft_id)"
        },
        {
          "name": "idx_handover_draft_edits_item",
          "definition": "CREATE INDEX idx_handover_draft_edits_item ON public.handover_draft_edits USING btree (draft_item_id)"
        },
        {
          "name": "idx_handover_draft_edits_user",
          "definition": "CREATE INDEX idx_handover_draft_edits_user ON public.handover_draft_edits USING btree (edited_by_user_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "draft_edits_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "handover_draft_items": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "draft_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "section_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "section_bucket",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "domain_code",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "summary_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_entry_ids",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_event_ids",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "risk_tags",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence_level",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'HIGH'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "item_order",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "conflict_flag",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "uncertainty_flag",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_critical",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requires_action",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_summary",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "handover_draft_items_draft_id_fkey",
            "column": "draft_id",
            "references_table": "handover_drafts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "handover_draft_items_section_id_fkey",
            "column": "section_id",
            "references_table": "handover_draft_sections",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_135999_11_not_null",
            "clause": "item_order IS NOT NULL"
          },
          {
            "name": "2200_135999_17_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135999_18_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_135999_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135999_2_not_null",
            "clause": "draft_id IS NOT NULL"
          },
          {
            "name": "2200_135999_4_not_null",
            "clause": "section_bucket IS NOT NULL"
          },
          {
            "name": "2200_135999_6_not_null",
            "clause": "summary_text IS NOT NULL"
          },
          {
            "name": "valid_confidence",
            "clause": "(confidence_level = ANY (ARRAY['LOW'::text, 'MEDIUM'::text, 'HIGH'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_draft_items_pkey",
          "definition": "CREATE UNIQUE INDEX handover_draft_items_pkey ON public.handover_draft_items USING btree (id)"
        },
        {
          "name": "idx_handover_draft_items_bucket",
          "definition": "CREATE INDEX idx_handover_draft_items_bucket ON public.handover_draft_items USING btree (section_bucket)"
        },
        {
          "name": "idx_handover_draft_items_critical",
          "definition": "CREATE INDEX idx_handover_draft_items_critical ON public.handover_draft_items USING btree (is_critical) WHERE (is_critical = true)"
        },
        {
          "name": "idx_handover_draft_items_draft",
          "definition": "CREATE INDEX idx_handover_draft_items_draft ON public.handover_draft_items USING btree (draft_id)"
        },
        {
          "name": "idx_handover_draft_items_section",
          "definition": "CREATE INDEX idx_handover_draft_items_section ON public.handover_draft_items USING btree (section_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "draft_items_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "handover_draft_sections": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "draft_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "bucket_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "section_order",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "display_title",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "item_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "critical_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "handover_draft_sections_draft_id_fkey",
            "column": "draft_id",
            "references_table": "handover_drafts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "handover_draft_sections_draft_id_bucket_name_key",
            "columns": [
              "draft_id",
              "bucket_name"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_135979_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135979_2_not_null",
            "clause": "draft_id IS NOT NULL"
          },
          {
            "name": "2200_135979_3_not_null",
            "clause": "bucket_name IS NOT NULL"
          },
          {
            "name": "2200_135979_4_not_null",
            "clause": "section_order IS NOT NULL"
          },
          {
            "name": "2200_135979_8_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_draft_sections_draft_id_bucket_name_key",
          "definition": "CREATE UNIQUE INDEX handover_draft_sections_draft_id_bucket_name_key ON public.handover_draft_sections USING btree (draft_id, bucket_name)"
        },
        {
          "name": "handover_draft_sections_pkey",
          "definition": "CREATE UNIQUE INDEX handover_draft_sections_pkey ON public.handover_draft_sections USING btree (id)"
        },
        {
          "name": "idx_handover_draft_sections_draft",
          "definition": "CREATE INDEX idx_handover_draft_sections_draft ON public.handover_draft_sections USING btree (draft_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "draft_sections_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "handover_drafts": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "period_start",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "period_end",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "department",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generated_by_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generated_by_version",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'1.0'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generation_method",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "state",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'DRAFT'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_modified_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_modified_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_entries",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "critical_entries",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_135957_11_not_null",
            "clause": "state IS NOT NULL"
          },
          {
            "name": "2200_135957_12_not_null",
            "clause": "last_modified_at IS NOT NULL"
          },
          {
            "name": "2200_135957_17_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135957_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135957_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_135957_3_not_null",
            "clause": "period_start IS NOT NULL"
          },
          {
            "name": "2200_135957_4_not_null",
            "clause": "period_end IS NOT NULL"
          },
          {
            "name": "2200_135957_7_not_null",
            "clause": "generated_at IS NOT NULL"
          },
          {
            "name": "valid_state",
            "clause": "(state = ANY (ARRAY['DRAFT'::text, 'IN_REVIEW'::text, 'ACCEPTED'::text, 'SIGNED'::text, 'EXPORTED'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_drafts_pkey",
          "definition": "CREATE UNIQUE INDEX handover_drafts_pkey ON public.handover_drafts USING btree (id)"
        },
        {
          "name": "idx_handover_drafts_department",
          "definition": "CREATE INDEX idx_handover_drafts_department ON public.handover_drafts USING btree (department)"
        },
        {
          "name": "idx_handover_drafts_period",
          "definition": "CREATE INDEX idx_handover_drafts_period ON public.handover_drafts USING btree (period_start, period_end)"
        },
        {
          "name": "idx_handover_drafts_state",
          "definition": "CREATE INDEX idx_handover_drafts_state ON public.handover_drafts USING btree (state)"
        },
        {
          "name": "idx_handover_drafts_yacht",
          "definition": "CREATE INDEX idx_handover_drafts_yacht ON public.handover_drafts USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "handover_drafts_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "handover_entries": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by_role",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by_department",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "primary_domain",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "secondary_domains",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "presentation_bucket",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggested_owner_roles",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "risk_tags",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "narrative_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "summary_text",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_event_ids",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_document_ids",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'candidate'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "classification_flagged",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_critical",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requires_acknowledgment",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_135933_11_not_null",
            "clause": "narrative_text IS NOT NULL"
          },
          {
            "name": "2200_135933_17_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_135933_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135933_21_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135933_22_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_135933_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_135933_3_not_null",
            "clause": "created_by_user_id IS NOT NULL"
          },
          {
            "name": "2200_135933_6_not_null",
            "clause": "primary_domain IS NOT NULL"
          },
          {
            "name": "2200_135933_8_not_null",
            "clause": "presentation_bucket IS NOT NULL"
          },
          {
            "name": "valid_bucket",
            "clause": "(presentation_bucket = ANY (ARRAY['Command'::text, 'Engineering'::text, 'ETO_AVIT'::text, 'Deck'::text, 'Interior'::text, 'Galley'::text, 'Security'::text, 'Admin_Compliance'::text]))"
          },
          {
            "name": "valid_status",
            "clause": "(status = ANY (ARRAY['candidate'::text, 'included'::text, 'suppressed'::text, 'resolved'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_entries_pkey",
          "definition": "CREATE UNIQUE INDEX handover_entries_pkey ON public.handover_entries USING btree (id)"
        },
        {
          "name": "idx_handover_entries_bucket",
          "definition": "CREATE INDEX idx_handover_entries_bucket ON public.handover_entries USING btree (presentation_bucket)"
        },
        {
          "name": "idx_handover_entries_created",
          "definition": "CREATE INDEX idx_handover_entries_created ON public.handover_entries USING btree (created_at DESC)"
        },
        {
          "name": "idx_handover_entries_critical",
          "definition": "CREATE INDEX idx_handover_entries_critical ON public.handover_entries USING btree (is_critical) WHERE (is_critical = true)"
        },
        {
          "name": "idx_handover_entries_domain",
          "definition": "CREATE INDEX idx_handover_entries_domain ON public.handover_entries USING btree (primary_domain)"
        },
        {
          "name": "idx_handover_entries_source",
          "definition": "CREATE INDEX idx_handover_entries_source ON public.handover_entries USING btree (source_entity_type, source_entity_id)"
        },
        {
          "name": "idx_handover_entries_status",
          "definition": "CREATE INDEX idx_handover_entries_status ON public.handover_entries USING btree (status)"
        },
        {
          "name": "idx_handover_entries_user",
          "definition": "CREATE INDEX idx_handover_entries_user ON public.handover_entries USING btree (created_by_user_id)"
        },
        {
          "name": "idx_handover_entries_yacht",
          "definition": "CREATE INDEX idx_handover_entries_yacht ON public.handover_entries USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "handover_entries_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "handover_exports": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "draft_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "export_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_bucket",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'handover-exports'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "file_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "file_size_bytes",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "exported_by_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "exported_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "recipients",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "email_subject",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "email_sent_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "export_status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'completed'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "handover_exports_draft_id_fkey",
            "column": "draft_id",
            "references_table": "handover_drafts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_136078_10_not_null",
            "clause": "exported_at IS NOT NULL"
          },
          {
            "name": "2200_136078_17_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_136078_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_136078_2_not_null",
            "clause": "draft_id IS NOT NULL"
          },
          {
            "name": "2200_136078_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_136078_4_not_null",
            "clause": "export_type IS NOT NULL"
          },
          {
            "name": "2200_136078_9_not_null",
            "clause": "exported_by_user_id IS NOT NULL"
          },
          {
            "name": "valid_export_type",
            "clause": "(export_type = ANY (ARRAY['pdf'::text, 'html'::text, 'email'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_exports_pkey",
          "definition": "CREATE UNIQUE INDEX handover_exports_pkey ON public.handover_exports USING btree (id)"
        },
        {
          "name": "idx_handover_exports_draft",
          "definition": "CREATE INDEX idx_handover_exports_draft ON public.handover_exports USING btree (draft_id)"
        },
        {
          "name": "idx_handover_exports_type",
          "definition": "CREATE INDEX idx_handover_exports_type ON public.handover_exports USING btree (export_type)"
        },
        {
          "name": "idx_handover_exports_user",
          "definition": "CREATE INDEX idx_handover_exports_user ON public.handover_exports USING btree (exported_by_user_id)"
        },
        {
          "name": "idx_handover_exports_yacht",
          "definition": "CREATE INDEX idx_handover_exports_yacht ON public.handover_exports USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "exports_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "handover_items": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "handover_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": 50
        },
        {
          "name": "section",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "summary",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": "'pending'::character varying",
          "is_identity": false,
          "max_length": 20
        },
        {
          "name": "acknowledged_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "acknowledged_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "acknowledgement_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "added_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "fk_handover_items_handover",
            "column": "handover_id",
            "references_table": "handovers",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_138906_14_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138906_15_not_null",
            "clause": "added_by IS NOT NULL"
          },
          {
            "name": "2200_138906_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138906_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138906_3_not_null",
            "clause": "handover_id IS NOT NULL"
          },
          {
            "name": "2200_138906_4_not_null",
            "clause": "entity_id IS NOT NULL"
          },
          {
            "name": "2200_138906_5_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_138906_9_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "chk_handover_items_entity_type",
            "clause": "((entity_type)::text = ANY ((ARRAY['fault'::character varying, 'work_order'::character varying, 'equipment'::character varying, 'part'::character varying, 'document'::character varying, 'note'::character varying, 'general'::character varying])::text[]))"
          },
          {
            "name": "chk_handover_items_status",
            "clause": "((status)::text = ANY ((ARRAY['pending'::character varying, 'acknowledged'::character varying, 'completed'::character varying, 'deferred'::character varying])::text[]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_items_pkey1",
          "definition": "CREATE UNIQUE INDEX handover_items_pkey1 ON public.handover_items USING btree (id)"
        },
        {
          "name": "idx_handover_items_entity",
          "definition": "CREATE INDEX idx_handover_items_entity ON public.handover_items USING btree (entity_type, entity_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "service_role_bypass",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "users_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "users_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_view",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "yacht_isolation_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))"
          },
          {
            "name": "yacht_isolation_select",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 13
    },
    "handover_signoffs": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "draft_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "outgoing_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "outgoing_role",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "outgoing_signed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "outgoing_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "incoming_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "incoming_role",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "incoming_signed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "incoming_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "incoming_acknowledged_critical",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "signoff_complete",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "handover_signoffs_draft_id_fkey",
            "column": "draft_id",
            "references_table": "handover_drafts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "handover_signoffs_draft_id_key",
            "columns": [
              "draft_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_136055_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_136055_16_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_136055_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_136055_2_not_null",
            "clause": "draft_id IS NOT NULL"
          },
          {
            "name": "2200_136055_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_136055_4_not_null",
            "clause": "outgoing_user_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_signoffs_draft_id_key",
          "definition": "CREATE UNIQUE INDEX handover_signoffs_draft_id_key ON public.handover_signoffs USING btree (draft_id)"
        },
        {
          "name": "handover_signoffs_pkey",
          "definition": "CREATE UNIQUE INDEX handover_signoffs_pkey ON public.handover_signoffs USING btree (id)"
        },
        {
          "name": "idx_handover_signoffs_draft",
          "definition": "CREATE INDEX idx_handover_signoffs_draft ON public.handover_signoffs USING btree (draft_id)"
        },
        {
          "name": "idx_handover_signoffs_incoming",
          "definition": "CREATE INDEX idx_handover_signoffs_incoming ON public.handover_signoffs USING btree (incoming_user_id)"
        },
        {
          "name": "idx_handover_signoffs_outgoing",
          "definition": "CREATE INDEX idx_handover_signoffs_outgoing ON public.handover_signoffs USING btree (outgoing_user_id)"
        },
        {
          "name": "idx_handover_signoffs_yacht",
          "definition": "CREATE INDEX idx_handover_signoffs_yacht ON public.handover_signoffs USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "signoffs_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "handover_sources": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "external_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_bucket",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "subject",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "body_preview",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sender_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sender_email",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "received_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_processed",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "processed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "processing_error",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "classification",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_136100_16_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_136100_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_136100_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_136100_3_not_null",
            "clause": "source_type IS NOT NULL"
          },
          {
            "name": "valid_source_type",
            "clause": "(source_type = ANY (ARRAY['email'::text, 'document'::text, 'work_order'::text, 'fault'::text, 'message'::text, 'api'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "handover_sources_pkey",
          "definition": "CREATE UNIQUE INDEX handover_sources_pkey ON public.handover_sources USING btree (id)"
        },
        {
          "name": "idx_handover_sources_external",
          "definition": "CREATE INDEX idx_handover_sources_external ON public.handover_sources USING btree (external_id)"
        },
        {
          "name": "idx_handover_sources_processed",
          "definition": "CREATE INDEX idx_handover_sources_processed ON public.handover_sources USING btree (is_processed)"
        },
        {
          "name": "idx_handover_sources_type",
          "definition": "CREATE INDEX idx_handover_sources_type ON public.handover_sources USING btree (source_type)"
        },
        {
          "name": "idx_handover_sources_yacht",
          "definition": "CREATE INDEX idx_handover_sources_yacht ON public.handover_sources USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "sources_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "handovers": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": "'draft'::character varying",
          "is_identity": false,
          "max_length": 20
        },
        {
          "name": "from_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "to_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "shift_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "shift_type",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 50
        },
        {
          "name": "started_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approval_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_138886_16_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138886_17_not_null",
            "clause": "created_by IS NOT NULL"
          },
          {
            "name": "2200_138886_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138886_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138886_5_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "chk_handovers_status",
            "clause": "((status)::text = ANY ((ARRAY['draft'::character varying, 'pending_review'::character varying, 'approved'::character varying, 'completed'::character varying, 'cancelled'::character varying])::text[]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "handovers_pkey",
          "definition": "CREATE UNIQUE INDEX handovers_pkey ON public.handovers USING btree (id)"
        },
        {
          "name": "idx_handovers_created_at",
          "definition": "CREATE INDEX idx_handovers_created_at ON public.handovers USING btree (created_at DESC)"
        },
        {
          "name": "idx_handovers_status",
          "definition": "CREATE INDEX idx_handovers_status ON public.handovers USING btree (status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_handovers_yacht_id",
          "definition": "CREATE INDEX idx_handovers_yacht_id ON public.handovers USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "service_role_bypass",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "users_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "users_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_view",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "yacht_isolation_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))"
          },
          {
            "name": "yacht_isolation_select",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 3
    },
    "intent_patterns": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "intent_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "pattern_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "pattern",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "weight",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "examples",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_135796_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135796_2_not_null",
            "clause": "intent_type IS NOT NULL"
          },
          {
            "name": "2200_135796_3_not_null",
            "clause": "pattern_type IS NOT NULL"
          },
          {
            "name": "2200_135796_4_not_null",
            "clause": "pattern IS NOT NULL"
          },
          {
            "name": "2200_135796_8_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "intent_patterns_pkey",
          "definition": "CREATE UNIQUE INDEX intent_patterns_pkey ON public.intent_patterns USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "intent_patterns_read",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(active = true)",
            "with_check": null
          },
          {
            "name": "intent_patterns_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 25
    },
    "ledger_day_anchors": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "anchor_date",
          "type": "date",
          "udt_name": "date",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_mutations",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_reads",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_contexts",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "mutation_by_type",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "mutations_by_user",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "mutations_by_department",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "actions_breakdown",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "first_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "first_event_time",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_event_time",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "day_proof_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "previous_day_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_finalized",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "finalized_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "ledger_day_anchors_yacht_id_anchor_date_key",
            "columns": [
              "yacht_id",
              "anchor_date"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_135706_19_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135706_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135706_20_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_135706_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_135706_3_not_null",
            "clause": "anchor_date IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_ledger_day_anchors_date",
          "definition": "CREATE INDEX idx_ledger_day_anchors_date ON public.ledger_day_anchors USING btree (anchor_date DESC)"
        },
        {
          "name": "idx_ledger_day_anchors_yacht",
          "definition": "CREATE INDEX idx_ledger_day_anchors_yacht ON public.ledger_day_anchors USING btree (yacht_id)"
        },
        {
          "name": "idx_ledger_day_anchors_yacht_date",
          "definition": "CREATE INDEX idx_ledger_day_anchors_yacht_date ON public.ledger_day_anchors USING btree (yacht_id, anchor_date DESC)"
        },
        {
          "name": "ledger_day_anchors_pkey",
          "definition": "CREATE UNIQUE INDEX ledger_day_anchors_pkey ON public.ledger_day_anchors USING btree (id)"
        },
        {
          "name": "ledger_day_anchors_yacht_id_anchor_date_key",
          "definition": "CREATE UNIQUE INDEX ledger_day_anchors_yacht_id_anchor_date_key ON public.ledger_day_anchors USING btree (yacht_id, anchor_date)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "day_anchors_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "ledger_events": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "event_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "previous_state",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "new_state",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "change_summary",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_role",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_department",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_context",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "related_event_ids",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "proof_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "previous_proof_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "day_anchor_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "event_timestamp",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_135681_10_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_135681_17_not_null",
            "clause": "proof_hash IS NOT NULL"
          },
          {
            "name": "2200_135681_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135681_20_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135681_21_not_null",
            "clause": "event_timestamp IS NOT NULL"
          },
          {
            "name": "2200_135681_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_135681_3_not_null",
            "clause": "event_type IS NOT NULL"
          },
          {
            "name": "2200_135681_4_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_135681_5_not_null",
            "clause": "entity_id IS NOT NULL"
          },
          {
            "name": "2200_135681_6_not_null",
            "clause": "action IS NOT NULL"
          },
          {
            "name": "valid_event_type",
            "clause": "(event_type = ANY (ARRAY['create'::text, 'update'::text, 'delete'::text, 'status_change'::text, 'assignment'::text, 'approval'::text, 'rejection'::text, 'escalation'::text, 'handover'::text, 'import'::text, 'export'::text]))"
          },
          {
            "name": "valid_source_context",
            "clause": "(source_context = ANY (ARRAY['search'::text, 'direct'::text, 'microaction'::text, 'api'::text, 'scheduled'::text, 'import'::text, 'system'::text, 'handover'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_ledger_events_action",
          "definition": "CREATE INDEX idx_ledger_events_action ON public.ledger_events USING btree (action)"
        },
        {
          "name": "idx_ledger_events_created",
          "definition": "CREATE INDEX idx_ledger_events_created ON public.ledger_events USING btree (created_at DESC)"
        },
        {
          "name": "idx_ledger_events_day_anchor",
          "definition": "CREATE INDEX idx_ledger_events_day_anchor ON public.ledger_events USING btree (day_anchor_id)"
        },
        {
          "name": "idx_ledger_events_entity",
          "definition": "CREATE INDEX idx_ledger_events_entity ON public.ledger_events USING btree (entity_type, entity_id)"
        },
        {
          "name": "idx_ledger_events_metadata",
          "definition": "CREATE INDEX idx_ledger_events_metadata ON public.ledger_events USING gin (metadata)"
        },
        {
          "name": "idx_ledger_events_new_state",
          "definition": "CREATE INDEX idx_ledger_events_new_state ON public.ledger_events USING gin (new_state)"
        },
        {
          "name": "idx_ledger_events_session",
          "definition": "CREATE INDEX idx_ledger_events_session ON public.ledger_events USING btree (session_id)"
        },
        {
          "name": "idx_ledger_events_timestamp",
          "definition": "CREATE INDEX idx_ledger_events_timestamp ON public.ledger_events USING btree (event_timestamp DESC)"
        },
        {
          "name": "idx_ledger_events_type",
          "definition": "CREATE INDEX idx_ledger_events_type ON public.ledger_events USING btree (event_type)"
        },
        {
          "name": "idx_ledger_events_user",
          "definition": "CREATE INDEX idx_ledger_events_user ON public.ledger_events USING btree (user_id)"
        },
        {
          "name": "idx_ledger_events_yacht",
          "definition": "CREATE INDEX idx_ledger_events_yacht ON public.ledger_events USING btree (yacht_id)"
        },
        {
          "name": "idx_ledger_events_yacht_entity_time",
          "definition": "CREATE INDEX idx_ledger_events_yacht_entity_time ON public.ledger_events USING btree (yacht_id, entity_type, event_timestamp DESC)"
        },
        {
          "name": "ledger_events_pkey",
          "definition": "CREATE UNIQUE INDEX ledger_events_pkey ON public.ledger_events USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "ledger_events_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "ledger_filter_presets": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "filters",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "display_options",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_default",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "use_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_used_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "ledger_filter_presets_yacht_id_user_id_name_key",
            "columns": [
              "yacht_id",
              "user_id",
              "name"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_135729_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135729_12_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_135729_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135729_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_135729_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_135729_4_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "2200_135729_6_not_null",
            "clause": "filters IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_ledger_filter_presets_user",
          "definition": "CREATE INDEX idx_ledger_filter_presets_user ON public.ledger_filter_presets USING btree (user_id)"
        },
        {
          "name": "ledger_filter_presets_pkey",
          "definition": "CREATE UNIQUE INDEX ledger_filter_presets_pkey ON public.ledger_filter_presets USING btree (id)"
        },
        {
          "name": "ledger_filter_presets_yacht_id_user_id_name_key",
          "definition": "CREATE UNIQUE INDEX ledger_filter_presets_yacht_id_user_id_name_key ON public.ledger_filter_presets USING btree (yacht_id, user_id, name)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "filter_presets_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(user_id = auth.uid())",
            "with_check": null
          },
          {
            "name": "filter_presets_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(user_id = auth.uid())"
          },
          {
            "name": "filter_presets_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "filter_presets_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(user_id = auth.uid())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "log_events": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "event_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "event_logs_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18053_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18053_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18053_4_not_null",
            "clause": "event_type IS NOT NULL"
          },
          {
            "name": "2200_18053_8_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "event_logs_pkey",
          "definition": "CREATE UNIQUE INDEX event_logs_pkey ON public.log_events USING btree (id)"
        },
        {
          "name": "idx_event_logs_created_at",
          "definition": "CREATE INDEX idx_event_logs_created_at ON public.log_events USING btree (created_at)"
        },
        {
          "name": "idx_event_logs_event_type",
          "definition": "CREATE INDEX idx_event_logs_event_type ON public.log_events USING btree (event_type)"
        },
        {
          "name": "idx_event_logs_user_id",
          "definition": "CREATE INDEX idx_event_logs_user_id ON public.log_events USING btree (user_id)"
        },
        {
          "name": "idx_event_logs_yacht_id",
          "definition": "CREATE INDEX idx_event_logs_yacht_id ON public.log_events USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access event_logs",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can insert event logs",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Users can view yacht event logs",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "log_pipeline_execution": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "step",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_details",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "duration_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pipeline_logs_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pipeline_logs_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_33023_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_33023_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_33023_4_not_null",
            "clause": "step IS NOT NULL"
          },
          {
            "name": "2200_33023_5_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "pipeline_logs_status_check",
            "clause": "(status = ANY (ARRAY['info'::text, 'warning'::text, 'retry'::text, 'failed'::text, 'success'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pipeline_logs_created",
          "definition": "CREATE INDEX idx_pipeline_logs_created ON public.log_pipeline_execution USING btree (created_at DESC)"
        },
        {
          "name": "idx_pipeline_logs_document",
          "definition": "CREATE INDEX idx_pipeline_logs_document ON public.log_pipeline_execution USING btree (document_id)"
        },
        {
          "name": "idx_pipeline_logs_status",
          "definition": "CREATE INDEX idx_pipeline_logs_status ON public.log_pipeline_execution USING btree (status)"
        },
        {
          "name": "idx_pipeline_logs_step",
          "definition": "CREATE INDEX idx_pipeline_logs_step ON public.log_pipeline_execution USING btree (step)"
        },
        {
          "name": "idx_pipeline_logs_yacht",
          "definition": "CREATE INDEX idx_pipeline_logs_yacht ON public.log_pipeline_execution USING btree (yacht_id)"
        },
        {
          "name": "pipeline_logs_pkey",
          "definition": "CREATE UNIQUE INDEX pipeline_logs_pkey ON public.log_pipeline_execution USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "log_system_events": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "event_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "event_data",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_33055_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_33055_2_not_null",
            "clause": "event_type IS NOT NULL"
          },
          {
            "name": "2200_33055_4_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_system_logs_created",
          "definition": "CREATE INDEX idx_system_logs_created ON public.log_system_events USING btree (created_at DESC)"
        },
        {
          "name": "idx_system_logs_type",
          "definition": "CREATE INDEX idx_system_logs_type ON public.log_system_events USING btree (event_type)"
        },
        {
          "name": "system_logs_pkey",
          "definition": "CREATE UNIQUE INDEX system_logs_pkey ON public.log_system_events USING btree (id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "navigation_contexts": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ended_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "active_anchor_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "active_anchor_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_entities",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "temporal_bias",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'now'::text",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "navigation_contexts_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_140179_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_140179_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_140179_3_not_null",
            "clause": "created_by_user_id IS NOT NULL"
          },
          {
            "name": "2200_140179_4_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_140179_6_not_null",
            "clause": "active_anchor_type IS NOT NULL"
          },
          {
            "name": "2200_140179_7_not_null",
            "clause": "active_anchor_id IS NOT NULL"
          },
          {
            "name": "2200_140179_8_not_null",
            "clause": "extracted_entities IS NOT NULL"
          },
          {
            "name": "2200_140179_9_not_null",
            "clause": "temporal_bias IS NOT NULL"
          },
          {
            "name": "navigation_contexts_active_anchor_type_check",
            "clause": "(active_anchor_type = ANY (ARRAY['manual_section'::text, 'document'::text, 'inventory_item'::text, 'work_order'::text, 'fault'::text, 'shopping_item'::text, 'shopping_list'::text, 'email_thread'::text, 'certificate'::text, 'equipment'::text, 'part'::text]))"
          },
          {
            "name": "navigation_contexts_temporal_bias_check",
            "clause": "(temporal_bias = ANY (ARRAY['now'::text, 'recent'::text, 'historical'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_navigation_contexts_active",
          "definition": "CREATE INDEX idx_navigation_contexts_active ON public.navigation_contexts USING btree (yacht_id, created_by_user_id) WHERE (ended_at IS NULL)"
        },
        {
          "name": "idx_navigation_contexts_yacht_created",
          "definition": "CREATE INDEX idx_navigation_contexts_yacht_created ON public.navigation_contexts USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "navigation_contexts_pkey",
          "definition": "CREATE UNIQUE INDEX navigation_contexts_pkey ON public.navigation_contexts USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages navigation_contexts",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "navigation_contexts_insert_own_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))) AND (created_by_user_id = auth.uid()))"
          },
          {
            "name": "navigation_contexts_select_own_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          },
          {
            "name": "navigation_contexts_update_own",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "UPDATE",
            "using": "((yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))) AND (created_by_user_id = auth.uid()))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 26
    },
    "onedrive_connections": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_principal_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "access_token_encrypted",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "refresh_token_encrypted",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "token_expires_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sync_enabled",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "selected_folders",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_sync_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "uq_yacht_user",
            "columns": [
              "yacht_id",
              "user_principal_name"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_126479_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_126479_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_126479_3_not_null",
            "clause": "user_principal_name IS NOT NULL"
          },
          {
            "name": "2200_126479_4_not_null",
            "clause": "access_token_encrypted IS NOT NULL"
          },
          {
            "name": "2200_126479_5_not_null",
            "clause": "refresh_token_encrypted IS NOT NULL"
          },
          {
            "name": "2200_126479_6_not_null",
            "clause": "token_expires_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "ix_onedrive_connections_yacht_id",
          "definition": "CREATE INDEX ix_onedrive_connections_yacht_id ON public.onedrive_connections USING btree (yacht_id)"
        },
        {
          "name": "onedrive_connections_pkey",
          "definition": "CREATE UNIQUE INDEX onedrive_connections_pkey ON public.onedrive_connections USING btree (id)"
        },
        {
          "name": "uq_yacht_user",
          "definition": "CREATE UNIQUE INDEX uq_yacht_user ON public.onedrive_connections USING btree (yacht_id, user_principal_name)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 1
    },
    "onedrive_sync_jobs": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "connection_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "job_status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_files_found",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "files_succeeded",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "files_failed",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "started_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "onedrive_sync_jobs_connection_id_fkey",
            "column": "connection_id",
            "references_table": "onedrive_connections",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_126511_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_126511_2_not_null",
            "clause": "connection_id IS NOT NULL"
          },
          {
            "name": "2200_126511_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_126511_4_not_null",
            "clause": "job_status IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "ix_onedrive_sync_jobs_yacht_id",
          "definition": "CREATE INDEX ix_onedrive_sync_jobs_yacht_id ON public.onedrive_sync_jobs USING btree (yacht_id)"
        },
        {
          "name": "onedrive_sync_jobs_pkey",
          "definition": "CREATE UNIQUE INDEX onedrive_sync_jobs_pkey ON public.onedrive_sync_jobs USING btree (id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "onedrive_sync_state": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "connection_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "onedrive_item_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "onedrive_path",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "file_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "file_size",
          "type": "bigint",
          "udt_name": "int8",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "onedrive_etag",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sync_status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "supabase_doc_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "onedrive_sync_state_connection_id_fkey",
            "column": "connection_id",
            "references_table": "onedrive_connections",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "uq_connection_item",
            "columns": [
              "connection_id",
              "onedrive_item_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_126493_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_126493_2_not_null",
            "clause": "connection_id IS NOT NULL"
          },
          {
            "name": "2200_126493_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_126493_4_not_null",
            "clause": "onedrive_item_id IS NOT NULL"
          },
          {
            "name": "2200_126493_5_not_null",
            "clause": "onedrive_path IS NOT NULL"
          },
          {
            "name": "2200_126493_6_not_null",
            "clause": "file_name IS NOT NULL"
          },
          {
            "name": "2200_126493_9_not_null",
            "clause": "sync_status IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "ix_onedrive_sync_state_yacht_id",
          "definition": "CREATE INDEX ix_onedrive_sync_state_yacht_id ON public.onedrive_sync_state USING btree (yacht_id)"
        },
        {
          "name": "onedrive_sync_state_pkey",
          "definition": "CREATE UNIQUE INDEX onedrive_sync_state_pkey ON public.onedrive_sync_state USING btree (id)"
        },
        {
          "name": "uq_connection_item",
          "definition": "CREATE UNIQUE INDEX uq_connection_item ON public.onedrive_sync_state USING btree (connection_id, onedrive_item_id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_attachments": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": 50
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "filename",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "original_filename",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "mime_type",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "file_size",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_path",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "width",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "height",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "thumbnail_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tags",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "uploaded_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "uploaded_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_138797_16_not_null",
            "clause": "uploaded_by IS NOT NULL"
          },
          {
            "name": "2200_138797_17_not_null",
            "clause": "uploaded_at IS NOT NULL"
          },
          {
            "name": "2200_138797_18_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138797_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138797_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138797_3_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_138797_4_not_null",
            "clause": "entity_id IS NOT NULL"
          },
          {
            "name": "2200_138797_5_not_null",
            "clause": "filename IS NOT NULL"
          },
          {
            "name": "2200_138797_7_not_null",
            "clause": "mime_type IS NOT NULL"
          },
          {
            "name": "2200_138797_9_not_null",
            "clause": "storage_path IS NOT NULL"
          },
          {
            "name": "chk_pms_attachments_entity_type",
            "clause": "((entity_type)::text = ANY ((ARRAY['fault'::character varying, 'work_order'::character varying, 'equipment'::character varying, 'checklist_item'::character varying, 'note'::character varying, 'handover'::character varying, 'purchase_order'::character varying])::text[]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_attachments_entity",
          "definition": "CREATE INDEX idx_pms_attachments_entity ON public.pms_attachments USING btree (entity_type, entity_id)"
        },
        {
          "name": "idx_pms_attachments_mime_type",
          "definition": "CREATE INDEX idx_pms_attachments_mime_type ON public.pms_attachments USING btree (mime_type)"
        },
        {
          "name": "idx_pms_attachments_uploaded_by",
          "definition": "CREATE INDEX idx_pms_attachments_uploaded_by ON public.pms_attachments USING btree (uploaded_by)"
        },
        {
          "name": "idx_pms_attachments_yacht_id",
          "definition": "CREATE INDEX idx_pms_attachments_yacht_id ON public.pms_attachments USING btree (yacht_id)"
        },
        {
          "name": "pms_attachments_pkey",
          "definition": "CREATE UNIQUE INDEX pms_attachments_pkey ON public.pms_attachments USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "service_role_bypass",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "users_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "users_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_view",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "yacht_isolation_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))"
          },
          {
            "name": "yacht_isolation_select",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_pms_attachments_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_pms_attachments_updated_at()"
        }
      ],
      "row_count": 6
    },
    "pms_audit_log": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "signature",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "old_values",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "new_values",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_126648_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_126648_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_126648_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_126648_3_not_null",
            "clause": "action IS NOT NULL"
          },
          {
            "name": "2200_126648_4_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_126648_5_not_null",
            "clause": "entity_id IS NOT NULL"
          },
          {
            "name": "2200_126648_6_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_126648_7_not_null",
            "clause": "signature IS NOT NULL"
          },
          {
            "name": "2200_126648_9_not_null",
            "clause": "new_values IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_audit_log_action",
          "definition": "CREATE INDEX idx_pms_audit_log_action ON public.pms_audit_log USING btree (action, created_at DESC)"
        },
        {
          "name": "idx_pms_audit_log_entity",
          "definition": "CREATE INDEX idx_pms_audit_log_entity ON public.pms_audit_log USING btree (entity_type, entity_id, created_at DESC)"
        },
        {
          "name": "idx_pms_audit_log_user",
          "definition": "CREATE INDEX idx_pms_audit_log_user ON public.pms_audit_log USING btree (user_id, created_at DESC)"
        },
        {
          "name": "idx_pms_audit_log_yacht",
          "definition": "CREATE INDEX idx_pms_audit_log_yacht ON public.pms_audit_log USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "pms_audit_log_pkey",
          "definition": "CREATE UNIQUE INDEX pms_audit_log_pkey ON public.pms_audit_log USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "pms_audit_log_yacht_isolation",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = (current_setting('app.current_yacht_id'::text))::uuid)",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 147
    },
    "pms_certificates": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificate_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificate_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificate_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "issuing_authority",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "issue_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expiry_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'valid'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "superseded_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_certificates_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_certificates_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_certificates_superseded_by_fkey",
            "column": "superseded_by",
            "references_table": "pms_certificates",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_certificates_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_144139_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_144139_16_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_144139_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_144139_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_144139_3_not_null",
            "clause": "certificate_name IS NOT NULL"
          },
          {
            "name": "2200_144139_4_not_null",
            "clause": "certificate_type IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_certificates_equipment",
          "definition": "CREATE INDEX idx_certificates_equipment ON public.pms_certificates USING btree (equipment_id) WHERE (equipment_id IS NOT NULL)"
        },
        {
          "name": "idx_certificates_expiry",
          "definition": "CREATE INDEX idx_certificates_expiry ON public.pms_certificates USING btree (expiry_date) WHERE (expiry_date IS NOT NULL)"
        },
        {
          "name": "idx_certificates_status",
          "definition": "CREATE INDEX idx_certificates_status ON public.pms_certificates USING btree (status)"
        },
        {
          "name": "idx_certificates_type",
          "definition": "CREATE INDEX idx_certificates_type ON public.pms_certificates USING btree (certificate_type)"
        },
        {
          "name": "idx_certificates_yacht",
          "definition": "CREATE INDEX idx_certificates_yacht ON public.pms_certificates USING btree (yacht_id)"
        },
        {
          "name": "pms_certificates_pkey",
          "definition": "CREATE UNIQUE INDEX pms_certificates_pkey ON public.pms_certificates USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can delete certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Officers can create certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text, 'captain'::text, 'purser'::text])))"
          },
          {
            "name": "Officers can update certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text, 'captain'::text, 'purser'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can view certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_checklist_items": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "checklist_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "instructions",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sequence",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_completed",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completion_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_required",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requires_photo",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requires_signature",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requires_value",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "value_type",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 20
        },
        {
          "name": "value_unit",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 50
        },
        {
          "name": "value_min",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "value_max",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "recorded_value",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "recorded_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "recorded_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "photo_url",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "signature_data",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": "'pending'::character varying",
          "is_identity": false,
          "max_length": 20
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "fk_pms_checklist_items_checklist",
            "column": "checklist_id",
            "references_table": "pms_checklists",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_138763_11_not_null",
            "clause": "is_required IS NOT NULL"
          },
          {
            "name": "2200_138763_12_not_null",
            "clause": "requires_photo IS NOT NULL"
          },
          {
            "name": "2200_138763_13_not_null",
            "clause": "requires_signature IS NOT NULL"
          },
          {
            "name": "2200_138763_14_not_null",
            "clause": "requires_value IS NOT NULL"
          },
          {
            "name": "2200_138763_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138763_24_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_138763_26_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138763_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138763_3_not_null",
            "clause": "checklist_id IS NOT NULL"
          },
          {
            "name": "2200_138763_4_not_null",
            "clause": "description IS NOT NULL"
          },
          {
            "name": "2200_138763_6_not_null",
            "clause": "sequence IS NOT NULL"
          },
          {
            "name": "2200_138763_7_not_null",
            "clause": "is_completed IS NOT NULL"
          },
          {
            "name": "chk_pms_checklist_items_status",
            "clause": "((status)::text = ANY ((ARRAY['pending'::character varying, 'in_progress'::character varying, 'completed'::character varying, 'skipped'::character varying, 'na'::character varying])::text[]))"
          },
          {
            "name": "chk_pms_checklist_items_value_type",
            "clause": "((value_type IS NULL) OR ((value_type)::text = ANY ((ARRAY['number'::character varying, 'text'::character varying, 'boolean'::character varying, 'date'::character varying])::text[])))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_checklist_items_checklist_id",
          "definition": "CREATE INDEX idx_pms_checklist_items_checklist_id ON public.pms_checklist_items USING btree (checklist_id)"
        },
        {
          "name": "idx_pms_checklist_items_completed",
          "definition": "CREATE INDEX idx_pms_checklist_items_completed ON public.pms_checklist_items USING btree (is_completed) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_pms_checklist_items_sequence",
          "definition": "CREATE INDEX idx_pms_checklist_items_sequence ON public.pms_checklist_items USING btree (checklist_id, sequence)"
        },
        {
          "name": "idx_pms_checklist_items_status",
          "definition": "CREATE INDEX idx_pms_checklist_items_status ON public.pms_checklist_items USING btree (status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_pms_checklist_items_yacht_id",
          "definition": "CREATE INDEX idx_pms_checklist_items_yacht_id ON public.pms_checklist_items USING btree (yacht_id)"
        },
        {
          "name": "pms_checklist_items_pkey",
          "definition": "CREATE UNIQUE INDEX pms_checklist_items_pkey ON public.pms_checklist_items USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "service_role_bypass",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "users_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "users_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_view",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "yacht_isolation_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))"
          },
          {
            "name": "yacht_isolation_select",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_pms_checklist_items_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_pms_checklist_items_updated_at()"
        },
        {
          "name": "trg_update_checklist_counts",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_checklist_completion_count()"
        },
        {
          "name": "trg_update_checklist_counts",
          "event": "DELETE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_checklist_completion_count()"
        },
        {
          "name": "trg_update_checklist_counts",
          "event": "UPDATE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_checklist_completion_count()"
        }
      ],
      "row_count": 29
    },
    "pms_checklists": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "checklist_type",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": "'maintenance'::character varying",
          "is_identity": false,
          "max_length": 50
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": "'active'::character varying",
          "is_identity": false,
          "max_length": 20
        },
        {
          "name": "is_template",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_items",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_items",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "fk_pms_checklists_equipment",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "fk_pms_checklists_work_order",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_138728_13_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138728_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138728_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138728_3_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "2200_138728_5_not_null",
            "clause": "checklist_type IS NOT NULL"
          },
          {
            "name": "2200_138728_8_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_138728_9_not_null",
            "clause": "is_template IS NOT NULL"
          },
          {
            "name": "chk_pms_checklists_status",
            "clause": "((status)::text = ANY ((ARRAY['active'::character varying, 'archived'::character varying, 'draft'::character varying])::text[]))"
          },
          {
            "name": "chk_pms_checklists_type",
            "clause": "((checklist_type)::text = ANY ((ARRAY['maintenance'::character varying, 'safety'::character varying, 'inspection'::character varying, 'departure'::character varying, 'arrival'::character varying, 'watch'::character varying, 'custom'::character varying])::text[]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_checklists_equipment_id",
          "definition": "CREATE INDEX idx_pms_checklists_equipment_id ON public.pms_checklists USING btree (equipment_id) WHERE (equipment_id IS NOT NULL)"
        },
        {
          "name": "idx_pms_checklists_status",
          "definition": "CREATE INDEX idx_pms_checklists_status ON public.pms_checklists USING btree (status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_pms_checklists_type",
          "definition": "CREATE INDEX idx_pms_checklists_type ON public.pms_checklists USING btree (checklist_type)"
        },
        {
          "name": "idx_pms_checklists_work_order_id",
          "definition": "CREATE INDEX idx_pms_checklists_work_order_id ON public.pms_checklists USING btree (work_order_id) WHERE (work_order_id IS NOT NULL)"
        },
        {
          "name": "idx_pms_checklists_yacht_id",
          "definition": "CREATE INDEX idx_pms_checklists_yacht_id ON public.pms_checklists USING btree (yacht_id)"
        },
        {
          "name": "pms_checklists_pkey",
          "definition": "CREATE UNIQUE INDEX pms_checklists_pkey ON public.pms_checklists USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "service_role_bypass",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "users_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "users_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_view",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "yacht_isolation_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))"
          },
          {
            "name": "yacht_isolation_select",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_pms_checklists_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_pms_checklists_updated_at()"
        }
      ],
      "row_count": 5
    },
    "pms_crew_certificates": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "person_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "person_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificate_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificate_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "issuing_authority",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "issue_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expiry_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "properties",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "crew_certificates_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "crew_certificates_person_node_id_fkey",
            "column": "person_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "crew_certificates_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_24797_12_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_24797_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_24797_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_24797_4_not_null",
            "clause": "person_name IS NOT NULL"
          },
          {
            "name": "2200_24797_5_not_null",
            "clause": "certificate_type IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "crew_certificates_pkey",
          "definition": "CREATE UNIQUE INDEX crew_certificates_pkey ON public.pms_crew_certificates USING btree (id)"
        },
        {
          "name": "idx_crew_certs_expiry",
          "definition": "CREATE INDEX idx_crew_certs_expiry ON public.pms_crew_certificates USING btree (yacht_id, expiry_date)"
        },
        {
          "name": "idx_crew_certs_expiry_range",
          "definition": "CREATE INDEX idx_crew_certs_expiry_range ON public.pms_crew_certificates USING btree (yacht_id, expiry_date) WHERE (expiry_date IS NOT NULL)"
        },
        {
          "name": "idx_crew_certs_person",
          "definition": "CREATE INDEX idx_crew_certs_person ON public.pms_crew_certificates USING btree (person_node_id)"
        },
        {
          "name": "idx_crew_certs_type",
          "definition": "CREATE INDEX idx_crew_certs_type ON public.pms_crew_certificates USING btree (yacht_id, certificate_type)"
        },
        {
          "name": "idx_crew_certs_yacht",
          "definition": "CREATE INDEX idx_crew_certs_yacht ON public.pms_crew_certificates USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access crew_certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view yacht crew certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_entity_images": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "image_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "image_role",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sequence",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "1",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "added_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "added_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_entity_images_image_id_fkey",
            "column": "image_id",
            "references_table": "pms_image_uploads",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_entity_images_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_129734_10_not_null",
            "clause": "added_by IS NOT NULL"
          },
          {
            "name": "2200_129734_11_not_null",
            "clause": "added_at IS NOT NULL"
          },
          {
            "name": "2200_129734_12_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129734_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129734_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129734_3_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_129734_4_not_null",
            "clause": "entity_id IS NOT NULL"
          },
          {
            "name": "2200_129734_5_not_null",
            "clause": "image_id IS NOT NULL"
          },
          {
            "name": "2200_129734_6_not_null",
            "clause": "image_role IS NOT NULL"
          },
          {
            "name": "chk_entity_type",
            "clause": "(entity_type = ANY (ARRAY['session'::text, 'order'::text, 'part'::text, 'shopping_list_item'::text, 'receiving_line_item'::text, 'work_order'::text, 'receiving_event'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_entity_images_entity",
          "definition": "CREATE INDEX idx_entity_images_entity ON public.pms_entity_images USING btree (entity_type, entity_id)"
        },
        {
          "name": "idx_entity_images_image",
          "definition": "CREATE INDEX idx_entity_images_image ON public.pms_entity_images USING btree (image_id)"
        },
        {
          "name": "idx_entity_images_unique",
          "definition": "CREATE UNIQUE INDEX idx_entity_images_unique ON public.pms_entity_images USING btree (entity_type, entity_id, image_id, image_role)"
        },
        {
          "name": "idx_entity_images_yacht",
          "definition": "CREATE INDEX idx_entity_images_yacht ON public.pms_entity_images USING btree (yacht_id)"
        },
        {
          "name": "pms_entity_images_pkey",
          "definition": "CREATE UNIQUE INDEX pms_entity_images_pkey ON public.pms_entity_images USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to entity images",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can add entity images",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (added_by = auth.uid()))"
          },
          {
            "name": "Users can view their yacht's entity images",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_equipment": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "parent_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "code",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "location",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "manufacturer",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "model",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "serial_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "criticality",
          "type": "USER-DEFINED",
          "udt_name": "equipment_criticality",
          "nullable": true,
          "default": "'medium'::equipment_criticality",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attention_flag",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attention_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attention_updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'operational'::text",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "equipment_parent_id_fkey",
            "column": "parent_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "equipment_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18077_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18077_16_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18077_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18077_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18077_4_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "pms_equipment_status_check",
            "clause": "(status = ANY (ARRAY['operational'::text, 'degraded'::text, 'failed'::text, 'maintenance'::text, 'decommissioned'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "equipment_pkey",
          "definition": "CREATE UNIQUE INDEX equipment_pkey ON public.pms_equipment USING btree (id)"
        },
        {
          "name": "idx_equipment_attention_flag",
          "definition": "CREATE INDEX idx_equipment_attention_flag ON public.pms_equipment USING btree (attention_flag) WHERE (attention_flag = true)"
        },
        {
          "name": "idx_equipment_code",
          "definition": "CREATE INDEX idx_equipment_code ON public.pms_equipment USING btree (code)"
        },
        {
          "name": "idx_equipment_criticality",
          "definition": "CREATE INDEX idx_equipment_criticality ON public.pms_equipment USING btree (criticality)"
        },
        {
          "name": "idx_equipment_location",
          "definition": "CREATE INDEX idx_equipment_location ON public.pms_equipment USING btree (yacht_id, location) WHERE (location IS NOT NULL)"
        },
        {
          "name": "idx_equipment_manufacturer",
          "definition": "CREATE INDEX idx_equipment_manufacturer ON public.pms_equipment USING btree (yacht_id, manufacturer) WHERE (manufacturer IS NOT NULL)"
        },
        {
          "name": "idx_equipment_parent_id",
          "definition": "CREATE INDEX idx_equipment_parent_id ON public.pms_equipment USING btree (parent_id)"
        },
        {
          "name": "idx_equipment_system",
          "definition": "CREATE INDEX idx_equipment_system ON public.pms_equipment USING btree (yacht_id, system_type) WHERE (system_type IS NOT NULL)"
        },
        {
          "name": "idx_equipment_system_type",
          "definition": "CREATE INDEX idx_equipment_system_type ON public.pms_equipment USING btree (system_type)"
        },
        {
          "name": "idx_equipment_yacht_id",
          "definition": "CREATE INDEX idx_equipment_yacht_id ON public.pms_equipment USING btree (yacht_id)"
        },
        {
          "name": "idx_pms_equipment_status",
          "definition": "CREATE INDEX idx_pms_equipment_status ON public.pms_equipment USING btree (yacht_id, status)"
        },
        {
          "name": "idx_pms_equipment_yacht",
          "definition": "CREATE INDEX idx_pms_equipment_yacht ON public.pms_equipment USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can manage equipment",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access equipment",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view yacht equipment",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "no_hard_delete_equipment",
          "event": "DELETE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION prevent_hard_delete()"
        }
      ],
      "row_count": 560
    },
    "pms_equipment_parts_bom": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_required",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "1",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "equipment_parts_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "equipment_parts_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "equipment_parts_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18264_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18264_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18264_3_not_null",
            "clause": "equipment_id IS NOT NULL"
          },
          {
            "name": "2200_18264_4_not_null",
            "clause": "part_id IS NOT NULL"
          },
          {
            "name": "2200_18264_7_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "equipment_parts_pkey",
          "definition": "CREATE UNIQUE INDEX equipment_parts_pkey ON public.pms_equipment_parts_bom USING btree (id)"
        },
        {
          "name": "idx_equipment_parts_equipment_id",
          "definition": "CREATE INDEX idx_equipment_parts_equipment_id ON public.pms_equipment_parts_bom USING btree (equipment_id)"
        },
        {
          "name": "idx_equipment_parts_part_id",
          "definition": "CREATE INDEX idx_equipment_parts_part_id ON public.pms_equipment_parts_bom USING btree (part_id)"
        },
        {
          "name": "idx_equipment_parts_unique",
          "definition": "CREATE UNIQUE INDEX idx_equipment_parts_unique ON public.pms_equipment_parts_bom USING btree (equipment_id, part_id)"
        },
        {
          "name": "idx_equipment_parts_yacht_id",
          "definition": "CREATE INDEX idx_equipment_parts_yacht_id ON public.pms_equipment_parts_bom USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can manage equipment parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access equipment_parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view equipment parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 15
    },
    "pms_faults": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fault_code",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "severity",
          "type": "USER-DEFINED",
          "udt_name": "fault_severity",
          "nullable": false,
          "default": "'medium'::fault_severity",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "detected_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'open'::text",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "faults_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "faults_work_order_id_fkey",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "faults_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18180_13_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18180_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18180_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18180_3_not_null",
            "clause": "equipment_id IS NOT NULL"
          },
          {
            "name": "2200_18180_5_not_null",
            "clause": "title IS NOT NULL"
          },
          {
            "name": "2200_18180_7_not_null",
            "clause": "severity IS NOT NULL"
          },
          {
            "name": "2200_18180_8_not_null",
            "clause": "detected_at IS NOT NULL"
          },
          {
            "name": "pms_faults_status_check",
            "clause": "(status = ANY (ARRAY['open'::text, 'investigating'::text, 'resolved'::text, 'closed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "faults_pkey",
          "definition": "CREATE UNIQUE INDEX faults_pkey ON public.pms_faults USING btree (id)"
        },
        {
          "name": "idx_faults_code",
          "definition": "CREATE INDEX idx_faults_code ON public.pms_faults USING btree (yacht_id, fault_code) WHERE (fault_code IS NOT NULL)"
        },
        {
          "name": "idx_faults_date",
          "definition": "CREATE INDEX idx_faults_date ON public.pms_faults USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "idx_faults_detected",
          "definition": "CREATE INDEX idx_faults_detected ON public.pms_faults USING btree (yacht_id, detected_at DESC)"
        },
        {
          "name": "idx_faults_detected_at",
          "definition": "CREATE INDEX idx_faults_detected_at ON public.pms_faults USING btree (detected_at)"
        },
        {
          "name": "idx_faults_equipment",
          "definition": "CREATE INDEX idx_faults_equipment ON public.pms_faults USING btree (equipment_id)"
        },
        {
          "name": "idx_faults_equipment_id",
          "definition": "CREATE INDEX idx_faults_equipment_id ON public.pms_faults USING btree (equipment_id)"
        },
        {
          "name": "idx_faults_fault_code",
          "definition": "CREATE INDEX idx_faults_fault_code ON public.pms_faults USING btree (fault_code)"
        },
        {
          "name": "idx_faults_severity",
          "definition": "CREATE INDEX idx_faults_severity ON public.pms_faults USING btree (severity)"
        },
        {
          "name": "idx_faults_work_order_id",
          "definition": "CREATE INDEX idx_faults_work_order_id ON public.pms_faults USING btree (work_order_id)"
        },
        {
          "name": "idx_faults_yacht_id",
          "definition": "CREATE INDEX idx_faults_yacht_id ON public.pms_faults USING btree (yacht_id)"
        },
        {
          "name": "idx_pms_faults_equipment",
          "definition": "CREATE INDEX idx_pms_faults_equipment ON public.pms_faults USING btree (equipment_id)"
        },
        {
          "name": "idx_pms_faults_status",
          "definition": "CREATE INDEX idx_pms_faults_status ON public.pms_faults USING btree (yacht_id, status)"
        },
        {
          "name": "idx_pms_faults_yacht",
          "definition": "CREATE INDEX idx_pms_faults_yacht ON public.pms_faults USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can manage faults",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'deck'::text, 'interior'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access faults",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view faults",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "no_hard_delete_faults",
          "event": "DELETE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION prevent_hard_delete()"
        },
        {
          "name": "set_updated_at_faults",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at()"
        },
        {
          "name": "trg_fault_insert_predictive",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION on_fault_insert_notify_predictive()"
        },
        {
          "name": "trg_fault_update_predictive",
          "event": "UPDATE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION on_fault_update_notify_predictive()"
        }
      ],
      "row_count": 1623
    },
    "pms_finance_transactions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "transaction_number",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "transaction_date",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "transaction_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "amount",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "currency",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'USD'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_line_item_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "shopping_list_item_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_trigger",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "posted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "invoice_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "invoice_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "invoice_document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_finance_transactions_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_finance_transactions_invoice_document_id_fkey",
            "column": "invoice_document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_finance_transactions_order_id_fkey",
            "column": "order_id",
            "references_table": "pms_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_finance_transactions_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_finance_transactions_receiving_event_id_fkey",
            "column": "receiving_event_id",
            "references_table": "pms_receiving_events",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_finance_transactions_receiving_line_item_id_fkey",
            "column": "receiving_line_item_id",
            "references_table": "pms_receiving_line_items",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_finance_transactions_shopping_list_item_id_fkey",
            "column": "shopping_list_item_id",
            "references_table": "pms_shopping_list_items",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_finance_transactions_work_order_id_fkey",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_finance_transactions_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "pms_finance_transactions_yacht_transaction_number_unique",
            "columns": [
              "yacht_id",
              "transaction_number"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_129200_15_not_null",
            "clause": "description IS NOT NULL"
          },
          {
            "name": "2200_129200_16_not_null",
            "clause": "source_trigger IS NOT NULL"
          },
          {
            "name": "2200_129200_17_not_null",
            "clause": "posted_by IS NOT NULL"
          },
          {
            "name": "2200_129200_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129200_24_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129200_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129200_3_not_null",
            "clause": "transaction_number IS NOT NULL"
          },
          {
            "name": "2200_129200_4_not_null",
            "clause": "transaction_date IS NOT NULL"
          },
          {
            "name": "2200_129200_5_not_null",
            "clause": "transaction_type IS NOT NULL"
          },
          {
            "name": "2200_129200_6_not_null",
            "clause": "amount IS NOT NULL"
          },
          {
            "name": "2200_129200_7_not_null",
            "clause": "currency IS NOT NULL"
          },
          {
            "name": "pms_finance_transactions_transaction_type_check",
            "clause": "(transaction_type = ANY (ARRAY['parts_received'::text, 'parts_installed'::text, 'order_adjustment'::text, 'return_credit'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_finance_date",
          "definition": "CREATE INDEX idx_finance_date ON public.pms_finance_transactions USING btree (transaction_date DESC)"
        },
        {
          "name": "idx_finance_order",
          "definition": "CREATE INDEX idx_finance_order ON public.pms_finance_transactions USING btree (order_id) WHERE (order_id IS NOT NULL)"
        },
        {
          "name": "idx_finance_part",
          "definition": "CREATE INDEX idx_finance_part ON public.pms_finance_transactions USING btree (part_id) WHERE (part_id IS NOT NULL)"
        },
        {
          "name": "idx_finance_receiving",
          "definition": "CREATE INDEX idx_finance_receiving ON public.pms_finance_transactions USING btree (receiving_event_id) WHERE (receiving_event_id IS NOT NULL)"
        },
        {
          "name": "idx_finance_type",
          "definition": "CREATE INDEX idx_finance_type ON public.pms_finance_transactions USING btree (transaction_type)"
        },
        {
          "name": "idx_finance_wo",
          "definition": "CREATE INDEX idx_finance_wo ON public.pms_finance_transactions USING btree (work_order_id) WHERE (work_order_id IS NOT NULL)"
        },
        {
          "name": "idx_finance_yacht",
          "definition": "CREATE INDEX idx_finance_yacht ON public.pms_finance_transactions USING btree (yacht_id)"
        },
        {
          "name": "idx_finance_yacht_date",
          "definition": "CREATE INDEX idx_finance_yacht_date ON public.pms_finance_transactions USING btree (yacht_id, transaction_date DESC) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_finance_yacht_type",
          "definition": "CREATE INDEX idx_finance_yacht_type ON public.pms_finance_transactions USING btree (yacht_id, transaction_type) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "pms_finance_transactions_pkey",
          "definition": "CREATE UNIQUE INDEX pms_finance_transactions_pkey ON public.pms_finance_transactions USING btree (id)"
        },
        {
          "name": "pms_finance_transactions_yacht_transaction_number_unique",
          "definition": "CREATE UNIQUE INDEX pms_finance_transactions_yacht_transaction_number_unique ON public.pms_finance_transactions USING btree (yacht_id, transaction_number)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Only service role can insert finance transactions",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "true"
          },
          {
            "name": "Users can view finance transactions for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_prevent_finance_updates",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION prevent_finance_transaction_updates()"
        }
      ],
      "row_count": 3
    },
    "pms_handover": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "summary_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "category",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "added_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "added_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_handover_added_by_fkey",
            "column": "added_by",
            "references_table": "auth_users_profiles",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_126727_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_126727_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_126727_3_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_126727_5_not_null",
            "clause": "summary_text IS NOT NULL"
          },
          {
            "name": "2200_126727_8_not_null",
            "clause": "added_by IS NOT NULL"
          },
          {
            "name": "2200_126727_9_not_null",
            "clause": "added_at IS NOT NULL"
          },
          {
            "name": "pms_handover_category_check",
            "clause": "(category = ANY (ARRAY['urgent'::text, 'in_progress'::text, 'completed'::text, 'watch'::text, 'fyi'::text]))"
          },
          {
            "name": "pms_handover_entity_type_check",
            "clause": "(entity_type = ANY (ARRAY['work_order'::text, 'fault'::text, 'equipment'::text, 'note'::text, 'document_chunk'::text, 'part'::text]))"
          },
          {
            "name": "pms_handover_priority_check",
            "clause": "((priority >= 0) AND (priority <= 5))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_handover_entity",
          "definition": "CREATE INDEX idx_pms_handover_entity ON public.pms_handover USING btree (entity_type, entity_id) WHERE (entity_id IS NOT NULL)"
        },
        {
          "name": "idx_pms_handover_urgent",
          "definition": "CREATE INDEX idx_pms_handover_urgent ON public.pms_handover USING btree (yacht_id, priority DESC, added_at DESC) WHERE (category = 'urgent'::text)"
        },
        {
          "name": "idx_pms_handover_yacht",
          "definition": "CREATE INDEX idx_pms_handover_yacht ON public.pms_handover USING btree (yacht_id, added_at DESC)"
        },
        {
          "name": "pms_handover_pkey",
          "definition": "CREATE UNIQUE INDEX pms_handover_pkey ON public.pms_handover USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access handover",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create handover",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Users can delete handover",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Users can update handover",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Users can view handover",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 97
    },
    "pms_hours_of_rest": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "record_date",
          "type": "date",
          "udt_name": "date",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "rest_periods",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_rest_hours",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_work_hours",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_daily_compliant",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "daily_compliance_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "weekly_rest_hours",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_weekly_compliant",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "weekly_compliance_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_compliant",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'draft'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "submitted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "location",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "voyage_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "has_exception",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "exception_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "exception_approved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "exception_approved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "signature",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "uq_pms_hor_user_date",
            "columns": [
              "yacht_id",
              "user_id",
              "record_date"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_133312_10_not_null",
            "clause": "weekly_rest_hours IS NOT NULL"
          },
          {
            "name": "2200_133312_11_not_null",
            "clause": "is_weekly_compliant IS NOT NULL"
          },
          {
            "name": "2200_133312_13_not_null",
            "clause": "is_compliant IS NOT NULL"
          },
          {
            "name": "2200_133312_14_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_133312_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_133312_20_not_null",
            "clause": "has_exception IS NOT NULL"
          },
          {
            "name": "2200_133312_26_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_133312_28_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_133312_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_133312_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_133312_4_not_null",
            "clause": "record_date IS NOT NULL"
          },
          {
            "name": "2200_133312_5_not_null",
            "clause": "rest_periods IS NOT NULL"
          },
          {
            "name": "2200_133312_6_not_null",
            "clause": "total_rest_hours IS NOT NULL"
          },
          {
            "name": "2200_133312_7_not_null",
            "clause": "total_work_hours IS NOT NULL"
          },
          {
            "name": "2200_133312_8_not_null",
            "clause": "is_daily_compliant IS NOT NULL"
          },
          {
            "name": "pms_hours_of_rest_status_check",
            "clause": "(status = ANY (ARRAY['draft'::text, 'submitted'::text, 'approved'::text, 'flagged'::text]))"
          },
          {
            "name": "pms_hours_of_rest_voyage_type_check",
            "clause": "(voyage_type = ANY (ARRAY['at_sea'::text, 'in_port'::text, 'shipyard'::text, NULL::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_hor_user_date",
          "definition": "CREATE INDEX idx_pms_hor_user_date ON public.pms_hours_of_rest USING btree (yacht_id, user_id, record_date DESC)"
        },
        {
          "name": "idx_pms_hor_yacht_date",
          "definition": "CREATE INDEX idx_pms_hor_yacht_date ON public.pms_hours_of_rest USING btree (yacht_id, record_date DESC)"
        },
        {
          "name": "pms_hours_of_rest_pkey",
          "definition": "CREATE UNIQUE INDEX pms_hours_of_rest_pkey ON public.pms_hours_of_rest USING btree (id)"
        },
        {
          "name": "uq_pms_hor_user_date",
          "definition": "CREATE UNIQUE INDEX uq_pms_hor_user_date ON public.pms_hours_of_rest USING btree (yacht_id, user_id, record_date)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [
        {
          "name": "trg_pms_hor_daily",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION fn_calculate_hor_daily_compliance()"
        },
        {
          "name": "trg_pms_hor_daily",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION fn_calculate_hor_daily_compliance()"
        },
        {
          "name": "trg_pms_hor_weekly",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION fn_calculate_hor_weekly_compliance()"
        },
        {
          "name": "trg_pms_hor_weekly",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION fn_calculate_hor_weekly_compliance()"
        }
      ],
      "row_count": 7
    },
    "pms_image_uploads": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_bucket",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "storage_path",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "file_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "mime_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "file_size_bytes",
          "type": "bigint",
          "udt_name": "int8",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sha256_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_valid",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "validation_stage",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'uploaded'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "validation_errors",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "classification_confidence",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "classification_metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ocr_raw_text",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ocr_completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extraction_status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_data",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "upload_ip_address",
          "type": "inet",
          "udt_name": "inet",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_duplicate",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "duplicate_of_image_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "uploaded_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "uploaded_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "processed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "processed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ocr_confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ocr_engine",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ocr_processing_time_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ocr_line_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ocr_word_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_image_uploads_duplicate_of_image_id_fkey",
            "column": "duplicate_of_image_id",
            "references_table": "pms_image_uploads",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "pms_image_uploads_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_129631_10_not_null",
            "clause": "validation_stage IS NOT NULL"
          },
          {
            "name": "2200_129631_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129631_21_not_null",
            "clause": "is_duplicate IS NOT NULL"
          },
          {
            "name": "2200_129631_23_not_null",
            "clause": "uploaded_by IS NOT NULL"
          },
          {
            "name": "2200_129631_24_not_null",
            "clause": "uploaded_at IS NOT NULL"
          },
          {
            "name": "2200_129631_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129631_31_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129631_32_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_129631_3_not_null",
            "clause": "storage_bucket IS NOT NULL"
          },
          {
            "name": "2200_129631_4_not_null",
            "clause": "storage_path IS NOT NULL"
          },
          {
            "name": "2200_129631_5_not_null",
            "clause": "file_name IS NOT NULL"
          },
          {
            "name": "2200_129631_6_not_null",
            "clause": "mime_type IS NOT NULL"
          },
          {
            "name": "2200_129631_7_not_null",
            "clause": "file_size_bytes IS NOT NULL"
          },
          {
            "name": "2200_129631_8_not_null",
            "clause": "sha256_hash IS NOT NULL"
          },
          {
            "name": "2200_129631_9_not_null",
            "clause": "is_valid IS NOT NULL"
          },
          {
            "name": "pms_image_uploads_document_type_check",
            "clause": "(document_type = ANY (ARRAY['packing_slip'::text, 'shipping_label'::text, 'invoice'::text, 'part_photo'::text, 'discrepancy_photo'::text, 'unknown'::text]))"
          },
          {
            "name": "pms_image_uploads_extraction_status_check",
            "clause": "(extraction_status = ANY (ARRAY['pending'::text, 'processing'::text, 'completed'::text, 'failed'::text]))"
          },
          {
            "name": "pms_image_uploads_validation_stage_check",
            "clause": "(validation_stage = ANY (ARRAY['uploaded'::text, 'validated'::text, 'classified'::text, 'extracted'::text, 'processed'::text, 'failed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_image_uploads_document_type",
          "definition": "CREATE INDEX idx_image_uploads_document_type ON public.pms_image_uploads USING btree (document_type) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_image_uploads_hash",
          "definition": "CREATE INDEX idx_image_uploads_hash ON public.pms_image_uploads USING btree (sha256_hash) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_image_uploads_hash_yacht",
          "definition": "CREATE UNIQUE INDEX idx_image_uploads_hash_yacht ON public.pms_image_uploads USING btree (sha256_hash, yacht_id) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_image_uploads_storage_path",
          "definition": "CREATE UNIQUE INDEX idx_image_uploads_storage_path ON public.pms_image_uploads USING btree (storage_bucket, storage_path) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_image_uploads_uploaded_at",
          "definition": "CREATE INDEX idx_image_uploads_uploaded_at ON public.pms_image_uploads USING btree (yacht_id, uploaded_at DESC)"
        },
        {
          "name": "idx_image_uploads_uploaded_by",
          "definition": "CREATE INDEX idx_image_uploads_uploaded_by ON public.pms_image_uploads USING btree (uploaded_by, uploaded_at DESC)"
        },
        {
          "name": "idx_image_uploads_validation_stage",
          "definition": "CREATE INDEX idx_image_uploads_validation_stage ON public.pms_image_uploads USING btree (validation_stage) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_image_uploads_yacht",
          "definition": "CREATE INDEX idx_image_uploads_yacht ON public.pms_image_uploads USING btree (yacht_id) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_pms_image_uploads_ocr_engine",
          "definition": "CREATE INDEX idx_pms_image_uploads_ocr_engine ON public.pms_image_uploads USING btree (ocr_engine) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_pms_image_uploads_ocr_text_search",
          "definition": "CREATE INDEX idx_pms_image_uploads_ocr_text_search ON public.pms_image_uploads USING gin (to_tsvector('english'::regconfig, ocr_raw_text)) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "pms_image_uploads_pkey",
          "definition": "CREATE UNIQUE INDEX pms_image_uploads_pkey ON public.pms_image_uploads USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to images",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can upload images for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (uploaded_by = auth.uid()))"
          },
          {
            "name": "Users can view their yacht's images",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_enforce_deduplication",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION enforce_image_deduplication()"
        },
        {
          "name": "trg_enforce_rate_limit",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION check_image_upload_rate_limit()"
        },
        {
          "name": "trg_image_uploads_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 1
    },
    "pms_inventory_stock": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "location",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "min_quantity",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "max_quantity",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "reorder_quantity",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_counted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "inventory_stock_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "inventory_stock_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18293_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18293_12_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18293_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18293_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18293_3_not_null",
            "clause": "part_id IS NOT NULL"
          },
          {
            "name": "2200_18293_5_not_null",
            "clause": "quantity IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_inventory_location",
          "definition": "CREATE INDEX idx_inventory_location ON public.pms_inventory_stock USING btree (yacht_id, location) WHERE (location IS NOT NULL)"
        },
        {
          "name": "idx_inventory_part",
          "definition": "CREATE INDEX idx_inventory_part ON public.pms_inventory_stock USING btree (part_id)"
        },
        {
          "name": "idx_inventory_stock_location",
          "definition": "CREATE INDEX idx_inventory_stock_location ON public.pms_inventory_stock USING btree (location)"
        },
        {
          "name": "idx_inventory_stock_part_id",
          "definition": "CREATE INDEX idx_inventory_stock_part_id ON public.pms_inventory_stock USING btree (part_id)"
        },
        {
          "name": "idx_inventory_stock_yacht_id",
          "definition": "CREATE INDEX idx_inventory_stock_yacht_id ON public.pms_inventory_stock USING btree (yacht_id)"
        },
        {
          "name": "inventory_stock_pkey",
          "definition": "CREATE UNIQUE INDEX inventory_stock_pkey ON public.pms_inventory_stock USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can manage stock",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'deck'::text, 'interior'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access inventory_stock",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view stock levels",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 282
    },
    "pms_inventory_transactions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "stock_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "transaction_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_change",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_before",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_after",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_125343_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_125343_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_125343_3_not_null",
            "clause": "stock_id IS NOT NULL"
          },
          {
            "name": "2200_125343_4_not_null",
            "clause": "transaction_type IS NOT NULL"
          },
          {
            "name": "2200_125343_5_not_null",
            "clause": "quantity_change IS NOT NULL"
          },
          {
            "name": "2200_125343_6_not_null",
            "clause": "quantity_before IS NOT NULL"
          },
          {
            "name": "2200_125343_7_not_null",
            "clause": "quantity_after IS NOT NULL"
          },
          {
            "name": "2200_125343_8_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_125343_9_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "pms_inventory_transactions_pkey",
          "definition": "CREATE UNIQUE INDEX pms_inventory_transactions_pkey ON public.pms_inventory_transactions USING btree (id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_label_generations": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "label_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "lines_included",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_labels_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "pdf_storage_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "pdf_file_size_bytes",
          "type": "bigint",
          "udt_name": "int8",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generation_completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "generation_errors",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "emailed_to",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "emailed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "downloaded_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_downloaded_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requested_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requested_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "(now() + '90 days'::interval)",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_label_generations_receiving_event_id_fkey",
            "column": "receiving_event_id",
            "references_table": "pms_receiving_events",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_label_generations_receiving_session_id_fkey",
            "column": "receiving_session_id",
            "references_table": "pms_receiving_sessions",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_label_generations_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_129830_17_not_null",
            "clause": "requested_by IS NOT NULL"
          },
          {
            "name": "2200_129830_18_not_null",
            "clause": "requested_at IS NOT NULL"
          },
          {
            "name": "2200_129830_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129830_21_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129830_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129830_5_not_null",
            "clause": "label_type IS NOT NULL"
          },
          {
            "name": "2200_129830_6_not_null",
            "clause": "lines_included IS NOT NULL"
          },
          {
            "name": "2200_129830_7_not_null",
            "clause": "total_labels_count IS NOT NULL"
          },
          {
            "name": "2200_129830_8_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "pms_label_generations_status_check",
            "clause": "(status = ANY (ARRAY['pending'::text, 'generating'::text, 'completed'::text, 'failed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_label_generations_expires",
          "definition": "CREATE INDEX idx_label_generations_expires ON public.pms_label_generations USING btree (expires_at) WHERE (status = 'completed'::text)"
        },
        {
          "name": "idx_label_generations_receiving_event",
          "definition": "CREATE INDEX idx_label_generations_receiving_event ON public.pms_label_generations USING btree (receiving_event_id)"
        },
        {
          "name": "idx_label_generations_requested_by",
          "definition": "CREATE INDEX idx_label_generations_requested_by ON public.pms_label_generations USING btree (requested_by, requested_at DESC)"
        },
        {
          "name": "idx_label_generations_status",
          "definition": "CREATE INDEX idx_label_generations_status ON public.pms_label_generations USING btree (status) WHERE (status = ANY (ARRAY['pending'::text, 'generating'::text]))"
        },
        {
          "name": "pms_label_generations_pkey",
          "definition": "CREATE UNIQUE INDEX pms_label_generations_pkey ON public.pms_label_generations USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role can update label generations",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "UPDATE",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can request labels",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (requested_by = auth.uid()))"
          },
          {
            "name": "Users can view their label generations",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_maintenance_schedules": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "task_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "frequency",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "frequency_days",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "frequency_hours",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_completed_hours",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "next_due_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "next_due_hours",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "assigned_to",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'medium'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'active'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deferral_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deferred_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deferred_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_maintenance_schedules_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_maintenance_schedules_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_144091_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_144091_20_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_144091_21_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_144091_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_144091_4_not_null",
            "clause": "task_name IS NOT NULL"
          },
          {
            "name": "2200_144091_6_not_null",
            "clause": "frequency IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_maintenance_schedules_equipment",
          "definition": "CREATE INDEX idx_maintenance_schedules_equipment ON public.pms_maintenance_schedules USING btree (equipment_id) WHERE (equipment_id IS NOT NULL)"
        },
        {
          "name": "idx_maintenance_schedules_next_due",
          "definition": "CREATE INDEX idx_maintenance_schedules_next_due ON public.pms_maintenance_schedules USING btree (next_due_at) WHERE (next_due_at IS NOT NULL)"
        },
        {
          "name": "idx_maintenance_schedules_status",
          "definition": "CREATE INDEX idx_maintenance_schedules_status ON public.pms_maintenance_schedules USING btree (status)"
        },
        {
          "name": "idx_maintenance_schedules_yacht",
          "definition": "CREATE INDEX idx_maintenance_schedules_yacht ON public.pms_maintenance_schedules USING btree (yacht_id)"
        },
        {
          "name": "pms_maintenance_schedules_pkey",
          "definition": "CREATE UNIQUE INDEX pms_maintenance_schedules_pkey ON public.pms_maintenance_schedules USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can create schedules",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text, 'captain'::text])))"
          },
          {
            "name": "Engineers can update schedules",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text, 'captain'::text])))",
            "with_check": null
          },
          {
            "name": "Managers can delete schedules",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access schedules",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can view schedules",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_notes": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fault_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "note_type",
          "type": "USER-DEFINED",
          "udt_name": "note_type",
          "nullable": false,
          "default": "'general'::note_type",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attachments",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "notes_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "notes_fault_id_fkey",
            "column": "fault_id",
            "references_table": "pms_faults",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "notes_work_order_id_fkey",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "notes_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_28209_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_28209_12_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_28209_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_28209_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_28209_6_not_null",
            "clause": "text IS NOT NULL"
          },
          {
            "name": "2200_28209_7_not_null",
            "clause": "note_type IS NOT NULL"
          },
          {
            "name": "2200_28209_8_not_null",
            "clause": "created_by IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_notes_created",
          "definition": "CREATE INDEX idx_notes_created ON public.pms_notes USING btree (created_at DESC)"
        },
        {
          "name": "idx_notes_equipment",
          "definition": "CREATE INDEX idx_notes_equipment ON public.pms_notes USING btree (equipment_id)"
        },
        {
          "name": "idx_notes_yacht",
          "definition": "CREATE INDEX idx_notes_yacht ON public.pms_notes USING btree (yacht_id)"
        },
        {
          "name": "notes_created_at_idx",
          "definition": "CREATE INDEX notes_created_at_idx ON public.pms_notes USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "notes_created_by_idx",
          "definition": "CREATE INDEX notes_created_by_idx ON public.pms_notes USING btree (created_by)"
        },
        {
          "name": "notes_equipment_id_idx",
          "definition": "CREATE INDEX notes_equipment_id_idx ON public.pms_notes USING btree (equipment_id)"
        },
        {
          "name": "notes_fault_id_idx",
          "definition": "CREATE INDEX notes_fault_id_idx ON public.pms_notes USING btree (fault_id)"
        },
        {
          "name": "notes_note_type_idx",
          "definition": "CREATE INDEX notes_note_type_idx ON public.pms_notes USING btree (yacht_id, note_type)"
        },
        {
          "name": "notes_pkey",
          "definition": "CREATE UNIQUE INDEX notes_pkey ON public.pms_notes USING btree (id)"
        },
        {
          "name": "notes_text_gin_idx",
          "definition": "CREATE INDEX notes_text_gin_idx ON public.pms_notes USING gin (text gin_trgm_ops)"
        },
        {
          "name": "notes_work_order_id_idx",
          "definition": "CREATE INDEX notes_work_order_id_idx ON public.pms_notes USING btree (work_order_id)"
        },
        {
          "name": "notes_yacht_id_idx",
          "definition": "CREATE INDEX notes_yacht_id_idx ON public.pms_notes USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access to notes",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create notes",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Users can view own yacht notes",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "notes_updated_at_trigger",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_notes_updated_at()"
        },
        {
          "name": "trg_note_insert_predictive",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION on_note_insert_notify_predictive()"
        },
        {
          "name": "trigger_notes_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at()"
        }
      ],
      "row_count": 5
    },
    "pms_orders": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "order_number",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "order_title",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "supplier_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "supplier_contact",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'draft'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "estimated_total",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "actual_total",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "currency",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'USD'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ordered_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expected_delivery_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "submitted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "submitted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "purchase_order_document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "invoice_document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "packing_slip_document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_orders_invoice_document_id_fkey",
            "column": "invoice_document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_orders_packing_slip_document_id_fkey",
            "column": "packing_slip_document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_orders_purchase_order_document_id_fkey",
            "column": "purchase_order_document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_orders_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "pms_orders_yacht_order_number_unique",
            "columns": [
              "yacht_id",
              "order_number"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_128939_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_128939_23_not_null",
            "clause": "created_by IS NOT NULL"
          },
          {
            "name": "2200_128939_24_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_128939_26_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_128939_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_128939_3_not_null",
            "clause": "order_number IS NOT NULL"
          },
          {
            "name": "2200_128939_5_not_null",
            "clause": "supplier_name IS NOT NULL"
          },
          {
            "name": "2200_128939_7_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "pms_orders_status_check",
            "clause": "(status = ANY (ARRAY['draft'::text, 'submitted'::text, 'acknowledged'::text, 'partially_shipped'::text, 'shipped'::text, 'partially_received'::text, 'completed'::text, 'cancelled'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_orders_number",
          "definition": "CREATE INDEX idx_orders_number ON public.pms_orders USING btree (order_number)"
        },
        {
          "name": "idx_orders_ordered_at",
          "definition": "CREATE INDEX idx_orders_ordered_at ON public.pms_orders USING btree (ordered_at DESC) WHERE (ordered_at IS NOT NULL)"
        },
        {
          "name": "idx_orders_status",
          "definition": "CREATE INDEX idx_orders_status ON public.pms_orders USING btree (status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_orders_supplier",
          "definition": "CREATE INDEX idx_orders_supplier ON public.pms_orders USING btree (supplier_name) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_orders_yacht",
          "definition": "CREATE INDEX idx_orders_yacht ON public.pms_orders USING btree (yacht_id)"
        },
        {
          "name": "idx_orders_yacht_ordered",
          "definition": "CREATE INDEX idx_orders_yacht_ordered ON public.pms_orders USING btree (yacht_id, ordered_at DESC) WHERE ((ordered_at IS NOT NULL) AND (deleted_at IS NULL))"
        },
        {
          "name": "idx_orders_yacht_status",
          "definition": "CREATE INDEX idx_orders_yacht_status ON public.pms_orders USING btree (yacht_id, status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "pms_orders_pkey",
          "definition": "CREATE UNIQUE INDEX pms_orders_pkey ON public.pms_orders USING btree (id)"
        },
        {
          "name": "pms_orders_yacht_order_number_unique",
          "definition": "CREATE UNIQUE INDEX pms_orders_yacht_order_number_unique ON public.pms_orders USING btree (yacht_id, order_number)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "HOD can create and update orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND is_hod(auth.uid(), yacht_id))",
            "with_check": "((yacht_id = get_user_yacht_id()) AND is_hod(auth.uid(), yacht_id))"
          },
          {
            "name": "Service role has full access to orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can view orders for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 3
    },
    "pms_part_usage": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "usage_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "used_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "used_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_part_usage_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_part_usage_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "RESTRICT"
          },
          {
            "constraint_name": "pms_part_usage_work_order_id_fkey",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_126667_10_not_null",
            "clause": "used_at IS NOT NULL"
          },
          {
            "name": "2200_126667_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_126667_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_126667_3_not_null",
            "clause": "part_id IS NOT NULL"
          },
          {
            "name": "2200_126667_4_not_null",
            "clause": "quantity IS NOT NULL"
          },
          {
            "name": "2200_126667_7_not_null",
            "clause": "usage_reason IS NOT NULL"
          },
          {
            "name": "2200_126667_9_not_null",
            "clause": "used_by IS NOT NULL"
          },
          {
            "name": "pms_part_usage_quantity_check",
            "clause": "(quantity > 0)"
          },
          {
            "name": "pms_part_usage_usage_reason_check",
            "clause": "(usage_reason = ANY (ARRAY['work_order'::text, 'preventive_maintenance'::text, 'emergency_repair'::text, 'testing'::text, 'other'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_part_usage_equipment_id",
          "definition": "CREATE INDEX idx_pms_part_usage_equipment_id ON public.pms_part_usage USING btree (equipment_id)"
        },
        {
          "name": "idx_pms_part_usage_part",
          "definition": "CREATE INDEX idx_pms_part_usage_part ON public.pms_part_usage USING btree (part_id, used_at DESC)"
        },
        {
          "name": "idx_pms_part_usage_part_id",
          "definition": "CREATE INDEX idx_pms_part_usage_part_id ON public.pms_part_usage USING btree (part_id, used_at DESC)"
        },
        {
          "name": "idx_pms_part_usage_used_at",
          "definition": "CREATE INDEX idx_pms_part_usage_used_at ON public.pms_part_usage USING btree (used_at DESC)"
        },
        {
          "name": "idx_pms_part_usage_user",
          "definition": "CREATE INDEX idx_pms_part_usage_user ON public.pms_part_usage USING btree (used_by, used_at DESC)"
        },
        {
          "name": "idx_pms_part_usage_wo",
          "definition": "CREATE INDEX idx_pms_part_usage_wo ON public.pms_part_usage USING btree (work_order_id) WHERE (work_order_id IS NOT NULL)"
        },
        {
          "name": "idx_pms_part_usage_work_order_id",
          "definition": "CREATE INDEX idx_pms_part_usage_work_order_id ON public.pms_part_usage USING btree (work_order_id)"
        },
        {
          "name": "idx_pms_part_usage_yacht",
          "definition": "CREATE INDEX idx_pms_part_usage_yacht ON public.pms_part_usage USING btree (yacht_id, used_at DESC)"
        },
        {
          "name": "idx_pms_part_usage_yacht_id",
          "definition": "CREATE INDEX idx_pms_part_usage_yacht_id ON public.pms_part_usage USING btree (yacht_id)"
        },
        {
          "name": "pms_part_usage_pkey",
          "definition": "CREATE UNIQUE INDEX pms_part_usage_pkey ON public.pms_part_usage USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Authenticated users can view usage",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role full access",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "pms_part_usage_yacht_isolation",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = (current_setting('app.current_yacht_id'::text))::uuid)",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 8
    },
    "pms_parts": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "manufacturer",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "category",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "model_compatibility",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "search_embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "embedding_text",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_on_hand",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "minimum_quantity",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "unit",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'ea'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "location",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_counted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_counted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "parts_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18244_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18244_11_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18244_14_not_null",
            "clause": "quantity_on_hand IS NOT NULL"
          },
          {
            "name": "2200_18244_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18244_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18244_3_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "pms_parts_unit_check",
            "clause": "((unit = ANY (ARRAY['ea'::text, 'kg'::text, 'g'::text, 'L'::text, 'mL'::text, 'm'::text, 'cm'::text, 'mm'::text, 'ft'::text, 'in'::text, 'm2'::text, 'm3'::text, 'gal'::text, 'qt'::text, 'pt'::text, 'oz'::text, 'lb'::text, 'box'::text, 'set'::text, 'pair'::text, 'roll'::text, 'sheet'::text])) OR (unit IS NULL))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_parts_category",
          "definition": "CREATE INDEX idx_parts_category ON public.pms_parts USING btree (category)"
        },
        {
          "name": "idx_parts_manufacturer",
          "definition": "CREATE INDEX idx_parts_manufacturer ON public.pms_parts USING btree (yacht_id, manufacturer) WHERE (manufacturer IS NOT NULL)"
        },
        {
          "name": "idx_parts_number",
          "definition": "CREATE INDEX idx_parts_number ON public.pms_parts USING btree (yacht_id, part_number) WHERE (part_number IS NOT NULL)"
        },
        {
          "name": "idx_parts_part_number",
          "definition": "CREATE INDEX idx_parts_part_number ON public.pms_parts USING btree (part_number)"
        },
        {
          "name": "idx_parts_yacht_id",
          "definition": "CREATE INDEX idx_parts_yacht_id ON public.pms_parts USING btree (yacht_id)"
        },
        {
          "name": "idx_pms_parts_embedding",
          "definition": "CREATE INDEX idx_pms_parts_embedding ON public.pms_parts USING ivfflat (search_embedding vector_cosine_ops) WITH (lists='100')"
        },
        {
          "name": "idx_pms_parts_low_stock",
          "definition": "CREATE INDEX idx_pms_parts_low_stock ON public.pms_parts USING btree (yacht_id, quantity_on_hand, minimum_quantity) WHERE (quantity_on_hand <= minimum_quantity)"
        },
        {
          "name": "idx_pms_parts_part_number",
          "definition": "CREATE INDEX idx_pms_parts_part_number ON public.pms_parts USING btree (yacht_id, part_number)"
        },
        {
          "name": "idx_pms_parts_yacht",
          "definition": "CREATE INDEX idx_pms_parts_yacht ON public.pms_parts USING btree (yacht_id)"
        },
        {
          "name": "parts_pkey",
          "definition": "CREATE UNIQUE INDEX parts_pkey ON public.pms_parts USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can manage parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_prevent_embedding_overwrite",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION prevent_embedding_overwrite()"
        }
      ],
      "row_count": 538
    },
    "pms_purchase_order_items": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "purchase_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_ordered",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_received",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "unit_price",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "purchase_order_items_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "purchase_order_items_purchase_order_id_fkey",
            "column": "purchase_order_id",
            "references_table": "pms_purchase_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "purchase_order_items_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18364_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18364_11_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18364_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18364_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18364_3_not_null",
            "clause": "purchase_order_id IS NOT NULL"
          },
          {
            "name": "2200_18364_5_not_null",
            "clause": "description IS NOT NULL"
          },
          {
            "name": "2200_18364_6_not_null",
            "clause": "quantity_ordered IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_purchase_order_items_part_id",
          "definition": "CREATE INDEX idx_purchase_order_items_part_id ON public.pms_purchase_order_items USING btree (part_id)"
        },
        {
          "name": "idx_purchase_order_items_po_id",
          "definition": "CREATE INDEX idx_purchase_order_items_po_id ON public.pms_purchase_order_items USING btree (purchase_order_id)"
        },
        {
          "name": "idx_purchase_order_items_yacht_id",
          "definition": "CREATE INDEX idx_purchase_order_items_yacht_id ON public.pms_purchase_order_items USING btree (yacht_id)"
        },
        {
          "name": "purchase_order_items_pkey",
          "definition": "CREATE UNIQUE INDEX purchase_order_items_pkey ON public.pms_purchase_order_items USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can manage PO items",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access purchase_order_items",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view PO items",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 15
    },
    "pms_purchase_orders": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "supplier_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "po_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'draft'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ordered_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "received_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "currency",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'USD'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approval_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "received_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ordered_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "purchase_orders_supplier_id_fkey",
            "column": "supplier_id",
            "references_table": "pms_suppliers",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "purchase_orders_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18338_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18338_11_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18338_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18338_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_purchase_orders_status",
          "definition": "CREATE INDEX idx_pms_purchase_orders_status ON public.pms_purchase_orders USING btree (yacht_id, status)"
        },
        {
          "name": "idx_pms_purchase_orders_yacht",
          "definition": "CREATE INDEX idx_pms_purchase_orders_yacht ON public.pms_purchase_orders USING btree (yacht_id)"
        },
        {
          "name": "idx_purchase_orders_status",
          "definition": "CREATE INDEX idx_purchase_orders_status ON public.pms_purchase_orders USING btree (status)"
        },
        {
          "name": "idx_purchase_orders_supplier_id",
          "definition": "CREATE INDEX idx_purchase_orders_supplier_id ON public.pms_purchase_orders USING btree (supplier_id)"
        },
        {
          "name": "idx_purchase_orders_yacht_id",
          "definition": "CREATE INDEX idx_purchase_orders_yacht_id ON public.pms_purchase_orders USING btree (yacht_id)"
        },
        {
          "name": "purchase_orders_pkey",
          "definition": "CREATE UNIQUE INDEX purchase_orders_pkey ON public.pms_purchase_orders USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can manage purchase orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access purchase_orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view purchase orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 9
    },
    "pms_receiving_attachments": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_line_item_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attachment_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attached_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "attached_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_receiving_attachments_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_receiving_attachments_receiving_event_id_fkey",
            "column": "receiving_event_id",
            "references_table": "pms_receiving_events",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_receiving_attachments_receiving_line_item_id_fkey",
            "column": "receiving_line_item_id",
            "references_table": "pms_receiving_line_items",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_receiving_attachments_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_129455_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129455_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129455_3_not_null",
            "clause": "receiving_event_id IS NOT NULL"
          },
          {
            "name": "2200_129455_5_not_null",
            "clause": "document_id IS NOT NULL"
          },
          {
            "name": "2200_129455_6_not_null",
            "clause": "attachment_type IS NOT NULL"
          },
          {
            "name": "2200_129455_8_not_null",
            "clause": "attached_by IS NOT NULL"
          },
          {
            "name": "2200_129455_9_not_null",
            "clause": "attached_at IS NOT NULL"
          },
          {
            "name": "pms_receiving_attachments_attachment_type_check",
            "clause": "(attachment_type = ANY (ARRAY['packing_slip'::text, 'condition_photo'::text, 'damage_photo'::text, 'invoice'::text, 'delivery_note'::text, 'other'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_receiving_attachments_document",
          "definition": "CREATE INDEX idx_receiving_attachments_document ON public.pms_receiving_attachments USING btree (document_id)"
        },
        {
          "name": "idx_receiving_attachments_event",
          "definition": "CREATE INDEX idx_receiving_attachments_event ON public.pms_receiving_attachments USING btree (receiving_event_id)"
        },
        {
          "name": "idx_receiving_attachments_line",
          "definition": "CREATE INDEX idx_receiving_attachments_line ON public.pms_receiving_attachments USING btree (receiving_line_item_id) WHERE (receiving_line_item_id IS NOT NULL)"
        },
        {
          "name": "idx_receiving_attachments_type",
          "definition": "CREATE INDEX idx_receiving_attachments_type ON public.pms_receiving_attachments USING btree (attachment_type)"
        },
        {
          "name": "pms_receiving_attachments_pkey",
          "definition": "CREATE UNIQUE INDEX pms_receiving_attachments_pkey ON public.pms_receiving_attachments USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role has full access to attachments",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create attachments",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (attached_by = auth.uid()))"
          },
          {
            "name": "Users can view attachments for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_enforce_attachment_consistency",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION enforce_receiving_attachment_consistency()"
        },
        {
          "name": "trg_enforce_attachment_consistency",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION enforce_receiving_attachment_consistency()"
        }
      ],
      "row_count": 0
    },
    "pms_receiving_draft_lines": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_image_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "line_sequence",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "raw_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_part_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_part_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_quantity",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_unit",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_manufacturer",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "match_status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'unmatched'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggested_part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggested_shopping_list_item_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "alternative_matches",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_verified",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "verified_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "verified_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_shopping_list_item_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_quantity",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_unit",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_disposition",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolution_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_discrepancy",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "discrepancy_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "discrepancy_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "creates_candidate_part",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_candidate_part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_receiving_draft_lines_created_candidate_part_id_fkey",
            "column": "created_candidate_part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "pms_receiving_draft_lines_resolved_part_id_fkey",
            "column": "resolved_part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "pms_receiving_draft_lines_resolved_shopping_list_item_id_fkey",
            "column": "resolved_shopping_list_item_id",
            "references_table": "pms_shopping_list_items",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "pms_receiving_draft_lines_session_id_fkey",
            "column": "session_id",
            "references_table": "pms_receiving_sessions",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_receiving_draft_lines_source_image_id_fkey",
            "column": "source_image_id",
            "references_table": "pms_image_uploads",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_receiving_draft_lines_suggested_part_id_fkey",
            "column": "suggested_part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "pms_receiving_draft_lines_suggested_shopping_list_item_id_fkey",
            "column": "suggested_shopping_list_item_id",
            "references_table": "pms_shopping_list_items",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "pms_receiving_draft_lines_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_129765_13_not_null",
            "clause": "match_status IS NOT NULL"
          },
          {
            "name": "2200_129765_17_not_null",
            "clause": "is_verified IS NOT NULL"
          },
          {
            "name": "2200_129765_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129765_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129765_31_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129765_32_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_129765_3_not_null",
            "clause": "session_id IS NOT NULL"
          },
          {
            "name": "2200_129765_4_not_null",
            "clause": "source_image_id IS NOT NULL"
          },
          {
            "name": "2200_129765_5_not_null",
            "clause": "line_sequence IS NOT NULL"
          },
          {
            "name": "2200_129765_6_not_null",
            "clause": "raw_text IS NOT NULL"
          },
          {
            "name": "pms_receiving_draft_lines_match_status_check",
            "clause": "(match_status = ANY (ARRAY['matched_order'::text, 'matched_part'::text, 'matched_shopping_list'::text, 'unmatched'::text, 'ignored'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_draft_lines_image",
          "definition": "CREATE INDEX idx_draft_lines_image ON public.pms_receiving_draft_lines USING btree (source_image_id)"
        },
        {
          "name": "idx_draft_lines_match_status",
          "definition": "CREATE INDEX idx_draft_lines_match_status ON public.pms_receiving_draft_lines USING btree (match_status) WHERE (is_verified = false)"
        },
        {
          "name": "idx_draft_lines_session",
          "definition": "CREATE INDEX idx_draft_lines_session ON public.pms_receiving_draft_lines USING btree (session_id, line_sequence)"
        },
        {
          "name": "idx_draft_lines_unverified",
          "definition": "CREATE INDEX idx_draft_lines_unverified ON public.pms_receiving_draft_lines USING btree (session_id) WHERE (is_verified = false)"
        },
        {
          "name": "idx_draft_lines_verified",
          "definition": "CREATE INDEX idx_draft_lines_verified ON public.pms_receiving_draft_lines USING btree (verified_by, verified_at DESC) WHERE (is_verified = true)"
        },
        {
          "name": "pms_receiving_draft_lines_pkey",
          "definition": "CREATE UNIQUE INDEX pms_receiving_draft_lines_pkey ON public.pms_receiving_draft_lines USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role can manage draft lines",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can verify draft lines",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND (is_verified = false))",
            "with_check": "((yacht_id = get_user_yacht_id()) AND (verified_by = auth.uid()))"
          },
          {
            "name": "Users can view their yacht's draft lines",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_draft_lines_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 0
    },
    "pms_receiving_events": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_number",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "received_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "received_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "location",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'in_progress'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "delivery_method",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tracking_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_locked",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "was_camera_initiated",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_receiving_events_order_id_fkey",
            "column": "order_id",
            "references_table": "pms_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_events_receiving_session_id_fkey",
            "column": "receiving_session_id",
            "references_table": "pms_receiving_sessions",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_events_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "pms_receiving_events_yacht_receiving_number_unique",
            "columns": [
              "yacht_id",
              "receiving_number"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_129005_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129005_17_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_129005_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129005_21_not_null",
            "clause": "is_locked IS NOT NULL"
          },
          {
            "name": "2200_129005_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129005_3_not_null",
            "clause": "receiving_number IS NOT NULL"
          },
          {
            "name": "2200_129005_5_not_null",
            "clause": "received_at IS NOT NULL"
          },
          {
            "name": "2200_129005_6_not_null",
            "clause": "received_by IS NOT NULL"
          },
          {
            "name": "2200_129005_8_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "pms_receiving_events_status_check",
            "clause": "(status = ANY (ARRAY['in_progress'::text, 'completed'::text, 'partial'::text, 'discrepancy'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_receiving_events_camera_initiated",
          "definition": "CREATE INDEX idx_receiving_events_camera_initiated ON public.pms_receiving_events USING btree (yacht_id) WHERE (was_camera_initiated = true)"
        },
        {
          "name": "idx_receiving_events_session",
          "definition": "CREATE INDEX idx_receiving_events_session ON public.pms_receiving_events USING btree (receiving_session_id) WHERE (receiving_session_id IS NOT NULL)"
        },
        {
          "name": "idx_receiving_order",
          "definition": "CREATE INDEX idx_receiving_order ON public.pms_receiving_events USING btree (order_id) WHERE (order_id IS NOT NULL)"
        },
        {
          "name": "idx_receiving_received_at",
          "definition": "CREATE INDEX idx_receiving_received_at ON public.pms_receiving_events USING btree (received_at DESC)"
        },
        {
          "name": "idx_receiving_status",
          "definition": "CREATE INDEX idx_receiving_status ON public.pms_receiving_events USING btree (status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_receiving_yacht",
          "definition": "CREATE INDEX idx_receiving_yacht ON public.pms_receiving_events USING btree (yacht_id)"
        },
        {
          "name": "pms_receiving_events_pkey",
          "definition": "CREATE UNIQUE INDEX pms_receiving_events_pkey ON public.pms_receiving_events USING btree (id)"
        },
        {
          "name": "pms_receiving_events_yacht_receiving_number_unique",
          "definition": "CREATE UNIQUE INDEX pms_receiving_events_yacht_receiving_number_unique ON public.pms_receiving_events USING btree (yacht_id, receiving_number)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Authorized users can create receiving events",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (received_by = auth.uid()))"
          },
          {
            "name": "Receiver can update own receiving event",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND (((received_by = auth.uid()) AND (is_locked = false)) OR is_hod(auth.uid(), yacht_id)))",
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Service role has full access to receiving events",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can view receiving events for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_auto_lock_receiving_event",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION auto_lock_receiving_event()"
        }
      ],
      "row_count": 3
    },
    "pms_receiving_line_items": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "shopping_list_item_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "manufacturer",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_expected",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_received",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_accepted",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_rejected",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "unit",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "disposition",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "disposition_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_immediately",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_to_equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_to_work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "unit_price",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "line_total",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "serial_numbers",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "batch_lot_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expiration_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "verified_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "verified_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_verified",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "received_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "draft_line_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "verification_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "human_verified_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "human_verified_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_receiving_line_items_draft_line_id_fkey",
            "column": "draft_line_id",
            "references_table": "pms_receiving_draft_lines",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_line_items_installed_to_equipment_id_fkey",
            "column": "installed_to_equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_line_items_installed_to_work_order_id_fkey",
            "column": "installed_to_work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_line_items_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_line_items_receiving_event_id_fkey",
            "column": "receiving_event_id",
            "references_table": "pms_receiving_events",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_receiving_line_items_shopping_list_item_id_fkey",
            "column": "shopping_list_item_id",
            "references_table": "pms_shopping_list_items",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_line_items_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_129138_10_not_null",
            "clause": "quantity_received IS NOT NULL"
          },
          {
            "name": "2200_129138_11_not_null",
            "clause": "quantity_accepted IS NOT NULL"
          },
          {
            "name": "2200_129138_14_not_null",
            "clause": "disposition IS NOT NULL"
          },
          {
            "name": "2200_129138_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129138_28_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129138_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129138_30_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_129138_33_not_null",
            "clause": "is_verified IS NOT NULL"
          },
          {
            "name": "2200_129138_3_not_null",
            "clause": "receiving_event_id IS NOT NULL"
          },
          {
            "name": "2200_129138_6_not_null",
            "clause": "part_name IS NOT NULL"
          },
          {
            "name": "pms_receiving_line_items_check",
            "clause": "((quantity_accepted >= (0)::numeric) AND (quantity_accepted <= quantity_received))"
          },
          {
            "name": "pms_receiving_line_items_disposition_check",
            "clause": "(disposition = ANY (ARRAY['accepted'::text, 'accepted_with_notes'::text, 'rejected'::text, 'partial_accept'::text, 'missing'::text, 'extra'::text, 'incorrect'::text]))"
          },
          {
            "name": "pms_receiving_line_items_quantity_received_check",
            "clause": "(quantity_received >= (0)::numeric)"
          },
          {
            "name": "pms_receiving_line_items_quantity_rejected_check",
            "clause": "(quantity_rejected >= (0)::numeric)"
          },
          {
            "name": "pms_receiving_line_items_unit_check",
            "clause": "((unit = ANY (ARRAY['ea'::text, 'kg'::text, 'g'::text, 'L'::text, 'mL'::text, 'm'::text, 'cm'::text, 'mm'::text, 'ft'::text, 'in'::text, 'm2'::text, 'm3'::text, 'gal'::text, 'qt'::text, 'pt'::text, 'oz'::text, 'lb'::text, 'box'::text, 'set'::text, 'pair'::text, 'roll'::text, 'sheet'::text])) OR (unit IS NULL))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_receiving_line_items_draft",
          "definition": "CREATE INDEX idx_receiving_line_items_draft ON public.pms_receiving_line_items USING btree (draft_line_id) WHERE (draft_line_id IS NOT NULL)"
        },
        {
          "name": "idx_receiving_lines_disposition",
          "definition": "CREATE INDEX idx_receiving_lines_disposition ON public.pms_receiving_line_items USING btree (disposition)"
        },
        {
          "name": "idx_receiving_lines_event",
          "definition": "CREATE INDEX idx_receiving_lines_event ON public.pms_receiving_line_items USING btree (receiving_event_id)"
        },
        {
          "name": "idx_receiving_lines_part",
          "definition": "CREATE INDEX idx_receiving_lines_part ON public.pms_receiving_line_items USING btree (part_id) WHERE (part_id IS NOT NULL)"
        },
        {
          "name": "idx_receiving_lines_shopping_item",
          "definition": "CREATE INDEX idx_receiving_lines_shopping_item ON public.pms_receiving_line_items USING btree (shopping_list_item_id) WHERE (shopping_list_item_id IS NOT NULL)"
        },
        {
          "name": "idx_receiving_lines_yacht",
          "definition": "CREATE INDEX idx_receiving_lines_yacht ON public.pms_receiving_line_items USING btree (yacht_id)"
        },
        {
          "name": "idx_receiving_lines_yacht_event",
          "definition": "CREATE INDEX idx_receiving_lines_yacht_event ON public.pms_receiving_line_items USING btree (yacht_id, receiving_event_id)"
        },
        {
          "name": "idx_receiving_lines_yacht_shopping",
          "definition": "CREATE INDEX idx_receiving_lines_yacht_shopping ON public.pms_receiving_line_items USING btree (yacht_id, shopping_list_item_id) WHERE (shopping_list_item_id IS NOT NULL)"
        },
        {
          "name": "pms_receiving_line_items_pkey",
          "definition": "CREATE UNIQUE INDEX pms_receiving_line_items_pkey ON public.pms_receiving_line_items USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Receiver or HOD can update receiving line items",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND (((received_by = auth.uid()) AND (EXISTS ( SELECT 1\n   FROM pms_receiving_events re\n  WHERE ((re.id = pms_receiving_line_items.receiving_event_id) AND (re.is_locked = false))))) OR is_hod(auth.uid(), yacht_id)))",
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Service role has full access to receiving line items",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create receiving line items",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Users can view receiving line items for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_enforce_receiving_verification",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION enforce_receiving_verification()"
        },
        {
          "name": "trg_enforce_receiving_verification",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION enforce_receiving_verification()"
        },
        {
          "name": "trg_set_receiving_line_receiver",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION set_receiving_line_receiver()"
        },
        {
          "name": "trg_update_shopping_quantities_on_receiving",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_shopping_list_quantities()"
        },
        {
          "name": "trg_update_shopping_quantities_on_receiving",
          "event": "DELETE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_shopping_list_quantities()"
        },
        {
          "name": "trg_update_shopping_quantities_on_receiving",
          "event": "UPDATE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION update_shopping_list_quantities()"
        }
      ],
      "row_count": 3
    },
    "pms_receiving_sessions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_number",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'draft'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "order_matched_automatically",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "session_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "supplier_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tracking_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expected_items_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extraction_completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "reconciliation_completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "verification_completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "committed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "cancelled_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "received_to_inventory_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_immediately_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "discrepancy_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "unresolved_lines_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "receiving_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "committed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "cancelled_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "cancellation_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_receiving_sessions_order_id_fkey",
            "column": "order_id",
            "references_table": "pms_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_sessions_receiving_event_id_fkey",
            "column": "receiving_event_id",
            "references_table": "pms_receiving_events",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_receiving_sessions_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "pms_receiving_sessions_session_number_key",
            "columns": [
              "session_number"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_129681_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129681_21_not_null",
            "clause": "created_by IS NOT NULL"
          },
          {
            "name": "2200_129681_22_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129681_27_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_129681_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129681_3_not_null",
            "clause": "session_number IS NOT NULL"
          },
          {
            "name": "2200_129681_4_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_129681_7_not_null",
            "clause": "session_type IS NOT NULL"
          },
          {
            "name": "pms_receiving_sessions_status_check",
            "clause": "(status = ANY (ARRAY['draft'::text, 'reconciling'::text, 'verifying'::text, 'committed'::text, 'cancelled'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_receiving_sessions_created_by",
          "definition": "CREATE INDEX idx_receiving_sessions_created_by ON public.pms_receiving_sessions USING btree (created_by, created_at DESC)"
        },
        {
          "name": "idx_receiving_sessions_order",
          "definition": "CREATE INDEX idx_receiving_sessions_order ON public.pms_receiving_sessions USING btree (order_id) WHERE (order_id IS NOT NULL)"
        },
        {
          "name": "idx_receiving_sessions_status",
          "definition": "CREATE INDEX idx_receiving_sessions_status ON public.pms_receiving_sessions USING btree (status) WHERE ((status <> 'committed'::text) AND (status <> 'cancelled'::text))"
        },
        {
          "name": "idx_receiving_sessions_yacht",
          "definition": "CREATE INDEX idx_receiving_sessions_yacht ON public.pms_receiving_sessions USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "pms_receiving_sessions_pkey",
          "definition": "CREATE UNIQUE INDEX pms_receiving_sessions_pkey ON public.pms_receiving_sessions USING btree (id)"
        },
        {
          "name": "pms_receiving_sessions_session_number_key",
          "definition": "CREATE UNIQUE INDEX pms_receiving_sessions_session_number_key ON public.pms_receiving_sessions USING btree (session_number)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role can update sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "UPDATE",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create sessions for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (created_by = auth.uid()))"
          },
          {
            "name": "Users can update own draft sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND (created_by = auth.uid()) AND (status = ANY (ARRAY['draft'::text, 'reconciling'::text, 'verifying'::text])))",
            "with_check": null
          },
          {
            "name": "Users can view their yacht's sessions",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_enforce_session_state",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION enforce_receiving_session_state_transitions()"
        },
        {
          "name": "trg_generate_session_number",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION generate_receiving_session_number()"
        },
        {
          "name": "trg_receiving_sessions_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 0
    },
    "pms_service_contracts": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "contract_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "vendor_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "vendor_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "contract_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "contract_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "start_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "end_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "value",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "currency",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'USD'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "coverage_details",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_ids",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": "'{}'::uuid[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'active'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "auto_renew",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "renewal_notice_days",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "30",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "claims_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_service_contracts_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_service_contracts_vendor_id_fkey",
            "column": "vendor_id",
            "references_table": "pms_suppliers",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_service_contracts_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_144186_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_144186_21_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_144186_22_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_144186_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_144186_3_not_null",
            "clause": "contract_name IS NOT NULL"
          },
          {
            "name": "2200_144186_4_not_null",
            "clause": "vendor_name IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_contracts_end_date",
          "definition": "CREATE INDEX idx_contracts_end_date ON public.pms_service_contracts USING btree (end_date) WHERE (end_date IS NOT NULL)"
        },
        {
          "name": "idx_contracts_status",
          "definition": "CREATE INDEX idx_contracts_status ON public.pms_service_contracts USING btree (status)"
        },
        {
          "name": "idx_contracts_type",
          "definition": "CREATE INDEX idx_contracts_type ON public.pms_service_contracts USING btree (contract_type)"
        },
        {
          "name": "idx_contracts_vendor",
          "definition": "CREATE INDEX idx_contracts_vendor ON public.pms_service_contracts USING btree (vendor_id) WHERE (vendor_id IS NOT NULL)"
        },
        {
          "name": "idx_contracts_yacht",
          "definition": "CREATE INDEX idx_contracts_yacht ON public.pms_service_contracts USING btree (yacht_id)"
        },
        {
          "name": "pms_service_contracts_pkey",
          "definition": "CREATE UNIQUE INDEX pms_service_contracts_pkey ON public.pms_service_contracts USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can delete contracts",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Officers can create contracts",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text, 'captain'::text, 'purser'::text])))"
          },
          {
            "name": "Officers can update contracts",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text, 'captain'::text, 'purser'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access contracts",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can view contracts",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_shopping_list_items": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "manufacturer",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_candidate_part",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_requested",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_approved",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_ordered",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_received",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_installed",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "unit",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "preferred_supplier",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "estimated_unit_price",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'candidate'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_receiving_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "order_line_number",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "approval_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "rejected_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "rejected_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "rejection_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fulfilled_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "installed_to_equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "urgency",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "required_by_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "rejection_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "candidate_promoted_to_part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "promoted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "promoted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_shopping_list_items_candidate_promoted_to_part_id_fkey",
            "column": "candidate_promoted_to_part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_shopping_list_items_installed_to_equipment_id_fkey",
            "column": "installed_to_equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_shopping_list_items_order_id_fkey",
            "column": "order_id",
            "references_table": "pms_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_shopping_list_items_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_shopping_list_items_source_receiving_id_fkey",
            "column": "source_receiving_id",
            "references_table": "pms_receiving_events",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_shopping_list_items_source_work_order_id_fkey",
            "column": "source_work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_shopping_list_items_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_129052_16_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_129052_17_not_null",
            "clause": "source_type IS NOT NULL"
          },
          {
            "name": "2200_129052_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129052_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129052_34_not_null",
            "clause": "created_by IS NOT NULL"
          },
          {
            "name": "2200_129052_35_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129052_37_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_129052_4_not_null",
            "clause": "part_name IS NOT NULL"
          },
          {
            "name": "2200_129052_7_not_null",
            "clause": "is_candidate_part IS NOT NULL"
          },
          {
            "name": "2200_129052_8_not_null",
            "clause": "quantity_requested IS NOT NULL"
          },
          {
            "name": "check_promotion_consistency",
            "clause": "(((candidate_promoted_to_part_id IS NULL) AND (promoted_by IS NULL) AND (promoted_at IS NULL)) OR ((candidate_promoted_to_part_id IS NOT NULL) AND (promoted_by IS NOT NULL) AND (promoted_at IS NOT NULL)))"
          },
          {
            "name": "check_quantities",
            "clause": "((quantity_received <= COALESCE(quantity_ordered, quantity_requested)) AND (quantity_installed <= COALESCE(quantity_ordered, quantity_requested)))"
          },
          {
            "name": "pms_shopping_list_items_quantity_approved_check",
            "clause": "(quantity_approved > (0)::numeric)"
          },
          {
            "name": "pms_shopping_list_items_quantity_installed_check",
            "clause": "(quantity_installed >= (0)::numeric)"
          },
          {
            "name": "pms_shopping_list_items_quantity_ordered_check",
            "clause": "(quantity_ordered > (0)::numeric)"
          },
          {
            "name": "pms_shopping_list_items_quantity_received_check",
            "clause": "(quantity_received >= (0)::numeric)"
          },
          {
            "name": "pms_shopping_list_items_quantity_requested_check",
            "clause": "(quantity_requested > (0)::numeric)"
          },
          {
            "name": "pms_shopping_list_items_source_type_check",
            "clause": "(source_type = ANY (ARRAY['inventory_low'::text, 'inventory_oos'::text, 'work_order_usage'::text, 'receiving_missing'::text, 'receiving_damaged'::text, 'manual_add'::text]))"
          },
          {
            "name": "pms_shopping_list_items_status_check",
            "clause": "(status = ANY (ARRAY['candidate'::text, 'under_review'::text, 'approved'::text, 'ordered'::text, 'partially_fulfilled'::text, 'fulfilled'::text, 'installed'::text]))"
          },
          {
            "name": "pms_shopping_list_items_unit_check",
            "clause": "((unit = ANY (ARRAY['ea'::text, 'kg'::text, 'g'::text, 'L'::text, 'mL'::text, 'm'::text, 'cm'::text, 'mm'::text, 'ft'::text, 'in'::text, 'm2'::text, 'm3'::text, 'gal'::text, 'qt'::text, 'pt'::text, 'oz'::text, 'lb'::text, 'box'::text, 'set'::text, 'pair'::text, 'roll'::text, 'sheet'::text])) OR (unit IS NULL))"
          },
          {
            "name": "pms_shopping_list_items_urgency_check",
            "clause": "(urgency = ANY (ARRAY['low'::text, 'normal'::text, 'high'::text, 'critical'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_shopping_list_created",
          "definition": "CREATE INDEX idx_shopping_list_created ON public.pms_shopping_list_items USING btree (created_at DESC)"
        },
        {
          "name": "idx_shopping_list_order",
          "definition": "CREATE INDEX idx_shopping_list_order ON public.pms_shopping_list_items USING btree (order_id) WHERE (order_id IS NOT NULL)"
        },
        {
          "name": "idx_shopping_list_part",
          "definition": "CREATE INDEX idx_shopping_list_part ON public.pms_shopping_list_items USING btree (part_id) WHERE (part_id IS NOT NULL)"
        },
        {
          "name": "idx_shopping_list_source_wo",
          "definition": "CREATE INDEX idx_shopping_list_source_wo ON public.pms_shopping_list_items USING btree (source_work_order_id) WHERE (source_work_order_id IS NOT NULL)"
        },
        {
          "name": "idx_shopping_list_status",
          "definition": "CREATE INDEX idx_shopping_list_status ON public.pms_shopping_list_items USING btree (status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_shopping_list_unpromoted_candidates",
          "definition": "CREATE INDEX idx_shopping_list_unpromoted_candidates ON public.pms_shopping_list_items USING btree (yacht_id, is_candidate_part) WHERE ((is_candidate_part = true) AND (candidate_promoted_to_part_id IS NULL) AND (deleted_at IS NULL))"
        },
        {
          "name": "idx_shopping_list_urgency",
          "definition": "CREATE INDEX idx_shopping_list_urgency ON public.pms_shopping_list_items USING btree (urgency) WHERE ((urgency = ANY (ARRAY['high'::text, 'critical'::text])) AND (deleted_at IS NULL))"
        },
        {
          "name": "idx_shopping_list_yacht",
          "definition": "CREATE INDEX idx_shopping_list_yacht ON public.pms_shopping_list_items USING btree (yacht_id)"
        },
        {
          "name": "idx_shopping_list_yacht_created",
          "definition": "CREATE INDEX idx_shopping_list_yacht_created ON public.pms_shopping_list_items USING btree (yacht_id, created_at DESC) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_shopping_list_yacht_order",
          "definition": "CREATE INDEX idx_shopping_list_yacht_order ON public.pms_shopping_list_items USING btree (yacht_id, order_id) WHERE ((order_id IS NOT NULL) AND (deleted_at IS NULL))"
        },
        {
          "name": "idx_shopping_list_yacht_status",
          "definition": "CREATE INDEX idx_shopping_list_yacht_status ON public.pms_shopping_list_items USING btree (yacht_id, status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "pms_shopping_list_items_pkey",
          "definition": "CREATE UNIQUE INDEX pms_shopping_list_items_pkey ON public.pms_shopping_list_items USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "HOD can update shopping list items",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND is_hod(auth.uid(), yacht_id))",
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Service role has full access to shopping list",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create shopping list items",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (created_by = auth.uid()) AND (status = 'candidate'::text))"
          },
          {
            "name": "Users can view shopping list items for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_enforce_shopping_list_edit_rules",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION enforce_shopping_list_edit_rules()"
        },
        {
          "name": "trg_log_shopping_list_state_change",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION log_shopping_list_state_change()"
        },
        {
          "name": "trg_log_shopping_list_state_change",
          "event": "UPDATE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION log_shopping_list_state_change()"
        }
      ],
      "row_count": 34
    },
    "pms_shopping_list_state_history": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "shopping_list_item_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "previous_state",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "new_state",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "transition_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "transition_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "changed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "changed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "related_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "related_receiving_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_shopping_list_state_history_related_order_id_fkey",
            "column": "related_order_id",
            "references_table": "pms_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_shopping_list_state_history_related_receiving_event_id_fkey",
            "column": "related_receiving_event_id",
            "references_table": "pms_receiving_events",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_shopping_list_state_history_shopping_list_item_id_fkey",
            "column": "shopping_list_item_id",
            "references_table": "pms_shopping_list_items",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_shopping_list_state_history_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_129282_13_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_129282_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_129282_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_129282_3_not_null",
            "clause": "shopping_list_item_id IS NOT NULL"
          },
          {
            "name": "2200_129282_5_not_null",
            "clause": "new_state IS NOT NULL"
          },
          {
            "name": "2200_129282_8_not_null",
            "clause": "changed_by IS NOT NULL"
          },
          {
            "name": "2200_129282_9_not_null",
            "clause": "changed_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_shopping_state_changed_at",
          "definition": "CREATE INDEX idx_shopping_state_changed_at ON public.pms_shopping_list_state_history USING btree (changed_at DESC)"
        },
        {
          "name": "idx_shopping_state_changed_by",
          "definition": "CREATE INDEX idx_shopping_state_changed_by ON public.pms_shopping_list_state_history USING btree (changed_by)"
        },
        {
          "name": "idx_shopping_state_item",
          "definition": "CREATE INDEX idx_shopping_state_item ON public.pms_shopping_list_state_history USING btree (shopping_list_item_id)"
        },
        {
          "name": "idx_shopping_state_yacht",
          "definition": "CREATE INDEX idx_shopping_state_yacht ON public.pms_shopping_list_state_history USING btree (yacht_id)"
        },
        {
          "name": "pms_shopping_list_state_history_pkey",
          "definition": "CREATE UNIQUE INDEX pms_shopping_list_state_history_pkey ON public.pms_shopping_list_state_history USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role can insert state history",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "true"
          },
          {
            "name": "Users can view state history for their yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 36
    },
    "pms_suppliers": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "contact_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "email",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "phone",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "address",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "preferred",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "suppliers_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18318_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18318_11_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18318_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18318_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18318_3_not_null",
            "clause": "name IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_suppliers_yacht",
          "definition": "CREATE INDEX idx_pms_suppliers_yacht ON public.pms_suppliers USING btree (yacht_id)"
        },
        {
          "name": "idx_suppliers_preferred",
          "definition": "CREATE INDEX idx_suppliers_preferred ON public.pms_suppliers USING btree (preferred)"
        },
        {
          "name": "idx_suppliers_yacht_id",
          "definition": "CREATE INDEX idx_suppliers_yacht_id ON public.pms_suppliers USING btree (yacht_id)"
        },
        {
          "name": "suppliers_pkey",
          "definition": "CREATE UNIQUE INDEX suppliers_pkey ON public.pms_suppliers USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can manage suppliers",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access suppliers",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view suppliers",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 50
    },
    "pms_vessel_certificates": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificate_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificate_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "certificate_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "issuing_authority",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "issue_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expiry_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_survey_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "next_survey_due",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'valid'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "properties",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "vessel_certificates_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "vessel_certificates_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_24826_11_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_24826_14_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_24826_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_24826_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_24826_3_not_null",
            "clause": "certificate_type IS NOT NULL"
          },
          {
            "name": "2200_24826_4_not_null",
            "clause": "certificate_name IS NOT NULL"
          },
          {
            "name": "2200_24826_6_not_null",
            "clause": "issuing_authority IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_vessel_certs_expiry",
          "definition": "CREATE INDEX idx_vessel_certs_expiry ON public.pms_vessel_certificates USING btree (yacht_id, expiry_date)"
        },
        {
          "name": "idx_vessel_certs_status",
          "definition": "CREATE INDEX idx_vessel_certs_status ON public.pms_vessel_certificates USING btree (yacht_id, status)"
        },
        {
          "name": "idx_vessel_certs_survey",
          "definition": "CREATE INDEX idx_vessel_certs_survey ON public.pms_vessel_certificates USING btree (yacht_id, next_survey_due) WHERE (next_survey_due IS NOT NULL)"
        },
        {
          "name": "idx_vessel_certs_type",
          "definition": "CREATE INDEX idx_vessel_certs_type ON public.pms_vessel_certificates USING btree (yacht_id, certificate_type)"
        },
        {
          "name": "idx_vessel_certs_yacht",
          "definition": "CREATE INDEX idx_vessel_certs_yacht ON public.pms_vessel_certificates USING btree (yacht_id)"
        },
        {
          "name": "vessel_certificates_pkey",
          "definition": "CREATE UNIQUE INDEX vessel_certificates_pkey ON public.pms_vessel_certificates USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access vessel_certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view yacht vessel certificates",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_voyage_log": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "voyage_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "voyage_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "departure_port",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "departure_port_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "arrival_port",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "arrival_port_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "departure_time",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "arrival_time",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "distance_nm",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fuel_consumed_liters",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "properties",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "voyage_log_arrival_port_node_id_fkey",
            "column": "arrival_port_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "voyage_log_departure_port_node_id_fkey",
            "column": "departure_port_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "voyage_log_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_24851_14_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_24851_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_24851_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_voyage_log_dates",
          "definition": "CREATE INDEX idx_voyage_log_dates ON public.pms_voyage_log USING btree (yacht_id, departure_time)"
        },
        {
          "name": "idx_voyage_log_ports",
          "definition": "CREATE INDEX idx_voyage_log_ports ON public.pms_voyage_log USING btree (yacht_id, departure_port, arrival_port)"
        },
        {
          "name": "idx_voyage_log_type",
          "definition": "CREATE INDEX idx_voyage_log_type ON public.pms_voyage_log USING btree (yacht_id, voyage_type)"
        },
        {
          "name": "idx_voyage_log_yacht",
          "definition": "CREATE INDEX idx_voyage_log_yacht ON public.pms_voyage_log USING btree (yacht_id)"
        },
        {
          "name": "voyage_log_pkey",
          "definition": "CREATE UNIQUE INDEX voyage_log_pkey ON public.pms_voyage_log USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access voyage_log",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view yacht voyage log",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_work_order_checklist": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "instructions",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sequence",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_completed",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completion_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_required",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requires_photo",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requires_signature",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "photo_url",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "signature_data",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "fk_pms_wo_checklist_work_order",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_138858_12_not_null",
            "clause": "is_required IS NOT NULL"
          },
          {
            "name": "2200_138858_13_not_null",
            "clause": "requires_photo IS NOT NULL"
          },
          {
            "name": "2200_138858_14_not_null",
            "clause": "requires_signature IS NOT NULL"
          },
          {
            "name": "2200_138858_18_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138858_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138858_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138858_3_not_null",
            "clause": "work_order_id IS NOT NULL"
          },
          {
            "name": "2200_138858_4_not_null",
            "clause": "title IS NOT NULL"
          },
          {
            "name": "2200_138858_7_not_null",
            "clause": "sequence IS NOT NULL"
          },
          {
            "name": "2200_138858_8_not_null",
            "clause": "is_completed IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_wo_checklist_sequence",
          "definition": "CREATE INDEX idx_pms_wo_checklist_sequence ON public.pms_work_order_checklist USING btree (work_order_id, sequence)"
        },
        {
          "name": "idx_pms_wo_checklist_work_order_id",
          "definition": "CREATE INDEX idx_pms_wo_checklist_work_order_id ON public.pms_work_order_checklist USING btree (work_order_id)"
        },
        {
          "name": "idx_pms_wo_checklist_yacht_id",
          "definition": "CREATE INDEX idx_pms_wo_checklist_yacht_id ON public.pms_work_order_checklist USING btree (yacht_id)"
        },
        {
          "name": "pms_work_order_checklist_pkey",
          "definition": "CREATE UNIQUE INDEX pms_work_order_checklist_pkey ON public.pms_work_order_checklist USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "service_role_bypass",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "users_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "users_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_view",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "yacht_isolation_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))"
          },
          {
            "name": "yacht_isolation_select",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_work_order_history": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "hours_logged",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status_on_completion",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "parts_used",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "documents_used",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "faults_related",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "work_order_history_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "work_order_history_work_order_id_fkey",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "work_order_history_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18143_14_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18143_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18143_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18143_3_not_null",
            "clause": "work_order_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_work_order_history_completed_at",
          "definition": "CREATE INDEX idx_work_order_history_completed_at ON public.pms_work_order_history USING btree (completed_at)"
        },
        {
          "name": "idx_work_order_history_equipment_id",
          "definition": "CREATE INDEX idx_work_order_history_equipment_id ON public.pms_work_order_history USING btree (equipment_id)"
        },
        {
          "name": "idx_work_order_history_work_order_id",
          "definition": "CREATE INDEX idx_work_order_history_work_order_id ON public.pms_work_order_history USING btree (work_order_id)"
        },
        {
          "name": "idx_work_order_history_yacht_id",
          "definition": "CREATE INDEX idx_work_order_history_yacht_id ON public.pms_work_order_history USING btree (yacht_id)"
        },
        {
          "name": "work_order_history_pkey",
          "definition": "CREATE UNIQUE INDEX work_order_history_pkey ON public.pms_work_order_history USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can add history",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'deck'::text, 'interior'::text])))"
          },
          {
            "name": "Service role full access work_order_history",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view work order history",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "pms_work_order_notes": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "note_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "note_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'general'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_work_order_notes_created_by_fkey",
            "column": "created_by",
            "references_table": "auth_users_profiles",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "pms_work_order_notes_work_order_id_fkey",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_126703_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_126703_2_not_null",
            "clause": "work_order_id IS NOT NULL"
          },
          {
            "name": "2200_126703_3_not_null",
            "clause": "note_text IS NOT NULL"
          },
          {
            "name": "2200_126703_4_not_null",
            "clause": "note_type IS NOT NULL"
          },
          {
            "name": "2200_126703_5_not_null",
            "clause": "created_by IS NOT NULL"
          },
          {
            "name": "2200_126703_6_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "pms_work_order_notes_note_type_check",
            "clause": "(note_type = ANY (ARRAY['general'::text, 'progress'::text, 'issue'::text, 'resolution'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_work_order_notes_created_by",
          "definition": "CREATE INDEX idx_pms_work_order_notes_created_by ON public.pms_work_order_notes USING btree (created_by)"
        },
        {
          "name": "idx_pms_work_order_notes_user",
          "definition": "CREATE INDEX idx_pms_work_order_notes_user ON public.pms_work_order_notes USING btree (created_by, created_at DESC)"
        },
        {
          "name": "idx_pms_work_order_notes_wo",
          "definition": "CREATE INDEX idx_pms_work_order_notes_wo ON public.pms_work_order_notes USING btree (work_order_id, created_at DESC)"
        },
        {
          "name": "idx_pms_work_order_notes_work_order_id",
          "definition": "CREATE INDEX idx_pms_work_order_notes_work_order_id ON public.pms_work_order_notes USING btree (work_order_id, created_at DESC)"
        },
        {
          "name": "pms_work_order_notes_pkey",
          "definition": "CREATE UNIQUE INDEX pms_work_order_notes_pkey ON public.pms_work_order_notes USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Authenticated users can view notes",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role full access",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "pms_work_order_notes_yacht_isolation",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(work_order_id IN ( SELECT pms_work_orders.id\n   FROM pms_work_orders\n  WHERE (pms_work_orders.yacht_id = (current_setting('app.current_yacht_id'::text))::uuid)))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 2687
    },
    "pms_work_order_parts": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "1",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_work_order_parts_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "pms_work_order_parts_work_order_id_fkey",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "pms_work_order_parts_work_order_id_part_id_key",
            "columns": [
              "work_order_id",
              "part_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_124064_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_124064_2_not_null",
            "clause": "work_order_id IS NOT NULL"
          },
          {
            "name": "2200_124064_3_not_null",
            "clause": "part_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_work_order_parts_part_id",
          "definition": "CREATE INDEX idx_pms_work_order_parts_part_id ON public.pms_work_order_parts USING btree (part_id)"
        },
        {
          "name": "idx_pms_work_order_parts_work_order_id",
          "definition": "CREATE INDEX idx_pms_work_order_parts_work_order_id ON public.pms_work_order_parts USING btree (work_order_id)"
        },
        {
          "name": "idx_wo_parts_part",
          "definition": "CREATE INDEX idx_wo_parts_part ON public.pms_work_order_parts USING btree (part_id)"
        },
        {
          "name": "idx_wo_parts_work_order",
          "definition": "CREATE INDEX idx_wo_parts_work_order ON public.pms_work_order_parts USING btree (work_order_id)"
        },
        {
          "name": "pms_work_order_parts_pkey",
          "definition": "CREATE UNIQUE INDEX pms_work_order_parts_pkey ON public.pms_work_order_parts USING btree (id)"
        },
        {
          "name": "pms_work_order_parts_work_order_id_part_id_key",
          "definition": "CREATE UNIQUE INDEX pms_work_order_parts_work_order_id_part_id_key ON public.pms_work_order_parts USING btree (work_order_id, part_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Authenticated users can view parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Engineers can manage work order parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((EXISTS ( SELECT 1\n   FROM pms_work_orders wo\n  WHERE ((wo.id = pms_work_order_parts.work_order_id) AND (wo.yacht_id = get_user_yacht_id())))) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text])))",
            "with_check": null
          },
          {
            "name": "Service role full access",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Service role full access wo_parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view work order parts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(EXISTS ( SELECT 1\n   FROM pms_work_orders wo\n  WHERE ((wo.id = pms_work_order_parts.work_order_id) AND (wo.yacht_id = get_user_yacht_id()))))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 117
    },
    "pms_work_orders": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "title",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "type",
          "type": "USER-DEFINED",
          "udt_name": "work_order_type",
          "nullable": false,
          "default": "'scheduled'::work_order_type",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "USER-DEFINED",
          "udt_name": "work_order_priority",
          "nullable": false,
          "default": "'routine'::work_order_priority",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "USER-DEFINED",
          "udt_name": "work_order_status",
          "nullable": false,
          "default": "'planned'::work_order_status",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "due_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "due_hours",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_completed_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_completed_hours",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "frequency",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "wo_number",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'planned'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fault_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "assigned_to",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completion_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "vendor_contact_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "pms_work_orders_fault_id_fkey",
            "column": "fault_id",
            "references_table": "pms_faults",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "work_orders_equipment_id_fkey",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "work_orders_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18104_14_not_null",
            "clause": "created_by IS NOT NULL"
          },
          {
            "name": "2200_18104_17_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18104_18_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_18104_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18104_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18104_4_not_null",
            "clause": "title IS NOT NULL"
          },
          {
            "name": "2200_18104_6_not_null",
            "clause": "type IS NOT NULL"
          },
          {
            "name": "2200_18104_7_not_null",
            "clause": "priority IS NOT NULL"
          },
          {
            "name": "2200_18104_8_not_null",
            "clause": "status IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_work_orders_assigned",
          "definition": "CREATE INDEX idx_pms_work_orders_assigned ON public.pms_work_orders USING btree (assigned_to) WHERE (status <> ALL (ARRAY['completed'::work_order_status, 'cancelled'::work_order_status]))"
        },
        {
          "name": "idx_pms_work_orders_completed_by",
          "definition": "CREATE INDEX idx_pms_work_orders_completed_by ON public.pms_work_orders USING btree (completed_by, completed_at DESC) WHERE (completed_by IS NOT NULL)"
        },
        {
          "name": "idx_pms_work_orders_equipment",
          "definition": "CREATE INDEX idx_pms_work_orders_equipment ON public.pms_work_orders USING btree (equipment_id)"
        },
        {
          "name": "idx_pms_work_orders_fault",
          "definition": "CREATE INDEX idx_pms_work_orders_fault ON public.pms_work_orders USING btree (fault_id) WHERE (fault_id IS NOT NULL)"
        },
        {
          "name": "idx_pms_work_orders_status",
          "definition": "CREATE INDEX idx_pms_work_orders_status ON public.pms_work_orders USING btree (yacht_id, status)"
        },
        {
          "name": "idx_pms_work_orders_vendor_hash",
          "definition": "CREATE INDEX idx_pms_work_orders_vendor_hash ON public.pms_work_orders USING btree (vendor_contact_hash) WHERE (vendor_contact_hash IS NOT NULL)"
        },
        {
          "name": "idx_pms_work_orders_wo_number",
          "definition": "CREATE INDEX idx_pms_work_orders_wo_number ON public.pms_work_orders USING btree (yacht_id, wo_number)"
        },
        {
          "name": "idx_pms_work_orders_yacht",
          "definition": "CREATE INDEX idx_pms_work_orders_yacht ON public.pms_work_orders USING btree (yacht_id)"
        },
        {
          "name": "idx_work_orders_created",
          "definition": "CREATE INDEX idx_work_orders_created ON public.pms_work_orders USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "idx_work_orders_due",
          "definition": "CREATE INDEX idx_work_orders_due ON public.pms_work_orders USING btree (yacht_id, due_date) WHERE (due_date IS NOT NULL)"
        },
        {
          "name": "idx_work_orders_due_date",
          "definition": "CREATE INDEX idx_work_orders_due_date ON public.pms_work_orders USING btree (due_date)"
        },
        {
          "name": "idx_work_orders_equipment",
          "definition": "CREATE INDEX idx_work_orders_equipment ON public.pms_work_orders USING btree (equipment_id) WHERE (equipment_id IS NOT NULL)"
        },
        {
          "name": "idx_work_orders_equipment_id",
          "definition": "CREATE INDEX idx_work_orders_equipment_id ON public.pms_work_orders USING btree (equipment_id)"
        },
        {
          "name": "idx_work_orders_priority",
          "definition": "CREATE INDEX idx_work_orders_priority ON public.pms_work_orders USING btree (priority)"
        },
        {
          "name": "idx_work_orders_status",
          "definition": "CREATE INDEX idx_work_orders_status ON public.pms_work_orders USING btree (status)"
        },
        {
          "name": "idx_work_orders_wo_number",
          "definition": "CREATE INDEX idx_work_orders_wo_number ON public.pms_work_orders USING btree (wo_number)"
        },
        {
          "name": "idx_work_orders_yacht_id",
          "definition": "CREATE INDEX idx_work_orders_yacht_id ON public.pms_work_orders USING btree (yacht_id)"
        },
        {
          "name": "work_orders_pkey",
          "definition": "CREATE UNIQUE INDEX work_orders_pkey ON public.pms_work_orders USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Engineers can create work orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'deck'::text, 'interior'::text])))"
          },
          {
            "name": "Engineers can update work orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "UPDATE",
            "using": "((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'manager'::text])))",
            "with_check": null
          },
          {
            "name": "Managers can delete work orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "DELETE",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access work_orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view work orders",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "no_hard_delete_work_orders",
          "event": "DELETE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION prevent_hard_delete()"
        },
        {
          "name": "set_updated_at_work_orders",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at()"
        },
        {
          "name": "trg_work_order_insert_predictive",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION on_work_order_insert_notify_predictive()"
        },
        {
          "name": "trg_work_order_update_predictive",
          "event": "UPDATE",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION on_work_order_update_notify_predictive()"
        }
      ],
      "row_count": 2820
    },
    "pms_worklist_tasks": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "instructions",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": "'normal'::character varying",
          "is_identity": false,
          "max_length": 20
        },
        {
          "name": "assigned_to",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "assigned_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "assigned_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "scheduled_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "due_date",
          "type": "date",
          "udt_name": "date",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "estimated_duration_minutes",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "work_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fault_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": "'pending'::character varying",
          "is_identity": false,
          "max_length": 20
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completion_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "actual_duration_minutes",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "progress",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tags",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "fk_pms_worklist_tasks_equipment",
            "column": "equipment_id",
            "references_table": "pms_equipment",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "fk_pms_worklist_tasks_fault",
            "column": "fault_id",
            "references_table": "pms_faults",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "fk_pms_worklist_tasks_work_order",
            "column": "work_order_id",
            "references_table": "pms_work_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_138816_15_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_138816_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_138816_23_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_138816_24_not_null",
            "clause": "created_by IS NOT NULL"
          },
          {
            "name": "2200_138816_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_138816_3_not_null",
            "clause": "description IS NOT NULL"
          },
          {
            "name": "2200_138816_5_not_null",
            "clause": "priority IS NOT NULL"
          },
          {
            "name": "chk_pms_worklist_tasks_priority",
            "clause": "((priority)::text = ANY ((ARRAY['low'::character varying, 'normal'::character varying, 'high'::character varying, 'urgent'::character varying])::text[]))"
          },
          {
            "name": "chk_pms_worklist_tasks_progress",
            "clause": "((progress >= 0) AND (progress <= 100))"
          },
          {
            "name": "chk_pms_worklist_tasks_status",
            "clause": "((status)::text = ANY ((ARRAY['pending'::character varying, 'in_progress'::character varying, 'completed'::character varying, 'cancelled'::character varying, 'deferred'::character varying])::text[]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_pms_worklist_tasks_assigned_to",
          "definition": "CREATE INDEX idx_pms_worklist_tasks_assigned_to ON public.pms_worklist_tasks USING btree (assigned_to) WHERE (assigned_to IS NOT NULL)"
        },
        {
          "name": "idx_pms_worklist_tasks_created_at",
          "definition": "CREATE INDEX idx_pms_worklist_tasks_created_at ON public.pms_worklist_tasks USING btree (created_at DESC)"
        },
        {
          "name": "idx_pms_worklist_tasks_due_date",
          "definition": "CREATE INDEX idx_pms_worklist_tasks_due_date ON public.pms_worklist_tasks USING btree (due_date) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_pms_worklist_tasks_scheduled_date",
          "definition": "CREATE INDEX idx_pms_worklist_tasks_scheduled_date ON public.pms_worklist_tasks USING btree (scheduled_date) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_pms_worklist_tasks_status",
          "definition": "CREATE INDEX idx_pms_worklist_tasks_status ON public.pms_worklist_tasks USING btree (status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "idx_pms_worklist_tasks_yacht_id",
          "definition": "CREATE INDEX idx_pms_worklist_tasks_yacht_id ON public.pms_worklist_tasks USING btree (yacht_id)"
        },
        {
          "name": "pms_worklist_tasks_pkey",
          "definition": "CREATE UNIQUE INDEX pms_worklist_tasks_pkey ON public.pms_worklist_tasks USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "service_role_bypass",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "users_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "users_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "users_view",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "yacht_isolation_delete",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "DELETE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))"
          },
          {
            "name": "yacht_isolation_select",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          },
          {
            "name": "yacht_isolation_update",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(((yacht_id)::text = ((current_setting('request.jwt.claims'::text, true))::json ->> 'yacht_id'::text)) OR (yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))))",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trg_pms_worklist_tasks_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_pms_worklist_tasks_updated_at()"
        },
        {
          "name": "trg_set_worklist_task_completed",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION set_worklist_task_completed_at()"
        }
      ],
      "row_count": 0
    },
    "predictive_state": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "risk_score",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "failure_probability",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "trend",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'stable'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "anomalies",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "failure_modes",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "recommended_actions",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "next_maintenance_due",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_updated",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "predictive_state_equipment_id_key",
            "columns": [
              "equipment_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_137348_12_not_null",
            "clause": "last_updated IS NOT NULL"
          },
          {
            "name": "2200_137348_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_137348_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_137348_3_not_null",
            "clause": "equipment_id IS NOT NULL"
          },
          {
            "name": "2200_137348_4_not_null",
            "clause": "risk_score IS NOT NULL"
          },
          {
            "name": "2200_137348_5_not_null",
            "clause": "confidence IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_predictive_state_equipment",
          "definition": "CREATE INDEX idx_predictive_state_equipment ON public.predictive_state USING btree (equipment_id)"
        },
        {
          "name": "predictive_state_equipment_id_key",
          "definition": "CREATE UNIQUE INDEX predictive_state_equipment_id_key ON public.predictive_state USING btree (equipment_id)"
        },
        {
          "name": "predictive_state_pkey1",
          "definition": "CREATE UNIQUE INDEX predictive_state_pkey1 ON public.predictive_state USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "vessel_isolation_predictive_state",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 4
    },
    "procurement_intents": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "vendor_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'open'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "summary",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "vendor_domain",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "vendor_email_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "related_object_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "related_object_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_from_thread_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "converted_to_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "converted_to_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "procurement_intents_created_from_thread_id_fkey",
            "column": "created_from_thread_id",
            "references_table": "email_threads",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "NO ACTION"
          },
          {
            "constraint_name": "procurement_intents_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_140266_14_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_140266_15_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_140266_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_140266_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_140266_4_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "procurement_intents_converted_to_type_check",
            "clause": "(converted_to_type = ANY (ARRAY['purchase_order'::text, 'work_order'::text]))"
          },
          {
            "name": "procurement_intents_status_check",
            "clause": "(status = ANY (ARRAY['open'::text, 'converted'::text, 'closed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_procurement_intents_status",
          "definition": "CREATE INDEX idx_procurement_intents_status ON public.procurement_intents USING btree (yacht_id, status) WHERE (status = 'open'::text)"
        },
        {
          "name": "idx_procurement_intents_vendor_hash",
          "definition": "CREATE INDEX idx_procurement_intents_vendor_hash ON public.procurement_intents USING btree (vendor_email_hash)"
        },
        {
          "name": "idx_procurement_intents_yacht",
          "definition": "CREATE INDEX idx_procurement_intents_yacht ON public.procurement_intents USING btree (yacht_id)"
        },
        {
          "name": "procurement_intents_pkey",
          "definition": "CREATE UNIQUE INDEX procurement_intents_pkey ON public.procurement_intents USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages procurement_intents",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "Users can create yacht procurement_intents",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))"
          },
          {
            "name": "Users can update yacht procurement_intents",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "UPDATE",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          },
          {
            "name": "Users can view yacht procurement_intents",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "related_audit_events": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "event_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "payload",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "occurred_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "related_audit_events_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_140228_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_140228_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_140228_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_140228_4_not_null",
            "clause": "event_name IS NOT NULL"
          },
          {
            "name": "2200_140228_5_not_null",
            "clause": "payload IS NOT NULL"
          },
          {
            "name": "2200_140228_6_not_null",
            "clause": "occurred_at IS NOT NULL"
          },
          {
            "name": "related_audit_events_event_name_check",
            "clause": "(event_name = ANY (ARRAY['artefact_opened'::text, 'relation_added'::text, 'situation_ended'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_related_audit_events_event_name",
          "definition": "CREATE INDEX idx_related_audit_events_event_name ON public.related_audit_events USING btree (yacht_id, event_name)"
        },
        {
          "name": "idx_related_audit_events_yacht_occurred",
          "definition": "CREATE INDEX idx_related_audit_events_yacht_occurred ON public.related_audit_events USING btree (yacht_id, occurred_at DESC)"
        },
        {
          "name": "related_audit_events_pkey",
          "definition": "CREATE UNIQUE INDEX related_audit_events_pkey ON public.related_audit_events USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages related_audit_events",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "related_audit_events_insert_own_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))) AND (user_id = auth.uid()))"
          },
          {
            "name": "related_audit_events_select_own_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "relationship_staging": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "from_canonical",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "to_canonical",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "relationship_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "double precision",
          "udt_name": "float8",
          "nullable": true,
          "default": "0.9",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "evidence",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_chunk_id",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "processed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "graph_edge_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_45130_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_45130_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_45130_3_not_null",
            "clause": "from_canonical IS NOT NULL"
          },
          {
            "name": "2200_45130_4_not_null",
            "clause": "to_canonical IS NOT NULL"
          },
          {
            "name": "2200_45130_5_not_null",
            "clause": "relationship_type IS NOT NULL"
          },
          {
            "name": "relationship_staging_status_check",
            "clause": "(status = ANY (ARRAY['pending'::text, 'processing'::text, 'completed'::text, 'failed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_relationship_staging_status",
          "definition": "CREATE INDEX idx_relationship_staging_status ON public.relationship_staging USING btree (status) WHERE (status = 'pending'::text)"
        },
        {
          "name": "idx_relationship_staging_yacht",
          "definition": "CREATE INDEX idx_relationship_staging_yacht ON public.relationship_staging USING btree (yacht_id)"
        },
        {
          "name": "relationship_staging_pkey",
          "definition": "CREATE UNIQUE INDEX relationship_staging_pkey ON public.relationship_staging USING btree (id)"
        }
      ],
      "rls": {
        "enabled": false,
        "policies": []
      },
      "triggers": [],
      "row_count": 674
    },
    "role_handover_buckets": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "role_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "department",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "bucket_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "bucket_order",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_entity_types",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "filter_criteria",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "auto_populate",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "auto_populate_criteria",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "max_items",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "10",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "show_if_empty",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "empty_message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'No items'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_critical_bucket",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "role_handover_buckets_yacht_id_role_id_bucket_name_key",
            "columns": [
              "yacht_id",
              "role_id",
              "bucket_name"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_135650_16_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135650_17_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_135650_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135650_3_not_null",
            "clause": "role_id IS NOT NULL"
          },
          {
            "name": "2200_135650_4_not_null",
            "clause": "department IS NOT NULL"
          },
          {
            "name": "2200_135650_5_not_null",
            "clause": "bucket_name IS NOT NULL"
          },
          {
            "name": "2200_135650_6_not_null",
            "clause": "bucket_order IS NOT NULL"
          },
          {
            "name": "2200_135650_7_not_null",
            "clause": "source_entity_types IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_role_handover_buckets_dept",
          "definition": "CREATE INDEX idx_role_handover_buckets_dept ON public.role_handover_buckets USING btree (department)"
        },
        {
          "name": "idx_role_handover_buckets_role",
          "definition": "CREATE INDEX idx_role_handover_buckets_role ON public.role_handover_buckets USING btree (role_id)"
        },
        {
          "name": "idx_role_handover_buckets_yacht",
          "definition": "CREATE INDEX idx_role_handover_buckets_yacht ON public.role_handover_buckets USING btree (yacht_id)"
        },
        {
          "name": "role_handover_buckets_pkey",
          "definition": "CREATE UNIQUE INDEX role_handover_buckets_pkey ON public.role_handover_buckets USING btree (id)"
        },
        {
          "name": "role_handover_buckets_yacht_id_role_id_bucket_name_key",
          "definition": "CREATE UNIQUE INDEX role_handover_buckets_yacht_id_role_id_bucket_name_key ON public.role_handover_buckets USING btree (yacht_id, role_id, bucket_name)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "handover_buckets_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [
        {
          "name": "trigger_role_handover_buckets_updated",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_role_handover_buckets_timestamp()"
        }
      ],
      "row_count": 46
    },
    "role_search_profiles": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "role_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "default_intent",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'information'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "intent_biases",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_biases",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "domain_weights",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "result_type_order",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "'{}'::text[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "answer_style",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'technical'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "default_detail_level",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'normal'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "recency_boost",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "handover_auto_include",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "'{}'::text[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "sample_queries",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "'{}'::text[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [
          {
            "name": "role_search_profiles_yacht_id_role_id_key",
            "columns": [
              "yacht_id",
              "role_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_135621_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135621_16_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_135621_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135621_3_not_null",
            "clause": "role_id IS NOT NULL"
          },
          {
            "name": "2200_135621_7_not_null",
            "clause": "domain_weights IS NOT NULL"
          },
          {
            "name": "valid_answer_style",
            "clause": "(answer_style = ANY (ARRAY['technical'::text, 'summary'::text, 'narrative'::text, 'concise'::text]))"
          },
          {
            "name": "valid_detail_level",
            "clause": "(default_detail_level = ANY (ARRAY['minimal'::text, 'normal'::text, 'detailed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_role_search_profiles_role",
          "definition": "CREATE INDEX idx_role_search_profiles_role ON public.role_search_profiles USING btree (role_id)"
        },
        {
          "name": "idx_role_search_profiles_yacht",
          "definition": "CREATE INDEX idx_role_search_profiles_yacht ON public.role_search_profiles USING btree (yacht_id)"
        },
        {
          "name": "role_search_profiles_pkey",
          "definition": "CREATE UNIQUE INDEX role_search_profiles_pkey ON public.role_search_profiles USING btree (id)"
        },
        {
          "name": "role_search_profiles_yacht_id_role_id_key",
          "definition": "CREATE UNIQUE INDEX role_search_profiles_yacht_id_role_id_key ON public.role_search_profiles USING btree (yacht_id, role_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "search_profiles_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [
        {
          "name": "trigger_role_search_profiles_updated",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_role_search_profiles_timestamp()"
        }
      ],
      "row_count": 0
    },
    "search_document_chunks": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chunk_index",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "text",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "page_number",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_ids",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": "'{}'::uuid[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "fault_codes",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "'{}'::text[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tags",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": "'{}'::text[]",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "content",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "graph_extracted",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "graph_extracted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "section_title",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "doc_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_tag",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "graph_extract_status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "graph_extract_error",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "section_path",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "section_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_section_entry",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptom_codes",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "graph_extract_ts",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_18470_12_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_18470_19_not_null",
            "clause": "graph_extract_status IS NOT NULL"
          },
          {
            "name": "2200_18470_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18470_23_not_null",
            "clause": "is_section_entry IS NOT NULL"
          },
          {
            "name": "document_chunks_graph_extract_status_check",
            "clause": "(graph_extract_status = ANY (ARRAY['pending'::text, 'success'::text, 'failed'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "document_chunks_pkey",
          "definition": "CREATE UNIQUE INDEX document_chunks_pkey ON public.search_document_chunks USING btree (id)"
        },
        {
          "name": "idx_chunks_doc_type",
          "definition": "CREATE INDEX idx_chunks_doc_type ON public.search_document_chunks USING btree (yacht_id, doc_type) WHERE (doc_type IS NOT NULL)"
        },
        {
          "name": "idx_chunks_extract_status",
          "definition": "CREATE INDEX idx_chunks_extract_status ON public.search_document_chunks USING btree (yacht_id, graph_extract_status) WHERE (graph_extract_status = 'pending'::text)"
        },
        {
          "name": "idx_chunks_graph_status",
          "definition": "CREATE INDEX idx_chunks_graph_status ON public.search_document_chunks USING btree (yacht_id, graph_extract_status)"
        },
        {
          "name": "idx_chunks_not_extracted",
          "definition": "CREATE INDEX idx_chunks_not_extracted ON public.search_document_chunks USING btree (graph_extracted) WHERE (graph_extracted = false)"
        },
        {
          "name": "idx_chunks_pending",
          "definition": "CREATE INDEX idx_chunks_pending ON public.search_document_chunks USING btree (yacht_id, created_at) WHERE (graph_extract_status = 'pending'::text)"
        },
        {
          "name": "idx_chunks_section",
          "definition": "CREATE INDEX idx_chunks_section ON public.search_document_chunks USING btree (yacht_id, section_title) WHERE (section_title IS NOT NULL)"
        },
        {
          "name": "idx_chunks_section_title",
          "definition": "CREATE INDEX idx_chunks_section_title ON public.search_document_chunks USING btree (yacht_id, section_title) WHERE (section_title IS NOT NULL)"
        },
        {
          "name": "idx_chunks_symptom_codes",
          "definition": "CREATE INDEX idx_chunks_symptom_codes ON public.search_document_chunks USING gin (symptom_codes) WHERE (symptom_codes IS NOT NULL)"
        },
        {
          "name": "idx_chunks_system_tag",
          "definition": "CREATE INDEX idx_chunks_system_tag ON public.search_document_chunks USING btree (yacht_id, system_tag) WHERE (system_tag IS NOT NULL)"
        },
        {
          "name": "idx_document_chunks_document_id",
          "definition": "CREATE INDEX idx_document_chunks_document_id ON public.search_document_chunks USING btree (document_id)"
        },
        {
          "name": "idx_document_chunks_embedding",
          "definition": "CREATE INDEX idx_document_chunks_embedding ON public.search_document_chunks USING ivfflat (embedding vector_cosine_ops) WITH (lists='100')"
        },
        {
          "name": "idx_document_chunks_equipment_ids",
          "definition": "CREATE INDEX idx_document_chunks_equipment_ids ON public.search_document_chunks USING gin (equipment_ids)"
        },
        {
          "name": "idx_document_chunks_fault_codes",
          "definition": "CREATE INDEX idx_document_chunks_fault_codes ON public.search_document_chunks USING gin (fault_codes)"
        },
        {
          "name": "idx_document_chunks_graph_extracted",
          "definition": "CREATE INDEX idx_document_chunks_graph_extracted ON public.search_document_chunks USING btree (graph_extracted) WHERE (graph_extracted = false)"
        },
        {
          "name": "idx_document_chunks_yacht_id",
          "definition": "CREATE INDEX idx_document_chunks_yacht_id ON public.search_document_chunks USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access document_chunks",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can insert chunks",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Users can view document chunks",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = COALESCE(jwt_yacht_id(), get_user_yacht_id()))",
            "with_check": null
          },
          {
            "name": "service_role_full_access",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [
        {
          "name": "trigger_mark_document_indexed",
          "event": "INSERT",
          "timing": "AFTER",
          "action": "EXECUTE FUNCTION mark_document_indexed()"
        },
        {
          "name": "trigger_populate_chunk_metadata",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION populate_chunk_metadata()"
        },
        {
          "name": "trigger_sync_content",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION sync_content_text()"
        },
        {
          "name": "trigger_sync_content",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION sync_content_text()"
        }
      ],
      "row_count": 47166
    },
    "search_embedding_queue": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "error_message",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "started_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "embedding_jobs_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "embedding_jobs_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18520_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18520_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18520_4_not_null",
            "clause": "status IS NOT NULL"
          },
          {
            "name": "2200_18520_9_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "embedding_jobs_pkey",
          "definition": "CREATE UNIQUE INDEX embedding_jobs_pkey ON public.search_embedding_queue USING btree (id)"
        },
        {
          "name": "idx_embedding_jobs_document_id",
          "definition": "CREATE INDEX idx_embedding_jobs_document_id ON public.search_embedding_queue USING btree (document_id)"
        },
        {
          "name": "idx_embedding_jobs_status",
          "definition": "CREATE INDEX idx_embedding_jobs_status ON public.search_embedding_queue USING btree (status)"
        },
        {
          "name": "idx_embedding_jobs_yacht_id",
          "definition": "CREATE INDEX idx_embedding_jobs_yacht_id ON public.search_embedding_queue USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can view embedding jobs",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "((yacht_id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access embedding_jobs",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can manage embedding jobs",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "search_fault_code_catalog": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "manufacturer",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "code",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "severity",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'warning'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptoms",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "causes",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "diagnostic_steps",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolution_steps",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "related_parts",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_chunk_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "fault_code_catalog_source_chunk_id_fkey",
            "column": "source_chunk_id",
            "references_table": "search_document_chunks",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "fault_code_catalog_source_document_id_fkey",
            "column": "source_document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "fault_code_catalog_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "fault_code_catalog_yacht_id_equipment_type_code_key",
            "columns": [
              "yacht_id",
              "equipment_type",
              "code"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_25331_16_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_25331_17_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_25331_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_25331_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_25331_3_not_null",
            "clause": "equipment_type IS NOT NULL"
          },
          {
            "name": "2200_25331_5_not_null",
            "clause": "code IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "fault_code_catalog_pkey",
          "definition": "CREATE UNIQUE INDEX fault_code_catalog_pkey ON public.search_fault_code_catalog USING btree (id)"
        },
        {
          "name": "fault_code_catalog_yacht_id_equipment_type_code_key",
          "definition": "CREATE UNIQUE INDEX fault_code_catalog_yacht_id_equipment_type_code_key ON public.search_fault_code_catalog USING btree (yacht_id, equipment_type, code)"
        },
        {
          "name": "idx_fault_catalog_causes",
          "definition": "CREATE INDEX idx_fault_catalog_causes ON public.search_fault_code_catalog USING gin (causes)"
        },
        {
          "name": "idx_fault_catalog_code",
          "definition": "CREATE INDEX idx_fault_catalog_code ON public.search_fault_code_catalog USING btree (yacht_id, code)"
        },
        {
          "name": "idx_fault_catalog_equipment",
          "definition": "CREATE INDEX idx_fault_catalog_equipment ON public.search_fault_code_catalog USING btree (yacht_id, equipment_type)"
        },
        {
          "name": "idx_fault_catalog_manufacturer",
          "definition": "CREATE INDEX idx_fault_catalog_manufacturer ON public.search_fault_code_catalog USING btree (yacht_id, manufacturer) WHERE (manufacturer IS NOT NULL)"
        },
        {
          "name": "idx_fault_catalog_parts",
          "definition": "CREATE INDEX idx_fault_catalog_parts ON public.search_fault_code_catalog USING gin (related_parts)"
        },
        {
          "name": "idx_fault_catalog_severity",
          "definition": "CREATE INDEX idx_fault_catalog_severity ON public.search_fault_code_catalog USING btree (yacht_id, severity)"
        },
        {
          "name": "idx_fault_catalog_symptoms",
          "definition": "CREATE INDEX idx_fault_catalog_symptoms ON public.search_fault_code_catalog USING gin (symptoms)"
        },
        {
          "name": "idx_fault_catalog_yacht",
          "definition": "CREATE INDEX idx_fault_catalog_yacht ON public.search_fault_code_catalog USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role can manage fault codes",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Service role full access fault_code_catalog",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 34
    },
    "search_graph_edges": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "from_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "to_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "edge_type",
          "type": "USER-DEFINED",
          "udt_name": "graph_edge_type",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_chunk_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "properties",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "real",
          "udt_name": "float4",
          "nullable": false,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "graph_edges_from_node_id_fkey",
            "column": "from_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "graph_edges_source_chunk_id_fkey",
            "column": "source_chunk_id",
            "references_table": "search_document_chunks",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "graph_edges_source_document_id_fkey",
            "column": "source_document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "graph_edges_to_node_id_fkey",
            "column": "to_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "graph_edges_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "graph_edges_unique",
            "columns": [
              "yacht_id",
              "from_node_id",
              "to_node_id",
              "edge_type"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_24708_10_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_24708_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_24708_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_24708_3_not_null",
            "clause": "from_node_id IS NOT NULL"
          },
          {
            "name": "2200_24708_4_not_null",
            "clause": "to_node_id IS NOT NULL"
          },
          {
            "name": "2200_24708_5_not_null",
            "clause": "edge_type IS NOT NULL"
          },
          {
            "name": "2200_24708_9_not_null",
            "clause": "confidence IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "graph_edges_pkey",
          "definition": "CREATE UNIQUE INDEX graph_edges_pkey ON public.search_graph_edges USING btree (id)"
        },
        {
          "name": "graph_edges_unique",
          "definition": "CREATE UNIQUE INDEX graph_edges_unique ON public.search_graph_edges USING btree (yacht_id, from_node_id, to_node_id, edge_type)"
        },
        {
          "name": "idx_graph_edges_from",
          "definition": "CREATE INDEX idx_graph_edges_from ON public.search_graph_edges USING btree (from_node_id)"
        },
        {
          "name": "idx_graph_edges_from_type",
          "definition": "CREATE INDEX idx_graph_edges_from_type ON public.search_graph_edges USING btree (from_node_id, edge_type)"
        },
        {
          "name": "idx_graph_edges_properties",
          "definition": "CREATE INDEX idx_graph_edges_properties ON public.search_graph_edges USING gin (properties jsonb_path_ops)"
        },
        {
          "name": "idx_graph_edges_source_chunk",
          "definition": "CREATE INDEX idx_graph_edges_source_chunk ON public.search_graph_edges USING btree (source_chunk_id) WHERE (source_chunk_id IS NOT NULL)"
        },
        {
          "name": "idx_graph_edges_to",
          "definition": "CREATE INDEX idx_graph_edges_to ON public.search_graph_edges USING btree (to_node_id)"
        },
        {
          "name": "idx_graph_edges_to_type",
          "definition": "CREATE INDEX idx_graph_edges_to_type ON public.search_graph_edges USING btree (to_node_id, edge_type)"
        },
        {
          "name": "idx_graph_edges_type",
          "definition": "CREATE INDEX idx_graph_edges_type ON public.search_graph_edges USING btree (yacht_id, edge_type)"
        },
        {
          "name": "idx_graph_edges_yacht",
          "definition": "CREATE INDEX idx_graph_edges_yacht ON public.search_graph_edges USING btree (yacht_id)"
        },
        {
          "name": "idx_graph_edges_yacht_type",
          "definition": "CREATE INDEX idx_graph_edges_yacht_type ON public.search_graph_edges USING btree (yacht_id, edge_type)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access graph_edges",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can manage graph edges",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Users can view yacht graph edges",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 68
    },
    "search_graph_nodes": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "node_type",
          "type": "USER-DEFINED",
          "udt_name": "graph_node_type",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "normalized_label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_chunk_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "properties",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "real",
          "udt_name": "float4",
          "nullable": false,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extraction_source",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "graph_nodes_source_chunk_id_fkey",
            "column": "source_chunk_id",
            "references_table": "search_document_chunks",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "graph_nodes_source_document_id_fkey",
            "column": "source_document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "graph_nodes_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "graph_nodes_unique",
            "columns": [
              "yacht_id",
              "node_type",
              "normalized_label"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_24672_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_24672_12_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_24672_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_24672_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_24672_3_not_null",
            "clause": "node_type IS NOT NULL"
          },
          {
            "name": "2200_24672_4_not_null",
            "clause": "label IS NOT NULL"
          },
          {
            "name": "2200_24672_5_not_null",
            "clause": "normalized_label IS NOT NULL"
          },
          {
            "name": "2200_24672_9_not_null",
            "clause": "confidence IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "graph_nodes_pkey",
          "definition": "CREATE UNIQUE INDEX graph_nodes_pkey ON public.search_graph_nodes USING btree (id)"
        },
        {
          "name": "graph_nodes_unique",
          "definition": "CREATE UNIQUE INDEX graph_nodes_unique ON public.search_graph_nodes USING btree (yacht_id, node_type, normalized_label)"
        },
        {
          "name": "idx_graph_nodes_confidence",
          "definition": "CREATE INDEX idx_graph_nodes_confidence ON public.search_graph_nodes USING btree (yacht_id, confidence DESC)"
        },
        {
          "name": "idx_graph_nodes_embedding",
          "definition": "CREATE INDEX idx_graph_nodes_embedding ON public.search_graph_nodes USING ivfflat (embedding vector_cosine_ops) WITH (lists='100')"
        },
        {
          "name": "idx_graph_nodes_label",
          "definition": "CREATE INDEX idx_graph_nodes_label ON public.search_graph_nodes USING btree (yacht_id, normalized_label)"
        },
        {
          "name": "idx_graph_nodes_properties",
          "definition": "CREATE INDEX idx_graph_nodes_properties ON public.search_graph_nodes USING gin (properties)"
        },
        {
          "name": "idx_graph_nodes_source_chunk",
          "definition": "CREATE INDEX idx_graph_nodes_source_chunk ON public.search_graph_nodes USING btree (source_chunk_id) WHERE (source_chunk_id IS NOT NULL)"
        },
        {
          "name": "idx_graph_nodes_source_doc",
          "definition": "CREATE INDEX idx_graph_nodes_source_doc ON public.search_graph_nodes USING btree (source_document_id) WHERE (source_document_id IS NOT NULL)"
        },
        {
          "name": "idx_graph_nodes_type",
          "definition": "CREATE INDEX idx_graph_nodes_type ON public.search_graph_nodes USING btree (yacht_id, node_type)"
        },
        {
          "name": "idx_graph_nodes_yacht",
          "definition": "CREATE INDEX idx_graph_nodes_yacht ON public.search_graph_nodes USING btree (yacht_id)"
        },
        {
          "name": "idx_graph_nodes_yacht_label",
          "definition": "CREATE INDEX idx_graph_nodes_yacht_label ON public.search_graph_nodes USING btree (yacht_id, normalized_label)"
        },
        {
          "name": "idx_graph_nodes_yacht_type",
          "definition": "CREATE INDEX idx_graph_nodes_yacht_type ON public.search_graph_nodes USING btree (yacht_id, node_type)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access graph_nodes",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can manage graph nodes",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Users can view yacht graph nodes",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "trigger_normalize_graph_node",
          "event": "INSERT",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION normalize_graph_node_label()"
        },
        {
          "name": "trigger_normalize_graph_node",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION normalize_graph_node_label()"
        }
      ],
      "row_count": 109
    },
    "search_maintenance_facts": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action",
          "type": "USER-DEFINED",
          "udt_name": "maintenance_action_type",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "interval_hours",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "interval_days",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "interval_description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_chunk_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "real",
          "udt_name": "float4",
          "nullable": false,
          "default": "1.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "properties",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "maintenance_facts_equipment_node_id_fkey",
            "column": "equipment_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "maintenance_facts_part_node_id_fkey",
            "column": "part_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "maintenance_facts_source_chunk_id_fkey",
            "column": "source_chunk_id",
            "references_table": "search_document_chunks",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "maintenance_facts_source_document_id_fkey",
            "column": "source_document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "maintenance_facts_system_node_id_fkey",
            "column": "system_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "maintenance_facts_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_24752_12_not_null",
            "clause": "confidence IS NOT NULL"
          },
          {
            "name": "2200_24752_14_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_24752_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_24752_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_24752_6_not_null",
            "clause": "action IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_maintenance_facts_action",
          "definition": "CREATE INDEX idx_maintenance_facts_action ON public.search_maintenance_facts USING btree (yacht_id, action)"
        },
        {
          "name": "idx_maintenance_facts_equipment",
          "definition": "CREATE INDEX idx_maintenance_facts_equipment ON public.search_maintenance_facts USING btree (equipment_node_id)"
        },
        {
          "name": "idx_maintenance_facts_interval",
          "definition": "CREATE INDEX idx_maintenance_facts_interval ON public.search_maintenance_facts USING btree (yacht_id, interval_hours) WHERE (interval_hours IS NOT NULL)"
        },
        {
          "name": "idx_maintenance_facts_part",
          "definition": "CREATE INDEX idx_maintenance_facts_part ON public.search_maintenance_facts USING btree (part_node_id) WHERE (part_node_id IS NOT NULL)"
        },
        {
          "name": "idx_maintenance_facts_system",
          "definition": "CREATE INDEX idx_maintenance_facts_system ON public.search_maintenance_facts USING btree (system_node_id) WHERE (system_node_id IS NOT NULL)"
        },
        {
          "name": "idx_maintenance_facts_yacht",
          "definition": "CREATE INDEX idx_maintenance_facts_yacht ON public.search_maintenance_facts USING btree (yacht_id)"
        },
        {
          "name": "maintenance_facts_pkey",
          "definition": "CREATE UNIQUE INDEX maintenance_facts_pkey ON public.search_maintenance_facts USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access maintenance_facts",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can manage maintenance facts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Users can view yacht maintenance facts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 4
    },
    "search_manual_embeddings": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "file_name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "file_size",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chunk_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "chunk_index",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "embedding",
          "type": "USER-DEFINED",
          "udt_name": "vector",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_28080_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_28080_3_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_28080_5_not_null",
            "clause": "file_name IS NOT NULL"
          },
          {
            "name": "2200_28080_7_not_null",
            "clause": "chunk_text IS NOT NULL"
          },
          {
            "name": "2200_28080_8_not_null",
            "clause": "chunk_index IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "manual_embeddings_pkey",
          "definition": "CREATE UNIQUE INDEX manual_embeddings_pkey ON public.search_manual_embeddings USING btree (id)"
        },
        {
          "name": "manual_embeddings_user_id_idx",
          "definition": "CREATE INDEX manual_embeddings_user_id_idx ON public.search_manual_embeddings USING btree (user_id)"
        },
        {
          "name": "manual_embeddings_vector_idx",
          "definition": "CREATE INDEX manual_embeddings_vector_idx ON public.search_manual_embeddings USING ivfflat (embedding vector_cosine_ops) WITH (lists='100')"
        },
        {
          "name": "manual_embeddings_yacht_idx",
          "definition": "CREATE INDEX manual_embeddings_yacht_idx ON public.search_manual_embeddings USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role has full access to manual_embeddings",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
            "with_check": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)"
          },
          {
            "name": "Users can insert manual embeddings",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(auth.uid() = user_id)"
          },
          {
            "name": "Users can view their yacht's manual embeddings",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "search_ocred_pages": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "page_number",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "raw_text",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confidence",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "ocred_pages_document_id_fkey",
            "column": "document_id",
            "references_table": "doc_metadata",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "ocred_pages_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18498_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18498_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18498_3_not_null",
            "clause": "document_id IS NOT NULL"
          },
          {
            "name": "2200_18498_4_not_null",
            "clause": "page_number IS NOT NULL"
          },
          {
            "name": "2200_18498_8_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_ocred_pages_document_id",
          "definition": "CREATE INDEX idx_ocred_pages_document_id ON public.search_ocred_pages USING btree (document_id)"
        },
        {
          "name": "idx_ocred_pages_yacht_id",
          "definition": "CREATE INDEX idx_ocred_pages_yacht_id ON public.search_ocred_pages USING btree (yacht_id)"
        },
        {
          "name": "ocred_pages_pkey",
          "definition": "CREATE UNIQUE INDEX ocred_pages_pkey ON public.search_ocred_pages USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access ocred_pages",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can manage ocred pages",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "search_query_logs": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "query_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "interpreted_intent",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entities",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "latency_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "success",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "search_queries_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_18029_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_18029_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_18029_4_not_null",
            "clause": "query_text IS NOT NULL"
          },
          {
            "name": "2200_18029_9_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_search_queries_created_at",
          "definition": "CREATE INDEX idx_search_queries_created_at ON public.search_query_logs USING btree (created_at)"
        },
        {
          "name": "idx_search_queries_date",
          "definition": "CREATE INDEX idx_search_queries_date ON public.search_query_logs USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "idx_search_queries_entities",
          "definition": "CREATE INDEX idx_search_queries_entities ON public.search_query_logs USING gin (entities jsonb_path_ops)"
        },
        {
          "name": "idx_search_queries_intent",
          "definition": "CREATE INDEX idx_search_queries_intent ON public.search_query_logs USING btree (interpreted_intent)"
        },
        {
          "name": "idx_search_queries_success",
          "definition": "CREATE INDEX idx_search_queries_success ON public.search_query_logs USING btree (yacht_id, success)"
        },
        {
          "name": "idx_search_queries_user_id",
          "definition": "CREATE INDEX idx_search_queries_user_id ON public.search_query_logs USING btree (user_id)"
        },
        {
          "name": "idx_search_queries_yacht",
          "definition": "CREATE INDEX idx_search_queries_yacht ON public.search_query_logs USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "idx_search_queries_yacht_id",
          "definition": "CREATE INDEX idx_search_queries_yacht_id ON public.search_query_logs USING btree (yacht_id)"
        },
        {
          "name": "search_queries_pkey",
          "definition": "CREATE UNIQUE INDEX search_queries_pkey ON public.search_query_logs USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access search_queries",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "System can manage search queries",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Users can insert search queries",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Users can view own search queries",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Users can view yacht search queries",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "search_sessions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "raw_query",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "normalized_query",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "detected_intent",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "intent_confidence",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": "0.0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "extracted_entities",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "query_context",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "result_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "result_types",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "interpretation_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "search_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "total_ms",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "clicked_results",
          "type": "ARRAY",
          "udt_name": "_uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "microactions_shown",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "microactions_executed",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "was_helpful",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "feedback_text",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'search_bar'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "parent_session_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "completed_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_135757_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135757_22_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135757_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_135757_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_135757_4_not_null",
            "clause": "raw_query IS NOT NULL"
          },
          {
            "name": "valid_intent",
            "clause": "(detected_intent = ANY (ARRAY['information'::text, 'diagnostic'::text, 'action'::text, 'recall'::text, 'summary'::text, 'comparison'::text, 'navigation'::text, 'handover'::text, 'unknown'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_search_sessions_created",
          "definition": "CREATE INDEX idx_search_sessions_created ON public.search_sessions USING btree (created_at DESC)"
        },
        {
          "name": "idx_search_sessions_intent",
          "definition": "CREATE INDEX idx_search_sessions_intent ON public.search_sessions USING btree (detected_intent)"
        },
        {
          "name": "idx_search_sessions_query",
          "definition": "CREATE INDEX idx_search_sessions_query ON public.search_sessions USING gin (to_tsvector('english'::regconfig, raw_query))"
        },
        {
          "name": "idx_search_sessions_user",
          "definition": "CREATE INDEX idx_search_sessions_user ON public.search_sessions USING btree (user_id)"
        },
        {
          "name": "idx_search_sessions_yacht",
          "definition": "CREATE INDEX idx_search_sessions_yacht ON public.search_sessions USING btree (yacht_id)"
        },
        {
          "name": "search_sessions_pkey",
          "definition": "CREATE UNIQUE INDEX search_sessions_pkey ON public.search_sessions USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "search_sessions_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(user_id = auth.uid())"
          },
          {
            "name": "search_sessions_own",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(user_id = auth.uid())",
            "with_check": null
          },
          {
            "name": "search_sessions_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "search_suggestion_analytics": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "query_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "intent",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "search_query_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "situation_detected",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "situation_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "situation_severity",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "situation_context",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggested_actions",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "evidence_provided",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_action_taken",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_action_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "suggestion_log_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_30110_11_not_null",
            "clause": "suggested_actions IS NOT NULL"
          },
          {
            "name": "2200_30110_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_30110_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_30110_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_30110_4_not_null",
            "clause": "query_text IS NOT NULL"
          },
          {
            "name": "2200_30110_7_not_null",
            "clause": "situation_detected IS NOT NULL"
          },
          {
            "name": "suggestion_log_severity_check",
            "clause": "((situation_severity IS NULL) OR (situation_severity = ANY (ARRAY['low'::text, 'medium'::text, 'high'::text])))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_suggestion_log_learning",
          "definition": "CREATE INDEX idx_suggestion_log_learning ON public.search_suggestion_analytics USING btree (situation_type, user_action_taken) WHERE (situation_detected = true)"
        },
        {
          "name": "idx_suggestion_log_situation",
          "definition": "CREATE INDEX idx_suggestion_log_situation ON public.search_suggestion_analytics USING btree (yacht_id, situation_type) WHERE (situation_detected = true)"
        },
        {
          "name": "idx_suggestion_log_yacht",
          "definition": "CREATE INDEX idx_suggestion_log_yacht ON public.search_suggestion_analytics USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "suggestion_log_pkey",
          "definition": "CREATE UNIQUE INDEX suggestion_log_pkey ON public.search_suggestion_analytics USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Users can view yacht suggestion log",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "search_suggestions": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggestion_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "category",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "expires_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_31715_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_31715_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_31715_4_not_null",
            "clause": "suggestion_text IS NOT NULL"
          },
          {
            "name": "2200_31715_5_not_null",
            "clause": "priority IS NOT NULL"
          },
          {
            "name": "2200_31715_6_not_null",
            "clause": "category IS NOT NULL"
          },
          {
            "name": "2200_31715_9_not_null",
            "clause": "created_at IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_search_suggestions_expires",
          "definition": "CREATE INDEX idx_search_suggestions_expires ON public.search_suggestions USING btree (expires_at) WHERE (expires_at IS NOT NULL)"
        },
        {
          "name": "idx_search_suggestions_priority",
          "definition": "CREATE INDEX idx_search_suggestions_priority ON public.search_suggestions USING btree (priority DESC)"
        },
        {
          "name": "idx_search_suggestions_yacht",
          "definition": "CREATE INDEX idx_search_suggestions_yacht ON public.search_suggestions USING btree (yacht_id)"
        },
        {
          "name": "idx_search_suggestions_yacht_priority",
          "definition": "CREATE INDEX idx_search_suggestions_yacht_priority ON public.search_suggestions USING btree (yacht_id, priority DESC, created_at DESC)"
        },
        {
          "name": "search_suggestions_pkey",
          "definition": "CREATE UNIQUE INDEX search_suggestions_pkey ON public.search_suggestions USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": []
      },
      "triggers": [],
      "row_count": 0
    },
    "search_symptom_catalog": {
      "columns": [
        {
          "name": "code",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "system_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "severity",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "code"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_23938_1_not_null",
            "clause": "code IS NOT NULL"
          },
          {
            "name": "2200_23938_2_not_null",
            "clause": "label IS NOT NULL"
          },
          {
            "name": "2200_23938_6_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "symptom_catalog_severity_check",
            "clause": "((severity >= 1) AND (severity <= 5))"
          }
        ]
      },
      "indexes": [
        {
          "name": "symptom_catalog_pkey",
          "definition": "CREATE UNIQUE INDEX symptom_catalog_pkey ON public.search_symptom_catalog USING btree (code)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access symptom_catalog",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 50
    },
    "search_symptom_reports": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_node_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptom_code",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptom_label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'search'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolution_status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'open'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolution_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "reported_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "symptom_reports_equipment_node_id_fkey",
            "column": "equipment_node_id",
            "references_table": "search_graph_nodes",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          },
          {
            "constraint_name": "symptom_reports_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_30074_13_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_30074_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_30074_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_30074_4_not_null",
            "clause": "equipment_label IS NOT NULL"
          },
          {
            "name": "2200_30074_5_not_null",
            "clause": "symptom_code IS NOT NULL"
          },
          {
            "name": "2200_30074_6_not_null",
            "clause": "symptom_label IS NOT NULL"
          },
          {
            "name": "2200_30074_7_not_null",
            "clause": "source_type IS NOT NULL"
          },
          {
            "name": "2200_30074_9_not_null",
            "clause": "resolution_status IS NOT NULL"
          },
          {
            "name": "symptom_reports_source_check",
            "clause": "(source_type = ANY (ARRAY['search'::text, 'manual'::text, 'alarm'::text]))"
          },
          {
            "name": "symptom_reports_status_check",
            "clause": "(resolution_status = ANY (ARRAY['open'::text, 'acknowledged'::text, 'work_order_created'::text, 'resolved'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_symptom_reports_open",
          "definition": "CREATE INDEX idx_symptom_reports_open ON public.search_symptom_reports USING btree (yacht_id, resolution_status) WHERE (resolution_status = 'open'::text)"
        },
        {
          "name": "idx_symptom_reports_pattern",
          "definition": "CREATE INDEX idx_symptom_reports_pattern ON public.search_symptom_reports USING btree (yacht_id, equipment_label, symptom_code, created_at DESC)"
        },
        {
          "name": "idx_symptom_reports_yacht_equip",
          "definition": "CREATE INDEX idx_symptom_reports_yacht_equip ON public.search_symptom_reports USING btree (yacht_id, equipment_label, created_at DESC)"
        },
        {
          "name": "idx_symptom_reports_yacht_symptom",
          "definition": "CREATE INDEX idx_symptom_reports_yacht_symptom ON public.search_symptom_reports USING btree (yacht_id, symptom_code, created_at DESC)"
        },
        {
          "name": "symptom_reports_pkey",
          "definition": "CREATE UNIQUE INDEX symptom_reports_pkey ON public.search_symptom_reports USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role full access",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Users can create symptom reports",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(yacht_id = get_user_yacht_id())"
          },
          {
            "name": "Users can update symptom reports",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Users can view yacht symptom reports",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "shopping_list_items": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "part_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "quantity_requested",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "1",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "priority",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'normal'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requested_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "requested_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'pending'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "purchase_order_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deleted_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "deletion_reason",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "shopping_list_items_part_id_fkey",
            "column": "part_id",
            "references_table": "pms_parts",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          },
          {
            "constraint_name": "shopping_list_items_purchase_order_id_fkey",
            "column": "purchase_order_id",
            "references_table": "pms_purchase_orders",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "SET NULL"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_147726_11_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_147726_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_147726_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_147726_3_not_null",
            "clause": "part_id IS NOT NULL"
          },
          {
            "name": "2200_147726_4_not_null",
            "clause": "quantity_requested IS NOT NULL"
          },
          {
            "name": "2200_147726_7_not_null",
            "clause": "requested_by IS NOT NULL"
          },
          {
            "name": "2200_147726_8_not_null",
            "clause": "requested_at IS NOT NULL"
          },
          {
            "name": "shopping_list_items_priority_check",
            "clause": "(priority = ANY (ARRAY['low'::text, 'normal'::text, 'high'::text, 'urgent'::text]))"
          },
          {
            "name": "shopping_list_items_quantity_requested_check",
            "clause": "(quantity_requested > 0)"
          },
          {
            "name": "shopping_list_items_status_check",
            "clause": "(status = ANY (ARRAY['pending'::text, 'ordered'::text, 'cancelled'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_shopping_list_items_part",
          "definition": "CREATE INDEX idx_shopping_list_items_part ON public.shopping_list_items USING btree (part_id)"
        },
        {
          "name": "idx_shopping_list_items_yacht_status",
          "definition": "CREATE INDEX idx_shopping_list_items_yacht_status ON public.shopping_list_items USING btree (yacht_id, status) WHERE (deleted_at IS NULL)"
        },
        {
          "name": "shopping_list_items_pkey",
          "definition": "CREATE UNIQUE INDEX shopping_list_items_pkey ON public.shopping_list_items USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Authenticated users can view shopping list",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(deleted_at IS NULL)",
            "with_check": null
          },
          {
            "name": "Service role full access",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "situation_detections": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "situation_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "severity",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "context",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "evidence",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "recommendations",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "search_query_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "acknowledged",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "acknowledged_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "acknowledged_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_137328_14_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_137328_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_137328_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_137328_4_not_null",
            "clause": "situation_type IS NOT NULL"
          },
          {
            "name": "2200_137328_5_not_null",
            "clause": "severity IS NOT NULL"
          },
          {
            "name": "2200_137328_6_not_null",
            "clause": "label IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_situation_detections_yacht",
          "definition": "CREATE INDEX idx_situation_detections_yacht ON public.situation_detections USING btree (yacht_id, created_at DESC)"
        },
        {
          "name": "situation_detections_pkey",
          "definition": "CREATE UNIQUE INDEX situation_detections_pkey ON public.situation_detections USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "vessel_isolation_situation_detections",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "suggestion_log": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "query_text",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "intent",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "search_query_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "situation_detected",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "situation_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "suggested_actions",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_taken",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_taken_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "feedback",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_137338_13_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_137338_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_137338_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_137338_4_not_null",
            "clause": "query_text IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "suggestion_log_pkey1",
          "definition": "CREATE UNIQUE INDEX suggestion_log_pkey1 ON public.suggestion_log USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "vessel_isolation_suggestion_log",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "symptom_reports": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptom_code",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptom_label",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "search_query_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "reported_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "source",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'manual'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_137317_12_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_137317_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_137317_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_137317_3_not_null",
            "clause": "equipment_label IS NOT NULL"
          },
          {
            "name": "2200_137317_4_not_null",
            "clause": "symptom_code IS NOT NULL"
          },
          {
            "name": "2200_137317_5_not_null",
            "clause": "symptom_label IS NOT NULL"
          },
          {
            "name": "2200_137317_8_not_null",
            "clause": "source IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_symptom_reports_recurrence",
          "definition": "CREATE INDEX idx_symptom_reports_recurrence ON public.symptom_reports USING btree (yacht_id, equipment_label, symptom_code, created_at DESC)"
        },
        {
          "name": "idx_symptom_reports_yacht",
          "definition": "CREATE INDEX idx_symptom_reports_yacht ON public.symptom_reports USING btree (yacht_id, equipment_label, symptom_code)"
        },
        {
          "name": "symptom_reports_pkey1",
          "definition": "CREATE UNIQUE INDEX symptom_reports_pkey1 ON public.symptom_reports USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "vessel_isolation_symptom_reports",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "user_action_history": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_description",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "entity_display_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_date",
          "type": "date",
          "udt_name": "date",
          "nullable": false,
          "default": "CURRENT_DATE",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "action_hour",
          "type": "integer",
          "udt_name": "int4",
          "nullable": false,
          "default": "EXTRACT(hour FROM now())",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "was_via_search",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "search_query",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "confirmation_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "ledger_event_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_135840_10_not_null",
            "clause": "action_hour IS NOT NULL"
          },
          {
            "name": "2200_135840_15_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_135840_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_135840_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_135840_3_not_null",
            "clause": "user_id IS NOT NULL"
          },
          {
            "name": "2200_135840_4_not_null",
            "clause": "action_type IS NOT NULL"
          },
          {
            "name": "2200_135840_5_not_null",
            "clause": "action_description IS NOT NULL"
          },
          {
            "name": "2200_135840_6_not_null",
            "clause": "entity_type IS NOT NULL"
          },
          {
            "name": "2200_135840_7_not_null",
            "clause": "entity_id IS NOT NULL"
          },
          {
            "name": "2200_135840_9_not_null",
            "clause": "action_date IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_user_action_history_entity",
          "definition": "CREATE INDEX idx_user_action_history_entity ON public.user_action_history USING btree (entity_type, entity_id)"
        },
        {
          "name": "idx_user_action_history_user_date",
          "definition": "CREATE INDEX idx_user_action_history_user_date ON public.user_action_history USING btree (user_id, action_date DESC)"
        },
        {
          "name": "idx_user_action_history_user_type",
          "definition": "CREATE INDEX idx_user_action_history_user_type ON public.user_action_history USING btree (user_id, action_type)"
        },
        {
          "name": "user_action_history_pkey",
          "definition": "CREATE UNIQUE INDEX user_action_history_pkey ON public.user_action_history USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "user_action_history_insert",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(user_id = auth.uid())"
          },
          {
            "name": "user_action_history_own",
            "permissive": "PERMISSIVE",
            "roles": [
              "authenticated"
            ],
            "command": "SELECT",
            "using": "(user_id = auth.uid())",
            "with_check": null
          },
          {
            "name": "user_action_history_service",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "user_added_relations": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_by_user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "from_artefact_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "from_artefact_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "to_artefact_type",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "to_artefact_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": false,
          "default": "true",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "user_added_relations_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [
          {
            "name": "unique_active_user_relation",
            "columns": [
              "yacht_id",
              "from_artefact_type",
              "from_artefact_id",
              "to_artefact_type",
              "to_artefact_id"
            ]
          }
        ],
        "check": [
          {
            "name": "2200_140204_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_140204_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_140204_3_not_null",
            "clause": "created_by_user_id IS NOT NULL"
          },
          {
            "name": "2200_140204_4_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_140204_5_not_null",
            "clause": "from_artefact_type IS NOT NULL"
          },
          {
            "name": "2200_140204_6_not_null",
            "clause": "from_artefact_id IS NOT NULL"
          },
          {
            "name": "2200_140204_7_not_null",
            "clause": "to_artefact_type IS NOT NULL"
          },
          {
            "name": "2200_140204_8_not_null",
            "clause": "to_artefact_id IS NOT NULL"
          },
          {
            "name": "2200_140204_9_not_null",
            "clause": "is_active IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_user_relations_from",
          "definition": "CREATE INDEX idx_user_relations_from ON public.user_added_relations USING btree (yacht_id, from_artefact_type, from_artefact_id) WHERE (is_active = true)"
        },
        {
          "name": "idx_user_relations_to",
          "definition": "CREATE INDEX idx_user_relations_to ON public.user_added_relations USING btree (yacht_id, to_artefact_type, to_artefact_id) WHERE (is_active = true)"
        },
        {
          "name": "unique_active_user_relation",
          "definition": "CREATE UNIQUE INDEX unique_active_user_relation ON public.user_added_relations USING btree (yacht_id, from_artefact_type, from_artefact_id, to_artefact_type, to_artefact_id)"
        },
        {
          "name": "user_added_relations_pkey",
          "definition": "CREATE UNIQUE INDEX user_added_relations_pkey ON public.user_added_relations USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role manages user_added_relations",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": "true"
          },
          {
            "name": "user_relations_insert_own_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "((yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))) AND (created_by_user_id = auth.uid()))"
          },
          {
            "name": "user_relations_select_own_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid())))",
            "with_check": null
          },
          {
            "name": "user_relations_update_own",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "UPDATE",
            "using": "((yacht_id IN ( SELECT auth_users_profiles.yacht_id\n   FROM auth_users_profiles\n  WHERE (auth_users_profiles.id = auth.uid()))) AND (created_by_user_id = auth.uid()))",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "yacht_email_configs": {
      "columns": [
        {
          "name": "contact_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "vendor",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "contact_name",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "email",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "specialization",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "reliability_score",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "last_contacted",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "contact_id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_27715_1_not_null",
            "clause": "contact_id IS NOT NULL"
          },
          {
            "name": "2200_27715_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_27715_5_not_null",
            "clause": "email IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "email_contacts_yacht_pkey",
          "definition": "CREATE UNIQUE INDEX email_contacts_yacht_pkey ON public.yacht_email_configs USING btree (contact_id)"
        },
        {
          "name": "idx_emails_yacht_last_contacted",
          "definition": "CREATE INDEX idx_emails_yacht_last_contacted ON public.yacht_email_configs USING btree (last_contacted DESC)"
        },
        {
          "name": "idx_emails_yacht_reliability_score",
          "definition": "CREATE INDEX idx_emails_yacht_reliability_score ON public.yacht_email_configs USING btree (reliability_score DESC)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Allow backend read emails",
            "permissive": "PERMISSIVE",
            "roles": [
              "anon",
              "authenticated"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role can manage all contacts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(current_setting('role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Service role full access contacts",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role full access emails_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can manage own contacts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          },
          {
            "name": "Users can read own contacts",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "update_email_contacts_yacht_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 0
    },
    "yacht_fault_records": {
      "columns": [
        {
          "name": "fault_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_type",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "equipment_brand",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "equipment_model",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "fault_code",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 50
        },
        {
          "name": "fault_description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "symptoms",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "severity_level",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 20
        },
        {
          "name": "detected_date",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolved_date",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolution_status",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": "'open'::character varying",
          "is_identity": false,
          "max_length": 50
        },
        {
          "name": "resolution_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "technician_notes",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "root_cause",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "preventive_measures",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "downtime_hours",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "repair_cost_usd",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "parts_replaced",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "fault_id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_27732_1_not_null",
            "clause": "fault_id IS NOT NULL"
          },
          {
            "name": "2200_27732_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "fault_yacht_pkey",
          "definition": "CREATE UNIQUE INDEX fault_yacht_pkey ON public.yacht_fault_records USING btree (fault_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Service role can manage all faults",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(current_setting('role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Service role full access fault_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can report faults",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "INSERT",
            "using": null,
            "with_check": "(auth.uid() = user_id)"
          },
          {
            "name": "Users can update own faults",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "UPDATE",
            "using": "(auth.uid() = user_id)",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "update_fault_yacht_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 0
    },
    "yacht_operational_context": {
      "columns": [
        {
          "name": "yacht_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "current_status",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": "'in_port'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "next_event_type",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "next_event_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "next_event_name",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "hot_work_permitted",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "true",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "guests_on_board",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_by",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "yacht_id"
        ],
        "foreign_keys": [
          {
            "constraint_name": "vessel_context_yacht_id_fkey",
            "column": "yacht_id",
            "references_table": "yacht_registry",
            "references_column": "id",
            "on_update": "NO ACTION",
            "on_delete": "CASCADE"
          }
        ],
        "unique": [],
        "check": [
          {
            "name": "2200_30048_1_not_null",
            "clause": "yacht_id IS NOT NULL"
          },
          {
            "name": "2200_30048_2_not_null",
            "clause": "current_status IS NOT NULL"
          },
          {
            "name": "2200_30048_8_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "vessel_context_event_type_check",
            "clause": "((next_event_type IS NULL) OR (next_event_type = ANY (ARRAY['charter'::text, 'survey'::text, 'crossing'::text, 'refit'::text, 'owner_trip'::text])))"
          },
          {
            "name": "vessel_context_status_check",
            "clause": "(current_status = ANY (ARRAY['in_port'::text, 'at_anchor'::text, 'underway'::text, 'in_yard'::text, 'laid_up'::text]))"
          }
        ]
      },
      "indexes": [
        {
          "name": "vessel_context_pkey",
          "definition": "CREATE UNIQUE INDEX vessel_context_pkey ON public.yacht_operational_context USING btree (yacht_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Officers can update yacht context",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "UPDATE",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          },
          {
            "name": "Service role full access",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Users can view own yacht context",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(yacht_id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 0
    },
    "yacht_registry": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "name",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "imo",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "mmsi",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "flag_state",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "length_m",
          "type": "numeric",
          "udt_name": "numeric",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "owner_ref",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_secret_hash",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "nas_root_path",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "status",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": "'active'::text",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": false,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_17921_12_not_null",
            "clause": "created_at IS NOT NULL"
          },
          {
            "name": "2200_17921_13_not_null",
            "clause": "updated_at IS NOT NULL"
          },
          {
            "name": "2200_17921_1_not_null",
            "clause": "id IS NOT NULL"
          },
          {
            "name": "2200_17921_2_not_null",
            "clause": "name IS NOT NULL"
          },
          {
            "name": "2200_17921_8_not_null",
            "clause": "yacht_secret_hash IS NOT NULL"
          },
          {
            "name": "yachts_status_check",
            "clause": "(status = ANY (ARRAY['active'::text, 'inactive'::text, 'demo'::text]))"
          },
          {
            "name": "yachts_yacht_secret_hash_check",
            "clause": "(yacht_secret_hash ~ '^\\$2[aby]\\$'::text)"
          }
        ]
      },
      "indexes": [
        {
          "name": "idx_yachts_status",
          "definition": "CREATE INDEX idx_yachts_status ON public.yacht_registry USING btree (status)"
        },
        {
          "name": "yachts_pkey",
          "definition": "CREATE UNIQUE INDEX yachts_pkey ON public.yacht_registry USING btree (id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Managers can update yacht settings",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "UPDATE",
            "using": "((id = get_user_yacht_id()) AND is_manager())",
            "with_check": null
          },
          {
            "name": "Service role full access yachts",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Users can view own yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "(id = get_user_yacht_id())",
            "with_check": null
          }
        ]
      },
      "triggers": [],
      "row_count": 1
    },
    "yacht_resolution_records": {
      "columns": [
        {
          "name": "resolution_id",
          "type": "uuid",
          "udt_name": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "yacht_id",
          "type": "text",
          "udt_name": "text",
          "nullable": false,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolution_title",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 500
        },
        {
          "name": "resolution_description",
          "type": "text",
          "udt_name": "text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "resolution_steps",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "equipment_type",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "applicable_models",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "success_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "failure_count",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": "0",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "average_time_minutes",
          "type": "integer",
          "udt_name": "int4",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "difficulty_level",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 50
        },
        {
          "name": "required_expertise",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "safety_warnings",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "tools_required",
          "type": "ARRAY",
          "udt_name": "_text",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "parts_required",
          "type": "jsonb",
          "udt_name": "jsonb",
          "nullable": true,
          "default": "'[]'::jsonb",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "estimated_cost_range",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 100
        },
        {
          "name": "created_by",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "approved_by",
          "type": "character varying",
          "udt_name": "varchar",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": 255
        },
        {
          "name": "approval_date",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": null,
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "is_verified",
          "type": "boolean",
          "udt_name": "bool",
          "nullable": true,
          "default": "false",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp with time zone",
          "udt_name": "timestamptz",
          "nullable": true,
          "default": "now()",
          "is_identity": false,
          "max_length": null
        }
      ],
      "constraints": {
        "primary_key": [
          "resolution_id"
        ],
        "foreign_keys": [],
        "unique": [],
        "check": [
          {
            "name": "2200_27767_1_not_null",
            "clause": "resolution_id IS NOT NULL"
          },
          {
            "name": "2200_27767_2_not_null",
            "clause": "yacht_id IS NOT NULL"
          }
        ]
      },
      "indexes": [
        {
          "name": "resolution_yacht_pkey",
          "definition": "CREATE UNIQUE INDEX resolution_yacht_pkey ON public.yacht_resolution_records USING btree (resolution_id)"
        }
      ],
      "rls": {
        "enabled": true,
        "policies": [
          {
            "name": "Public read access to resolutions",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "SELECT",
            "using": "true",
            "with_check": null
          },
          {
            "name": "Service role can manage resolutions",
            "permissive": "PERMISSIVE",
            "roles": [
              "public"
            ],
            "command": "ALL",
            "using": "(current_setting('role'::text) = 'service_role'::text)",
            "with_check": null
          },
          {
            "name": "Service role full access resolution_yacht",
            "permissive": "PERMISSIVE",
            "roles": [
              "service_role"
            ],
            "command": "ALL",
            "using": "true",
            "with_check": null
          }
        ]
      },
      "triggers": [
        {
          "name": "update_resolution_yacht_updated_at",
          "event": "UPDATE",
          "timing": "BEFORE",
          "action": "EXECUTE FUNCTION update_updated_at_column()"
        }
      ],
      "row_count": 0
    }
  }
}