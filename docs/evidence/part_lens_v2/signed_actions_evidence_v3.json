[
  {
    "test": "adjust_stock_quantity: missing signature",
    "passed": true,
    "expected_status": 400,
    "actual_status": 400,
    "response": {
      "detail": "Missing required field(s): signature"
    }
  },
  {
    "test": "adjust_stock_quantity: invalid signature",
    "passed": true,
    "expected_status": 400,
    "actual_status": 400,
    "response": {
      "detail": "Signature must contain 'pin' and 'totp' keys for SIGNED action"
    }
  },
  {
    "test": "adjust_stock_quantity: crew forbidden",
    "passed": true,
    "expected_status": 403,
    "actual_status": 403,
    "response": {
      "detail": "Role 'crew' forbidden: not authorized to perform signed action 'adjust_stock_quantity'"
    }
  },
  {
    "test": "adjust_stock_quantity: HOD (chief_engineer) authorized",
    "passed": true,
    "expected_status": 200,
    "actual_status": 200,
    "response": {
      "status": "success",
      "transaction_id": "bf5093f3-64df-4caf-8931-5265ac98a831",
      "part_id": "8ad67e2f-2579-4d6c-afd2-0dee85f4d8b3",
      "old_quantity": 37,
      "new_quantity": 40,
      "adjustment": 3,
      "reason": "Stocktake correction",
      "is_signed": true,
      "message": "Stock adjusted from 37 to 40",
      "execution_id": "f55482b9-0cda-4c65-86d3-20cd4c9803f1",
      "action": "adjust_stock_quantity"
    }
  },
  {
    "test": "write_off_part: missing signature",
    "passed": true,
    "expected_status": 400,
    "actual_status": 400,
    "response": {
      "detail": "Missing required field(s): signature"
    }
  },
  {
    "test": "write_off_part: invalid signature",
    "passed": true,
    "expected_status": 400,
    "actual_status": 400,
    "response": {
      "detail": "Missing required field(s): signature"
    }
  },
  {
    "test": "write_off_part: crew forbidden",
    "passed": true,
    "expected_status": 403,
    "actual_status": 403,
    "response": {
      "detail": "Role 'crew' forbidden: write_off_part requires Captain/Manager role"
    }
  },
  {
    "test": "write_off_part: HOD forbidden",
    "passed": true,
    "expected_status": 403,
    "actual_status": 403,
    "response": {
      "detail": "Role 'chief_engineer' forbidden: write_off_part requires Captain/Manager role"
    }
  },
  {
    "test": "write_off_part: manager authorized (simulated with HOD JWT)",
    "passed": true,
    "expected_status": 200,
    "actual_status": 200,
    "response": {
      "status": "success",
      "transaction_id": "cd173094-954a-4aa9-99c2-9d0166fed2dd",
      "part_id": "8ad67e2f-2579-4d6c-afd2-0dee85f4d8b3",
      "quantity_written_off": 3,
      "new_stock_level": 87,
      "reason": "Damaged beyond repair",
      "is_signed": true,
      "message": "Wrote off 3 units (Damaged beyond repair)",
      "execution_id": "6a97c96b-aeb8-45b1-bd5b-5d1cbd214b13",
      "action": "write_off_part"
    }
  }
]