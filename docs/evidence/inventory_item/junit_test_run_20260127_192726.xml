<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="0" failures="4" skipped="0" tests="18" time="15.211" timestamp="2026-01-27T19:27:27.238251" hostname="celesteos.local"><testcase classname="tests.test_inventory_critical.TestConcurrency" name="test_concurrent_consume_atomic" time="4.145" /><testcase classname="tests.test_inventory_critical.TestConcurrency" name="test_concurrent_receive_atomic" time="0.274" /><testcase classname="tests.test_inventory_critical.TestIdempotency" name="test_duplicate_receive_blocked" time="0.922" /><testcase classname="tests.test_inventory_critical.TestSoftDelete" name="test_consume_blocked_on_deactivated" time="0.882" /><testcase classname="tests.test_inventory_critical.TestSoftDelete" name="test_trigger_blocks_transaction_insert" time="0.257" /><testcase classname="tests.test_inventory_critical.TestSoftDelete" name="test_reactivate_restores_mutations" time="0.866" /><testcase classname="tests.test_inventory_critical.TestReversalUniqueness" name="test_double_reversal_blocked" time="0.949" /><testcase classname="tests.test_inventory_critical.TestReversalUniqueness" name="test_reversal_of_reversal_blocked" time="0.307" /><testcase classname="tests.test_inventory_critical.TestTransactionTypeRLS" name="test_crew_can_insert_consumed" time="0.867" /><testcase classname="tests.test_inventory_critical.TestTransactionTypeRLS" name="test_crew_cannot_insert_write_off" time="0.895"><failure message="Failed: DID NOT RAISE &lt;class 'Exception'&gt;">tests/test_inventory_critical.py:444: in test_crew_cannot_insert_write_off
    await db.execute("""
E   Failed: DID NOT RAISE &lt;class 'Exception'&gt;</failure></testcase><testcase classname="tests.test_inventory_critical.TestTransactionTypeRLS" name="test_crew_cannot_insert_reversed" time="0.257"><failure message="Failed: DID NOT RAISE &lt;class 'Exception'&gt;">tests/test_inventory_critical.py:459: in test_crew_cannot_insert_reversed
    await db.execute("""
E   Failed: DID NOT RAISE &lt;class 'Exception'&gt;</failure></testcase><testcase classname="tests.test_inventory_critical.TestTransferValidation" name="test_transfer_same_location_blocked" time="0.849"><failure message="asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint &quot;uq_part_locations_yacht_name&quot;&#10;DETAIL:  Key (yacht_id, name)=(85fe1119-b04c-41ac-80f1-829d23322598, Engine Room) already exists.">tests/test_inventory_critical.py:479: in test_transfer_same_location_blocked
    location = await create_test_location(db, yacht_a, "Engine Room")
tests/helpers.py:76: in create_test_location
    await db.execute("""
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:353: in execute
    _, status, _ = await self._execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1794: in _execute
    result, _ = await self.__execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1892: in __execute
    result, stmt = await self._do_execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1945: in _do_execute
    result = await executor(stmt, None)
asyncpg/protocol/protocol.pyx:207: in bind_execute
    ???
E   asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "uq_part_locations_yacht_name"
E   DETAIL:  Key (yacht_id, name)=(85fe1119-b04c-41ac-80f1-829d23322598, Engine Room) already exists.</failure></testcase><testcase classname="tests.test_inventory_critical.TestHelperParity" name="test_is_operational_crew_with_existing_users" time="0.179" /><testcase classname="tests.test_inventory_critical.TestHelperParity" name="test_is_hod_helper_function" time="0.868" /><testcase classname="tests.test_inventory_critical.TestDualLedgerConsistency" name="test_no_inventory_drift" time="1.492" /><testcase classname="tests.test_inventory_critical.TestStorageNegativeControls" name="test_documents_wrong_prefix_denied" time="0.147" /><testcase classname="tests.test_inventory_critical.TestStorageNegativeControls" name="test_labels_wrong_prefix_denied" time="0.127" /><testcase classname="tests.test_inventory_critical.TestStorageNegativeControls" name="test_storage_policies_require_operational_crew" time="0.766"><failure message="asyncpg.exceptions.UndefinedColumnError: column &quot;policyname&quot; does not exist&#10;HINT:  Perhaps you meant to reference the column &quot;p.polname&quot;.">tests/test_inventory_critical.py:635: in test_storage_policies_require_operational_crew
    policies = await db.fetch("""
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:691: in fetch
    return await self._execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1794: in _execute
    result, _ = await self.__execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1892: in __execute
    result, stmt = await self._do_execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1925: in _do_execute
    stmt = await self._get_statement(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:433: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:166: in prepare
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "policyname" does not exist
E   HINT:  Perhaps you meant to reference the column "p.polname".</failure></testcase></testsuite></testsuites>