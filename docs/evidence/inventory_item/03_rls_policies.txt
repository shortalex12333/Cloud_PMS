         tablename          |                     policyname                     | operation |                                               using_expression                                                |                                                                                             check_expression                                                                                             
----------------------------+----------------------------------------------------+-----------+---------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 pms_inventory_transactions | crew_insert_consume                                | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND (transaction_type = 'consumed'::text) AND is_operational_crew(auth.uid(), get_user_yacht_id()))
 pms_inventory_transactions | crew_insert_transactions                           | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['deckhand'::text, 'bosun'::text, 'eto'::text, 'chief_engineer'::text, 'captain'::text, 'manager'::text])))
 pms_inventory_transactions | crew_insert_txn                                    | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['deckhand'::text, 'bosun'::text, 'eto'::text, 'chief_engineer'::text, 'captain'::text, 'manager'::text, 'purser'::text])))
 pms_inventory_transactions | crew_select_own_yacht_transactions                 | SELECT    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_inventory_transactions | crew_select_own_yacht_txn                          | SELECT    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_inventory_transactions | crew_select_transactions                           | SELECT    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_inventory_transactions | engineers_insert_transactions                      | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['chief_engineer'::text, 'eto'::text, 'deck'::text, 'interior'::text, 'manager'::text])))
 pms_inventory_transactions | hod_insert_receive_transfer_adjust                 | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND (transaction_type = ANY (ARRAY['received'::text, 'transferred_out'::text, 'transferred_in'::text, 'adjusted'::text])) AND is_hod(auth.uid(), get_user_yacht_id()))
 pms_inventory_transactions | manager_delete_txn                                 | DELETE    | ((yacht_id = get_user_yacht_id()) AND (get_user_role() = 'manager'::text))                                    | 
 pms_inventory_transactions | manager_insert_writeoff_reversed                   | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND (transaction_type = ANY (ARRAY['write_off'::text, 'reversed'::text])) AND is_manager(auth.uid(), get_user_yacht_id()))
 pms_inventory_transactions | service_role_full_access_inventory_transactions    | ALL       | true                                                                                                          | true
 pms_inventory_transactions | service_role_full_access_transactions              | ALL       | true                                                                                                          | true
 pms_inventory_transactions | service_role_full_access_txn                       | ALL       | true                                                                                                          | true
 pms_inventory_transactions | service_role_transactions                          | ALL       | true                                                                                                          | 
 pms_part_locations         | crew_select_locations                              | SELECT    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_part_locations         | hod_manage_locations                               | ALL       | ((yacht_id = get_user_yacht_id()) AND is_hod(auth.uid(), get_user_yacht_id()))                                | ((yacht_id = get_user_yacht_id()) AND is_hod(auth.uid(), get_user_yacht_id()))
 pms_part_locations         | service_role_locations                             | ALL       | true                                                                                                          | 
 pms_part_usage             | crew_delete_own_yacht_part_usage                   | DELETE    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_part_usage             | crew_insert_own_yacht_part_usage                   | INSERT    |                                                                                                               | (yacht_id = get_user_yacht_id())
 pms_part_usage             | crew_insert_part_usage                             | INSERT    |                                                                                                               | (yacht_id = get_user_yacht_id())
 pms_part_usage             | crew_select_own_yacht_part_usage                   | SELECT    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_part_usage             | crew_select_part_usage                             | SELECT    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_part_usage             | crew_update_own_yacht_part_usage                   | UPDATE    | (yacht_id = get_user_yacht_id())                                                                              | (yacht_id = get_user_yacht_id())
 pms_part_usage             | operational_crew_insert_part_usage                 | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND is_operational_crew(auth.uid(), get_user_yacht_id()))
 pms_part_usage             | service_role_full_access_part_usage                | ALL       | true                                                                                                          | true
 pms_part_usage             | service_role_part_usage                            | ALL       | true                                                                                                          | 
 pms_shopping_list_items    | HOD can update shopping list items                 | UPDATE    | ((yacht_id = get_user_yacht_id()) AND is_hod(auth.uid(), yacht_id))                                           | (yacht_id = get_user_yacht_id())
 pms_shopping_list_items    | Service role has full access to shopping list      | ALL       | true                                                                                                          | true
 pms_shopping_list_items    | Users can create shopping list items               | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND (created_by = auth.uid()) AND (status = 'candidate'::text))
 pms_shopping_list_items    | Users can view shopping list items for their yacht | SELECT    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_shopping_list_items    | crew_insert_shopping                               | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND (get_user_role() = ANY (ARRAY['deckhand'::text, 'bosun'::text, 'eto'::text, 'chief_engineer'::text, 'chief_officer'::text, 'captain'::text, 'manager'::text])))
 pms_shopping_list_items    | crew_select_own_yacht_shopping                     | SELECT    | (yacht_id = get_user_yacht_id())                                                                              | 
 pms_shopping_list_items    | crew_select_shopping                               | SELECT    | ((yacht_id = get_user_yacht_id()) AND ((created_by = auth.uid()) OR is_hod(auth.uid(), get_user_yacht_id()))) | 
 pms_shopping_list_items    | crew_update_shopping                               | UPDATE    | (yacht_id = get_user_yacht_id())                                                                              | (yacht_id = get_user_yacht_id())
 pms_shopping_list_items    | hod_update_shopping                                | UPDATE    | ((yacht_id = get_user_yacht_id()) AND is_hod(auth.uid(), get_user_yacht_id()))                                | 
 pms_shopping_list_items    | operational_crew_insert_shopping                   | INSERT    |                                                                                                               | ((yacht_id = get_user_yacht_id()) AND is_operational_crew(auth.uid(), get_user_yacht_id()))
 pms_shopping_list_items    | service_role_full_access_shopping                  | ALL       | true                                                                                                          | true
 pms_shopping_list_items    | service_role_shopping                              | ALL       | true                                                                                                          | 
(38 rows)

