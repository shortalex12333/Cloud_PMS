<?xml version="1.0" encoding="utf-8"?><testsuites><testsuite name="pytest" errors="1" failures="7" skipped="6" tests="21" time="14.594" timestamp="2026-01-27T19:13:20.656883" hostname="celesteos.local"><testcase classname="tests.test_inventory_critical.TestRLSIsolation" name="test_parts_isolated_by_yacht" time="2.312"><skipped type="pytest.skip" message="TEST_YACHT_B not available in staging - skipping cross-yacht test">/Volumes/Backup/CELESTE/BACK_BUTTON_CLOUD_PMS/tests/inventory_lens/tests/test_inventory_critical.py:45: TEST_YACHT_B not available in staging - skipping cross-yacht test</skipped></testcase><testcase classname="tests.test_inventory_critical.TestRLSIsolation" name="test_stock_isolated_by_yacht" time="0.076"><skipped type="pytest.skip" message="TEST_YACHT_B not available in staging - skipping cross-yacht test">/Volumes/Backup/CELESTE/BACK_BUTTON_CLOUD_PMS/tests/inventory_lens/tests/test_inventory_critical.py:59: TEST_YACHT_B not available in staging - skipping cross-yacht test</skipped></testcase><testcase classname="tests.test_inventory_critical.TestRLSIsolation" name="test_transactions_isolated_by_yacht" time="0.071"><skipped type="pytest.skip" message="TEST_YACHT_B not available in staging - skipping cross-yacht test">/Volumes/Backup/CELESTE/BACK_BUTTON_CLOUD_PMS/tests/inventory_lens/tests/test_inventory_critical.py:73: TEST_YACHT_B not available in staging - skipping cross-yacht test</skipped></testcase><testcase classname="tests.test_inventory_critical.TestRLSIsolation" name="test_locations_isolated_by_yacht" time="0.072"><skipped type="pytest.skip" message="TEST_YACHT_B not available in staging - skipping cross-yacht test">/Volumes/Backup/CELESTE/BACK_BUTTON_CLOUD_PMS/tests/inventory_lens/tests/test_inventory_critical.py:95: TEST_YACHT_B not available in staging - skipping cross-yacht test</skipped></testcase><testcase classname="tests.test_inventory_critical.TestRLSIsolation" name="test_cross_yacht_consume_blocked" time="0.072"><skipped type="pytest.skip" message="TEST_YACHT_B not available in staging - skipping cross-yacht test">/Volumes/Backup/CELESTE/BACK_BUTTON_CLOUD_PMS/tests/inventory_lens/tests/test_inventory_critical.py:110: TEST_YACHT_B not available in staging - skipping cross-yacht test</skipped></testcase><testcase classname="tests.test_inventory_critical.TestConcurrency" name="test_concurrent_consume_atomic" time="1.105"><failure message="AssertionError: Exactly one consume should fail&#10;assert 0 == 1&#10; +  where 0 = len([])">tests/test_inventory_critical.py:161: in test_concurrent_consume_atomic
    assert len(failures) == 1, "Exactly one consume should fail"
E   AssertionError: Exactly one consume should fail
E   assert 0 == 1
E    +  where 0 = len([])</failure></testcase><testcase classname="tests.test_inventory_critical.TestConcurrency" name="test_concurrent_receive_atomic" time="0.734"><failure message="asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress">tests/test_inventory_critical.py:182: in test_concurrent_receive_atomic
    results = await asyncio.gather(receive_10(), receive_10())
tests/test_inventory_critical.py:178: in receive_10
    return await db.fetchrow("""
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:749: in fetchrow
    data = await self._execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1793: in _execute
    with self._stmt_exclusive_section:
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:2531: in __enter__
    raise exceptions.InterfaceError(
E   asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress</failure></testcase><testcase classname="tests.test_inventory_critical.TestConcurrency" name="test_concurrent_receive_atomic" time="0.001"><error message="failed on teardown with &quot;asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress&quot;">/Users/celeste7/Library/Python/3.9/lib/python/site-packages/pytest_asyncio/plugin.py:302: in finalizer
    event_loop.run_until_complete(async_finalizer())
/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/asyncio/base_events.py:642: in run_until_complete
    return future.result()
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/pytest_asyncio/plugin.py:294: in async_finalizer
    await gen_obj.__anext__()
tests/conftest.py:68: in db
    yield conn
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/pool.py:988: in __aexit__
    await self.pool.release(con)
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/pool.py:862: in release
    return await asyncio.shield(ch.release(timeout))
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/pool.py:219: in release
    raise ex
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/pool.py:209: in release
    await self._con.reset(timeout=budget)
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1500: in reset
    await self.execute(reset_query, timeout=timeout)
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:350: in execute
    result = await self._protocol.query(query, timeout)
asyncpg/protocol/protocol.pyx:359: in query
    ???
asyncpg/protocol/protocol.pyx:744: in asyncpg.protocol.protocol.BaseProtocol._check_state
    ???
E   asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress</error></testcase><testcase classname="tests.test_inventory_critical.TestIdempotency" name="test_duplicate_receive_blocked" time="1.956" /><testcase classname="tests.test_inventory_critical.TestIdempotency" name="test_idempotency_key_scoped_to_yacht" time="0.065"><skipped type="pytest.skip" message="TEST_YACHT_B not available in staging - skipping cross-yacht test">/Volumes/Backup/CELESTE/BACK_BUTTON_CLOUD_PMS/tests/inventory_lens/tests/test_inventory_critical.py:227: TEST_YACHT_B not available in staging - skipping cross-yacht test</skipped></testcase><testcase classname="tests.test_inventory_critical.TestSoftDelete" name="test_consume_blocked_on_deactivated" time="0.262" /><testcase classname="tests.test_inventory_critical.TestSoftDelete" name="test_trigger_blocks_transaction_insert" time="0.865" /><testcase classname="tests.test_inventory_critical.TestSoftDelete" name="test_reactivate_restores_mutations" time="0.894" /><testcase classname="tests.test_inventory_critical.TestReversalUniqueness" name="test_double_reversal_blocked" time="0.348" /><testcase classname="tests.test_inventory_critical.TestReversalUniqueness" name="test_reversal_of_reversal_blocked" time="1.411" /><testcase classname="tests.test_inventory_critical.TestTransactionTypeRLS" name="test_crew_can_insert_consumed" time="0.856"><failure message="asyncpg.exceptions.PostgresSyntaxError: syntax error at or near &quot;$1&quot;">tests/test_inventory_critical.py:417: in test_crew_can_insert_consumed
    await set_user_context(db, deckhand_a)
tests/helpers.py:85: in set_user_context
    await db.execute("""
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:353: in execute
    _, status, _ = await self._execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1794: in _execute
    result, _ = await self.__execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1892: in __execute
    result, stmt = await self._do_execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1925: in _do_execute
    stmt = await self._get_statement(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:433: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:166: in prepare
    ???
E   asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"</failure></testcase><testcase classname="tests.test_inventory_critical.TestTransactionTypeRLS" name="test_crew_cannot_insert_write_off" time="0.197"><failure message="asyncpg.exceptions.PostgresSyntaxError: syntax error at or near &quot;$1&quot;">tests/test_inventory_critical.py:432: in test_crew_cannot_insert_write_off
    await set_user_context(db, deckhand_a)
tests/helpers.py:85: in set_user_context
    await db.execute("""
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:353: in execute
    _, status, _ = await self._execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1794: in _execute
    result, _ = await self.__execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1892: in __execute
    result, stmt = await self._do_execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1925: in _do_execute
    stmt = await self._get_statement(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:433: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:166: in prepare
    ???
E   asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"</failure></testcase><testcase classname="tests.test_inventory_critical.TestTransactionTypeRLS" name="test_crew_cannot_insert_reversed" time="0.808"><failure message="asyncpg.exceptions.PostgresSyntaxError: syntax error at or near &quot;$1&quot;">tests/test_inventory_critical.py:448: in test_crew_cannot_insert_reversed
    await set_user_context(db, deckhand_a)
tests/helpers.py:85: in set_user_context
    await db.execute("""
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:353: in execute
    _, status, _ = await self._execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1794: in _execute
    result, _ = await self.__execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1892: in __execute
    result, stmt = await self._do_execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1925: in _do_execute
    stmt = await self._get_statement(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:433: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:166: in prepare
    ???
E   asyncpg.exceptions.PostgresSyntaxError: syntax error at or near "$1"</failure></testcase><testcase classname="tests.test_inventory_critical.TestTransferValidation" name="test_transfer_same_location_blocked" time="0.235" /><testcase classname="tests.test_inventory_critical.TestHelperParity" name="test_is_operational_crew_includes_all_roles" time="0.766"><failure message="asyncpg.exceptions.UndefinedColumnError: column &quot;full_name&quot; of relation &quot;auth_users_profiles&quot; does not exist">tests/test_inventory_critical.py:503: in test_is_operational_crew_includes_all_roles
    await db.execute("""
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:353: in execute
    _, status, _ = await self._execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1794: in _execute
    result, _ = await self.__execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1892: in __execute
    result, stmt = await self._do_execute(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:1925: in _do_execute
    stmt = await self._get_statement(
/Users/celeste7/Library/Python/3.9/lib/python/site-packages/asyncpg/connection.py:433: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:166: in prepare
    ???
E   asyncpg.exceptions.UndefinedColumnError: column "full_name" of relation "auth_users_profiles" does not exist</failure></testcase><testcase classname="tests.test_inventory_critical.TestHelperParity" name="test_is_operational_crew_excludes_guest" time="0.146"><failure message="AssertionError: assert None == 'guest'">tests/test_inventory_critical.py:531: in test_is_operational_crew_excludes_guest
    assert result == "guest"
E   AssertionError: assert None == 'guest'</failure></testcase><testcase classname="tests.test_inventory_critical.TestDualLedgerConsistency" name="test_no_inventory_drift" time="1.027" /></testsuite></testsuites>